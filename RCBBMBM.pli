 /* RCBBMBM - COMPARE FOR RCBV0400_PO_MOD1                           */ 00016028
 /*                                                                  */ 00020000
 /* 5695-153 (C) COPYRIGHT IBM EMEA WORLD TRADE CORPORATION 1991     */ 00030000
 /* LICENSED MATERIAL - PROGRAM PROPERTY OF IBM                      */ 00040000
 /* REFER TO COPYRIGHT INSTRUCTIONS: FORM G120-2083                  */ 00050000
 /*                                                                  */ 00060000
 /********************************************************************/ 00070000
 /* PROGRAM          : RCBBMBP                                       */ 00080000
 /*                                                                  */ 00090000
 /* LANGUAGE         : PLI                                           */ 00100000
 /*                                                                  */ 00110000
 /* DATE GENERATED   : 15 OCT 2002 - 13:26:18                        */ 00120000
 /*                                                                  */ 00130000
 /* GENERATED BY     : RCBB0PZ0 - GENERATE COMPARE PROGRAM           */ 00140000
 /*                                                                  */ 00150000
 /* TYPE             : BATCH                                         */ 00160000
 /*                                                                  */ 00170000
 /* DESCRIPTION      : COMPARE FOR RCBV0400_PO_MOD1                  */ 00180000
 /*                    THIS PROGRAM COMPARES TWO INPUT FILES,        */ 00190000
 /*                    DIFFERENCES WILL RESULT IN RECORDS            */ 00200000
 /*                    ON THE ACTIONS FILE.                          */ 00210000
 /*                    THE COMPARE PROCESS IS OF TYPE 2,             */ 00220000
 /*                    DATES INVOLVED, EFF. DATE NOT PART OF KEY.    */ 00230000
 /*                                                                  */ 00240000
 /* INPUT            : - FILES : UPSTREAM RCBBMA0                    */ 00250000
 /*                              CEDS     RCBBE21                    */ 00260000
 /*                                                                  */ 00270000
 /* OUTPUT           : - FILES : ACTIONS  RCBBMC0                    */ 00280000
 /*                              MESSAGE  RCB0M1F0                   */ 00290000
 /*                                                                  */ 00300000
 /* EXTERNAL MODULES : - RCB0M1M   MESSAGE MODULE                    */ 00310000
 /*                    - RCB0E1M   ERROR MODULE                      */ 00320000
 /*                    - RCB0T1M   RETRIEVE SYSTEM DATE              */ 00330000
 /*                    - RCB004M   DATE CALCULATION                  */ 00340000
 /*                    - RCB018M   CALCULATE HASH TOTALS             */ 00350000
 /*                    - RCBF50M   INSERT    PARAMETER               */ 00360000
 /*                    - RCBG50M   UPDATE    PARAMETER               */ 00370000
 /*                    - RCBI50M   REFERENCE PARAMETER               */ 00380000
 /*                                                                  */ 00390000
 /* MESSAGES         : 0003,0004,0007,0013,0014,0015,0017,0018,      */ 00400000
 /*                    0158,0167,0173,0174,0175,9999                 */ 00410000
 /*                                                                  */ 00420000
 /* THE FOLLOWING EXCEPTION ROUTINES HAVE BEEN APPLIED DURING        */ 00430000
 /* GENERATION :  G                                                  */ 00440000
 /*                                                                  */ 00450000
 /* MAINTENANCE LOG  :                                               */ 00460000
 /* ---------------                                                  */ 00470000
 /*                                                                  */ 00480000
 /* DATE       | WORK-ITEMNO. | DESCRIPTION                          */ 00490000
 /* ---------------------------------------------------------------- */ 00500000
 /* 1992-03-02 |              | INITIAL DEVELOPMENT                  */ 00510000
 /* 1992-07-20 | CED0001      | QF A1: HASH TOTAL & TIMESTAMP CHECK  */ 00520000
 /* 1993-02-27 | RC1032       | MCO / NULL INDICATORS                */ 00530000
 /* 1994-05-27 | PTM 519      | SEE PTM DESCRIPTION                  */ 00540000
 /* 1995-08-04 | RC01141      | FILL SEQUENCE_KEY (DG)               */ 00550000
 /* 1997-04-09 | PTM1036      | USE STANDARD PROLOG                  */ 00560000
 /* 1999-07-28 | RC01219      | DORO                                 */ 00570000
 /* 2000-05-16 | PTM1324      | ONLINE ADDITIONAL SERVICE ROWS DELETE*/ 00580000
 /* 2001-01-08 | PTM1333      | CONTRADICTING INFORMATION IN RCMS    */ 00590000
 /* 2009-02-24 | RB01299      | CEDS ALIGNMENT TO CHIS 810           */ 00591001
 /*                                                                  */ 00600000
 /********************************************************************/ 00610000
1RCBBMBM: PROC                                                          00620000
          OPTIONS (MAIN)                                                00630000
          REORDER;                                                      00640000
0/********************************************************************/ 00650000
 /* FILE DECLARATIONS                                                */ 00660000
 /********************************************************************/ 00670000
0DCL RCBBMA0        FILE             /* UPSTREAM FILE                */ 00680000
                    RECORD                                              00690000
                    INPUT                                               00700000
                    SEQUENTIAL                                          00710000
                    ENV (FB RECSIZE(159));                              00720000
 DCL RCBBE21        FILE             /* CEDS FILE                    */ 00730000
                    RECORD                                              00740000
                    INPUT                                               00750000
                    SEQUENTIAL                                          00760000
                    ENV (FB RECSIZE(159));                              00770000
 DCL RCBBMC0        FILE             /* ACTIONS FILE                 */ 00780000
                    RECORD                                              00790000
                    OUTPUT                                              00800000
                    SEQUENTIAL                                          00810000
                    ENV (FB RECSIZE(160));                              00820000
                                                                        00830000
 DCL RCBPROC        FILE             /* INPUT CARD FOR PROC_ID       */ 00840000
                    RECORD                                              00850000
                    INPUT;                                              00860000
0/********************************************************************/ 00870000
 /* RECORD STRUCTURES FOR FILES                                      */ 00880000
 /********************************************************************/ 00890000
0                                    /*   IOAREA UPSTREAM FILE       */ 00900000
 DCL IOAREA_IN_1    CHAR(159);                                          00910000
 DCL 1 RCBBMBSH_1   BASED(ADDR(IOAREA_IN_1)),                           00920000
       %INCLUDE RCBBAASH;;                                              00930000
 DCL 1 RCBBMBST_1   BASED(ADDR(IOAREA_IN_1)),                           00940000
 /*    %INCLUDE RCBBAAST;;                                /* RB01299 */ 00950004
       %INCLUDE RCBBMAST;;                                /* RB01299 */ 00951004
 DCL 1 RCBBMBS1_1   BASED(ADDR(IOAREA_IN_1)),                           00960000
       %INCLUDE RCBBAAS1;,                                              00970000
      3 RCB400S,                                                        00980000
        %INCLUDE RCB400S;,                                              00990000
      3 RCB400SI,                                                       01000000
        %INCLUDE RCB400SI;;                                             01010000
                                     /*   IOAREA CEDS FILE           */ 01020000
 DCL IOAREA_IN_2    CHAR(159);                                          01030000
 DCL 1 RCBBMBSH_2   BASED(ADDR(IOAREA_IN_2)),                           01040000
       %INCLUDE RCBBAASH;;                                              01050000
 DCL 1 RCBBMBST_2   BASED(ADDR(IOAREA_IN_2)),                           01060000
 /*    %INCLUDE RCBBAAST;;                                /* RB01299 */ 01061004
       %INCLUDE RCBBMAST;;                                /* RB01299 */ 01062004
 DCL 1 RCBBMBS1_2   BASED(ADDR(IOAREA_IN_2)),                           01080000
       %INCLUDE RCBBAAS1;,                                              01090000
      3 RCB400S,                                                        01100000
        %INCLUDE RCB400S;,                                              01110000
      3 RCB400SI,                                                       01120000
        %INCLUDE RCB400SI;;                                             01130000
                                     /*   IOAREA ACTIONS FILE        */ 01140000
 DCL IOAREA_OUT     CHAR(160);                                          01150000
 DCL 1 RCBBMBSH_3   BASED(ADDR(IOAREA_OUT)),                            01160000
       %INCLUDE RCBBAASH;;                                              01170000
 DCL 1 RCBBMBST_3   BASED(ADDR(IOAREA_OUT)),                            01180000
 /*    %INCLUDE RCBBAAST;;                                /* RB01299 */ 01191004
       %INCLUDE RCBBMAST;;                                /* RB01299 */ 01192004
 DCL 1 RCBBMBS2_3   BASED(ADDR(IOAREA_OUT)),                            01200000
       %INCLUDE RCBBAAS2;,                                              01210000
      3 RCB400S,                                                        01220000
        %INCLUDE RCB400S;,                                              01230000
      3 RCB400SI,                                                       01240000
        %INCLUDE RCB400SI;;                                             01250000
                                     /*   INPUT CARD                 */ 01260000
 DCL 1 RCBPROC_REC,                                                     01270000
       %INCLUDE (RCBZ27S);;                                             01280000
0/********************************************************************/ 01290000
 /* EXTERNAL PARAMETER INTERFACES                                    */ 01300000
 /********************************************************************/ 01310000
0DCL PTR_INT_AREA            PTR;                                       01320000
 DCL PTR_RET_AREA_BB         PTR;                                       01330000
0DCL 1 PARM_INT_AREA,                                                   01340000
       %INCLUDE RCBZ01S;;                                               01350000
 DCL 1 PARM_RET_AREA_BB,                                                01360000
       %INCLUDE RCBZ02S;;                                               01370000
 DCL 1 RCBZ03S,                                                         01380000
       %INCLUDE RCBZ03S;;                                               01390000
0/********************************************************************/ 01400000
 /* DB2 TABLE STRUCTURES                                             */ 01410000
 /********************************************************************/ 01420000
0DCL 1 TB_RCBV500,                                                      01430000
       %INCLUDE (RCB500S);;                                             01440000
0DCL 1 TB_RCBV500_I,                                                    01450000
       %INCLUDE (RCB500SI);;                                            01460000
0DCL 1 TB_RCBP24S         BASED (ADDR (TB_RCBV500)),                    01470000
       %INCLUDE (RCBP24S);;                                             01480000
0/********************************************************************/ 01490000
 /* SORT KEYS                                                        */ 01500000
 /********************************************************************/ 01510000
0DCL 1 SSK,                          /* SMALLEST SORT KEY            */ 01520000
      3 EOF                  CHAR(1)      INIT('0'),                    01530000
      3 REC_TYPE             CHAR(2),                                   01540000
      3 CTRYNO               CHAR(3),                                   01550000
      3 COUNTRY_NUMBER       CHAR(3),                                   01560000
      3 PRODUCT_TYPE         CHAR(4),                                   01570000
      3 MODEL_NUMBER         CHAR(3),                                   01580000
      3 END                  CHAR(0);                                   01590000
 DCL 1 PREV_SSK     LIKE SSK;        /* PREVIOUS SMALLEST SORT KEY   */ 01600000
 DCL 1 SK1          LIKE SSK;        /* SORT KEY UPSTREAM FILE       */ 01610000
 DCL 1 SK2          LIKE SSK;        /* SORT KEY CEDS FILE           */ 01620000
0/********************************************************************/ 01630000
 /* EXTERNAL ENTRIES                                                 */ 01640000
 /********************************************************************/ 01650000
0DCL PLIXOPT  EXT VAR CHAR(30) INIT ('ISA(10K),NOSTAE');                01660000
0DCL RCB0M1M  EXT ENTRY;             /* MESSAGE MODULE               */ 01670000
 DCL RCB0E1M  EXT ENTRY;             /* ERROR MODULE                 */ 01680000
 DCL RCB0T1M  EXT ENTRY;             /* RETRIEVE SYSTEM DATE         */ 01690000
 DCL RCB004M  EXT ENTRY;             /* DATE CALCULATION             */ 01700000
 DCL RCB018M  EXT ENTRY;             /* CALCULATE HASH TOTALS        */ 01710000
 DCL RCBF50M  EXT ENTRY;             /* INSERT   PARAMETER           */ 01720000
 DCL RCBG50M  EXT ENTRY;             /* UPDATE   PARAMETER           */ 01730000
 DCL RCBI50M  EXT ENTRY;             /* RETRIEVE PARAMETER           */ 01740000
0/********************************************************************/ 01750000
 /* COUNTS                                                           */ 01760000
 /********************************************************************/ 01770000
0DCL 1 COUNT,                                                           01780000
       3 CNT_CTRY,                                                      01790000
                                                      /* SOC RB01299 */ 01791001
 /*      5 RCBBMA0       FIXED DEC(9)     /* COUNT UPSTREAM RECORDS  */ 01800001
 /*      5 RCBBMC0       FIXED DEC(9),    /* COUNT ACTIONS RECORDS   */ 01820002
 /*      5 MATCHES       FIXED DEC(9),    /* COUNT MATCHED RECORDS   */ 01830002
 /*      5 INSERTS       FIXED DEC(9),    /* COUNT INSERT ACTIONS    */ 01840002
 /*      5 UPDATES       FIXED DEC(9),    /* COUNT UPDATE ACTIONS    */ 01850002
 /*      5 DELETES       FIXED DEC(9),    /* COUNT DELETE ACTIONS    */ 01860002
 /*      5 SKIPPED       FIXED DEC(9),    /* COUNT SKIPPED ACTIONS   */ 01870002
         5 RCBBMA0       FIXED DEC(15,0), /* COUNT UPSTREAM RECORDS  */ 01870104
         5 RCBBE21       FIXED DEC(15,0), /* COUNT CEDS RECORDS      */ 01870204
         5 RCBBMC0       FIXED DEC(15,0), /* COUNT ACTIONS RECORDS   */ 01871002
         5 MATCHES       FIXED DEC(15,0), /* COUNT MATCHED RECORDS   */ 01872002
         5 INSERTS       FIXED DEC(15,0), /* COUNT INSERT ACTIONS    */ 01873002
         5 UPDATES       FIXED DEC(15,0), /* COUNT UPDATE ACTIONS    */ 01874002
         5 DELETES       FIXED DEC(15,0), /* COUNT DELETE ACTIONS    */ 01875002
         5 SKIPPED       FIXED DEC(15,0), /* COUNT SKIPPED ACTIONS   */ 01876002
                                                      /* EOC RB01299 */ 01877002
         5 HASH_RCBBMA0 FIXED DEC(15,0), /* HASH UPSTREAM FILE       */ 01880000
         5 HASH_RCBBE21 FIXED DEC(15,0), /* HASH CEDS FILE           */ 01890000
         5 HASH_RCBBMC0 FIXED DEC(15,0), /* HASH ACTION FILE         */ 01900000
       3 CNT_TOT,                                                       01910000
                                                      /* SOC RB01299 */ 01911002
 /*      5 RCBBMA0       FIXED DEC(9),    /* TOTAL UPSTREAM RECORDS  */ 01920002
 /*      5 RCBBMC0       FIXED DEC(9),    /* TOTAL ACTIONS RECORDS   */ 01940002
 /*      5 MATCHES       FIXED DEC(9),    /* TOTAL MATCHED RECORDS   */ 01950002
 /*      5 INSERTS       FIXED DEC(9),    /* TOTAL INSERT ACTIONS    */ 01960002
 /*      5 UPDATES       FIXED DEC(9),    /* TOTAL UPDATE ACTIONS    */ 01970002
 /*      5 DELETES       FIXED DEC(9),    /* TOTAL DELETE ACTIONS    */ 01980002
 /*      5 SKIPPED       FIXED DEC(9);    /* TOTAL SKIPPED ACTIONS   */ 01990002
         5 RCBBMA0       FIXED DEC(15,0), /* TOTAL UPSTREAM RECORDS  */ 01990104
         5 RCBBE21       FIXED DEC(15,0), /* TOTAL CEDS RECORDS      */ 01990204
         5 RCBBMC0       FIXED DEC(15,0), /* TOTAL ACTIONS RECORDS   */ 01991002
         5 MATCHES       FIXED DEC(15,0), /* TOTAL MATCHED RECORDS   */ 01992002
         5 INSERTS       FIXED DEC(15,0), /* TOTAL INSERT ACTIONS    */ 01993002
         5 UPDATES       FIXED DEC(15,0), /* TOTAL UPDATE ACTIONS    */ 01994002
         5 DELETES       FIXED DEC(15,0), /* TOTAL DELETE ACTIONS    */ 01995002
         5 SKIPPED       FIXED DEC(15,0); /* TOTAL SKIPPED ACTIONS   */ 01996002
                                                      /* EOC RB01299 */ 01997002
                                                                        02000000
 DCL CNT_PIC9         PIC'(09)9';       /* CONVERSION OF COUNTS      */ 02010000
 DCL CNT_PIC15        PIC'(15)9';       /* CONVERSION OF HASH TOTAL  */ 02020000
0/********************************************************************/ 02030000
 /* PROGRAM CONTROL PARAMETERS                                       */ 02040000
 /********************************************************************/ 02050000
0DCL 1 RCBP24S_UPSTR,                                                   02060000
     %INCLUDE (RCBP24S);;                                               02070000
0DCL 1 RCBP24S_CEDS,                                                    02080000
     %INCLUDE (RCBP24S);;                                               02090000
0/********************************************************************/ 02100000
 /* BIT SWITCHES                                                     */ 02110000
 /********************************************************************/ 02120000
0DCL TRUE                BIT(1)             INIT ('1'B);                02130000
 DCL FALSE               BIT(1)             INIT ('0'B);                02140000
 DCL SWITCH_CHANGED      BIT(1);                                        02150000
 DCL SWITCH_EOF_RCBPROC  BIT (1)            INIT ('0'B);                02160000
0/********************************************************************/ 02170000
 /* ALL OTHER USED TEMPORARY FIELDS                                  */ 02180000
 /********************************************************************/ 02190000
0DCL 1 WORK_FIELDS,                                                     02200000
       3 WRK_MOD_NAME             CHAR(8),                              02210000
       3 WRK_CTRYNO               CHAR(3),                              02220000
       3 WRK_SOURCE_INDICATOR     CHAR(1),                              02230000
       3 WRK_HASH_FIELD           CHAR(4),                              02240000
       3 WRK_LENGTH_RCB024        FIXED BIN (15,0),                     02250000
       3 WRK_FILE_UPSTR           CHAR(7)       INIT ('RCBBMA0'),       02260000
       3 WRK_DURATION             FIXED DEC (3,0),                      02270000
       3 WRK_WAR_CAT              CHAR(1),                              02280000
       3 WRK_FILE_CEDS            CHAR(7)       INIT ('RCBBE21'),       02290000
       3 WRK_FILE_ACT             CHAR(7)       INIT ('RCBBMC0'),       02300000
       3 WRK_DATE_TIME            CHAR(20)      INIT (' '),             02310000
       3 WRK_TIME_STAMP_RCBBMA0   CHAR(20)      INIT (' '),             02320000
       3 WRK_TIME_STAMP_RCBBE21   CHAR(20)      INIT (' '),             02330000
       3 WRK_RUN_DATE             CHAR(10),                             02340000
       3 WRK_EFF_DATE             CHAR(10),                             02350000
       3 WRK_END_DATE             CHAR(10);                             02360000
0/********************************************************************/ 02370000
 /* BUILTIN                                                          */ 02380000
 /********************************************************************/ 02390000
0DCL (ADDR,                                                             02400000
      CSTG,                                                             02410000
      LOW,                                                              02420000
      NULL,                                                             02430000
      STRING,                                                           02440000
      SUBSTR,                                                           02450000
      TIME,                                                             02460000
      VERIFY) BUILTIN;                                                  02470000
0/********************************************************************/ 02480000
 /* ON CONDITIONS                                                    */ 02490000
 /********************************************************************/ 02500000
0ON ENDFILE (RCBBMA0)                                                   02510000
   SK1.EOF = '1';                                                       02520000
 ON ENDFILE (RCBBE21)                                                   02530000
   SK2.EOF = '1';                                                       02540000
 ON ENDFILE (RCBPROC)                                                   02550000
   SWITCH_EOF_RCBPROC = TRUE;                                           02560000
0/********************************************************************/ 02570000
 /* ON ERROR CONDITIONS                                              */ 02580000
 /********************************************************************/ 02590000
0%INCLUDE RCB0E0M;                                                      02600000
 END;                                                                   02610000
1/********************************************************************/ 02620000
 /*                 S T A R T   P R O C E S S I N G                  */ 02630000
 /********************************************************************/ 02640000
0CALL RCBBMBM_INIT;                                                     02650000
0DO WHILE (SSK.EOF = '0'                                                02660000
        &  SSK.REC_TYPE ¬= '99');    /* WHILE NOT EOF                */ 02670000
0  CALL RCBBMBM_INIT_COUNTRY;                                           02680000
0  DO WHILE (SUBSTR (STRING (PREV_SSK), 1, 6)  /* WHILE SAME COUNTRY */ 02690000
             = SUBSTR (STRING (SSK), 1, 6));                            02700000
     SELECT;                                                            02710000
                                     /* SK UPSTREAM SMALLEST         */ 02720000
       WHEN (STRING(SK1) < STRING(SK2)) DO;                             02730000
         CALL RCBBMBM_INS;                                              02740000
         CALL RCBBMBM_CALC1;                                            02750000
         CALL RCBBMBM_READ1;                                            02760000
         END;                                                           02770000
                                     /* SK CEDS SMALLEST             */ 02780000
       WHEN (STRING(SK2) < STRING(SK1)) DO;                             02790000
         CALL RCBBMBM_DEL;                                              02800000
         CALL RCBBMBM_CALC2;                                            02810000
         CALL RCBBMBM_READ2;                                            02820000
         END;                                                           02830000
                                     /* KEYS ARE EQUAL               */ 02840000
       OTHERWISE DO;                 /* SOME DATA FIELDS MAY DIFFER  */ 02850000
         IF IOAREA_IN_1 ¬= IOAREA_IN_2                                  02860000
         THEN DO;                                                       02870000
           CALL RCBBMBM_UPD;                                            02880000
           END;                                                         02890000
         ELSE DO;                                                       02900000
           COUNT.CNT_CTRY.MATCHES = COUNT.CNT_CTRY.MATCHES + 1;         02910000
           END;                                                         02920000
         CALL RCBBMBM_CALC1;                                            02930000
         CALL RCBBMBM_READ1;         /* READ NEXT UPSTREAM RECORD    */ 02940000
         CALL RCBBMBM_CALC2;                                            02950000
         CALL RCBBMBM_READ2;         /* READ NEXT CEDS RECORD        */ 02960000
         END;                                                           02970000
     END;                                                               02980000
                                                                        02990000
     CALL RCBBMBM_SIC;               /* SET ITERATION CONDITIONS     */ 03000000
   END;                                                                 03010000
0  CALL RCBBMBM_END_COUNTRY;                                            03020000
0END;                                                                   03030000
                                     /* TERMINATE PROGRAM            */ 03040000
 CALL RCBBMBM_TERM;                                                     03050000
1/********************************************************************/ 03060000
 /*                                                                  */ 03070000
 /* MODULE NAME      : RCBBMBM_INIT                                  */ 03080000
 /*                                                                  */ 03090000
 /* DESCRIPTION      : INIT PROGRAM                                  */ 03100000
 /*                                                                  */ 03110000
 /********************************************************************/ 03120000
0RCBBMBM_INIT: PROC;                                                    03130000
                                     /* INITIALIZE POINTERS          */ 03140000
 PTR_INT_AREA    = ADDR (PARM_INT_AREA);                                03150000
 PTR_RET_AREA_BB = ADDR (PARM_RET_AREA_BB);                             03160000
                                     /* INITIALIZE MESSAGE AREA      */ 03170000
 WRK_MOD_NAME                  = SDAISTP.SDAINAM;                       03180000
 PARM_INT_AREA.MSG_AREA        = '';                                    03190000
 PARM_INT_AREA.ERR_AREA        = '';                                    03200000
 PARM_INT_AREA.MSG_REQUEST     = 'O';                                   03210000
 PARM_INT_AREA.MSG_TARGET      = 'F';                                   03220000
 PARM_INT_AREA.ID_SOURCE_APPL  = 'RCB';                                 03230000
 PARM_INT_AREA.ID_SOURCE_PROG  = SUBSTR(WRK_MOD_NAME,1,6) || 'P';       03240000
 PARM_INT_AREA.ID_MOD_PATH (1) = WRK_MOD_NAME;                          03250000
 PARM_INT_AREA.ID_MOD_LEVEL    = 1;                                     03260000
 PARM_INT_AREA.PTR_PCB_IO      = NULL();                                03270000
 PARM_INT_AREA.PTR_PCB_ALT     = NULL();                                03280000
 PARM_INT_AREA.SYSTEM_TYPE     = 'B';                                   03290000
0PARM_INT_AREA.COUNTRY_NUMBER  = '';                                    03300000
                                     /* OPEN MESSAGE FILE            */ 03310000
 CALL RCB0M1M (PTR_INT_AREA);                                           03320000
                                     /* RETRIEVE SYSTEM DATE         */ 03330000
 CALL RCB0T1M (PTR_INT_AREA);                                           03340000
                                     /* INIT OTHER VARIABLES         */ 03350000
 SK1.EOF                = '0';                                          03360000
 SK2.EOF                = '0';                                          03370000
 COUNT                  =  0;                                           03380000
 WRK_CTRYNO             =  LOW(3);                                      03390000
 WRK_DATE_TIME          =  PARM_INT_AREA.SYSTEM_DATE || '.' || TIME();  03400000
 WRK_LENGTH_RCB024      = CSTG (TB_RCBP24S.TIME_STAMP) +                03410000
                          CSTG (TB_RCBP24S.HASH_TOTAL);                 03420000
 RCBZ03S.WD_IN_FORMAT   = 'ISO';                                        03430000
 RCBZ03S.WD_OUT_FORMAT  = 'ISO';                                        03440000
 RCBZ03S.WD_FUNCTION    = 'C';                                          03450000
 RCBZ03S.WD_PERIOD_TYPE = 'D';                                          03460000
                                                                        03470000
 OPEN FILE (RCBBMA0);            /* OPEN ALL FILES                  */  03480000
 OPEN FILE (RCBBE21);                                                   03490000
 OPEN FILE (RCBBMC0);                                                   03500000
 OPEN FILE (RCBPROC);                                                   03510000
                                                                        03520000
 READ FILE (RCBPROC) INTO (RCBPROC_REC);  /* READ RCBPROC CARD */       03530000
                                                                        03540000
 IF SWITCH_EOF_RCBPROC                                                  03550000
 THEN                                                                   03560000
   DO;                                                                  03570000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               03580000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             03590000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0013';                           03600000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             03610000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBPROC';                        03620000
     CALL RCB0M1M (PTR_INT_AREA);                                       03630000
     CALL RCBBMBM_ERROR (NULL(), 'OTHER', '#001');                      03640000
   END;                                                                 03650000
                                                                        03660000
 PARM_INT_AREA.PROC_ID = RCBPROC_REC.PROC_ID;            /* PTM 519 */  03670000
                                                                        03680000
                                 /* CHECK HEADER RECORDS            */  03690000
 CALL RCBBMBM_CHECK_HEADER;                                             03700000
 CALL RCBBMBM_FILL_HEADER;                                              03710000
                                 /* READ RECORDS OF BOTH FILES      */  03720000
 CALL RCBBMBM_READ1;                                                    03730000
 CALL RCBBMBM_READ2;                                                    03740000
                                 /* SET ITERATION CONDITIONS        */  03750000
 CALL RCBBMBM_SIC;                                                      03760000
                                                                        03770000
 END RCBBMBM_INIT;                                                      03780000
1/********************************************************************/ 03790000
 /*                                                                  */ 03800000
 /* MODULE NAME      : RCBBMBM_INIT_COUNTRY                          */ 03810000
 /*                                                                  */ 03820000
 /* DESCRIPTION      : INITIAL ACTIONS FOR A COUNTRY                 */ 03830000
 /*                    RETRIEVE RCB024 PARAMETER FOR THE UPSTREAM    */ 03840000
 /*                    AND CEDS FILE AND CHECK TIME STAMPS           */ 03850000
 /*                                                                  */ 03860000
 /********************************************************************/ 03870000
0RCBBMBM_INIT_COUNTRY: PROC;                                            03880000
0COUNT.CNT_CTRY = 0;                  /* RESET COUNTRY COUNTERS    */   03890000
0PREV_SSK                     = SSK;                                    03900000
 PARM_INT_AREA.COUNTRY_NUMBER = SSK.CTRYNO;                             03910000
                                     /* RETRIEVE PARAMETER RCB024    */ 03920000
 TB_RCBV500                   = '';                                     03930000
 TB_RCBV500_I                 = '';                                     03940000
 TB_RCBP24S.NUMBER            = 'RCB024';                               03950000
 TB_RCBP24S.PROC_ID           =  RCBPROC_REC.PROC_ID;                   03960000
 TB_RCBP24S.CTRYNO            =  SSK.CTRYNO;                            03970000
 TB_RCBP24S.FILE_NAME         =  WRK_FILE_UPSTR;                        03980000
 TB_RCBP24S.SEQ_NUMBER        = '01';                                   03990000
                                                                        04000000
0CALL RCBI50M ('U',                                        /* RC01219 */04010000
               ADDR(TB_RCBV500),                                        04020000
               ADDR(TB_RCBV500_I),                                      04030000
               PTR_RET_AREA_BB,                                         04040000
               PTR_INT_AREA);                                           04050000
0SELECT(PARM_RET_AREA_BB.RETURN_CODE);                                  04060000
 WHEN (0)                                                               04070000
   DO;                                                                  04080000
     RCBP24S_UPSTR = TB_RCBP24S, BY NAME;                               04090000
   END;                                                                 04100000
 WHEN (4)                                                               04110000
   DO;                                                                  04120000
     PARM_INT_AREA.MESSAGE_TYPE      = 'IS';                            04130000
     PARM_INT_AREA.MESSAGE_NUMBER    = 'I050';                          04140000
     PARM_INT_AREA.MSG_VAR_CODES     = '';                              04150000
     PARM_INT_AREA.MSG_VAR_CODE_6    = 'PN';                            04160000
     PARM_INT_AREA.MSG_VAR_VALUE_6   = 'RCB024';                        04170000
     PARM_INT_AREA.MSG_VAR_CODE_7    = 'PK';                            04180000
     PARM_INT_AREA.MSG_VAR_VALUE_7   =  STRING (TB_RCBP24S.EXTRA_KEY);  04190000
     CALL RCB0M1M (PTR_INT_AREA);                                       04200000
     CALL RCBBMBM_ERROR (NULL(),                                        04210000
                        'OTHER',                                        04220000
                        '#002');                                        04230000
    END;                                                                04240000
  OTHERWISE                                                             04250000
    DO;                                                                 04260000
      CALL RCBBMBM_ERROR (ADDR (PARM_RET_AREA_BB.RETURN_SQL),           04270000
                          'DB2',                                        04280000
                          '#003');                                      04290000
    END;                                                                04300000
  END;                                                                  04310000
                                                                        04320000
 IF RCBP24S_UPSTR.TIME_STAMP ¬= WRK_TIME_STAMP_RCBBMA0                  04330000
 THEN                                                                   04340000
   DO;                                                                  04350000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             04360000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               04370000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0174';                           04380000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             04390000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_UPSTR;                   04400000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'TP';                             04410000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = WRK_TIME_STAMP_RCBBMA0;           04420000
     PARM_INT_AREA.MSG_VAR_CODE_8   = 'TP';                             04430000
     PARM_INT_AREA.MSG_VAR_VALUE_8  = RCBP24S_UPSTR.TIME_STAMP;         04440000
     CALL RCB0M1M (PTR_INT_AREA);                                       04450000
                                     /* ABEND                        */ 04460000
     CALL RCBBMBM_ERROR (NULL(),                                        04470000
                         'OTHER',                                       04480000
                         '#004');                                       04490000
   END;                                                                 04500000
                                                                        04510000
                                     /* RETRIEVE PARAMETER RCB024    */ 04520000
 TB_RCBV500                   = '';                                     04530000
 TB_RCBV500_I                 = '';                                     04540000
 TB_RCBP24S.NUMBER            = 'RCB024';                               04550000
 TB_RCBP24S.PROC_ID           = RCBPROC_REC.PROC_ID;                    04560000
 TB_RCBP24S.CTRYNO            = SSK.CTRYNO;                             04570000
 TB_RCBP24S.FILE_NAME         = WRK_FILE_CEDS;                          04580000
 TB_RCBP24S.SEQ_NUMBER        = '01';                                   04590000
                                                                        04600000
0CALL RCBI50M ('U',                                        /* RC01219 */04610000
               ADDR(TB_RCBV500),                                        04620000
               ADDR(TB_RCBV500_I),                                      04630000
               PTR_RET_AREA_BB,                                         04640000
               PTR_INT_AREA);                                           04650000
0SELECT(PARM_RET_AREA_BB.RETURN_CODE);                                  04660000
   WHEN (0)                                                             04670000
     DO;                                                                04680000
       RCBP24S_CEDS = TB_RCBP24S, BY NAME;                              04690000
     END;                                                               04700000
   WHEN (4)                                                             04710000
     DO;                                                                04720000
       PARM_INT_AREA.MESSAGE_TYPE      = 'IS';                          04730000
       PARM_INT_AREA.MESSAGE_NUMBER    = 'I050';                        04740000
       PARM_INT_AREA.MSG_VAR_CODES     = '';                            04750000
       PARM_INT_AREA.MSG_VAR_CODE_6    = 'PN';                          04760000
       PARM_INT_AREA.MSG_VAR_VALUE_6   = 'RCB024';                      04770000
       PARM_INT_AREA.MSG_VAR_CODE_7    = 'PK';                          04780000
       PARM_INT_AREA.MSG_VAR_VALUE_7   =  STRING (TB_RCBP24S.EXTRA_KEY);04790000
       CALL RCB0M1M (PTR_INT_AREA);                                     04800000
       CALL RCBBMBM_ERROR (NULL(),                                      04810000
                          'OTHER',                                      04820000
                          '#005');                                      04830000
     END;                                                               04840000
   OTHERWISE                                                            04850000
     DO;                                                                04860000
       CALL RCBBMBM_ERROR (ADDR (PARM_RET_AREA_BB.RETURN_SQL),          04870000
                           'DB2',                                       04880000
                           '#006');                                     04890000
     END;                                                               04900000
 END;                                                                   04910000
                                                                        04920000
 IF RCBP24S_CEDS.TIME_STAMP ¬= WRK_TIME_STAMP_RCBBE21                   04930000
 THEN                                                                   04940000
   DO;                                                                  04950000
    PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                              04960000
    PARM_INT_AREA.MSG_VAR_CODES    = '';                                04970000
    PARM_INT_AREA.MESSAGE_NUMBER   = '0174';                            04980000
    PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                              04990000
    PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_CEDS;                     05000000
    PARM_INT_AREA.MSG_VAR_CODE_7   = 'TP';                              05010000
    PARM_INT_AREA.MSG_VAR_VALUE_7  = WRK_TIME_STAMP_RCBBE21;            05020000
    PARM_INT_AREA.MSG_VAR_CODE_8   = 'TP';                              05030000
    PARM_INT_AREA.MSG_VAR_VALUE_8  = RCBP24S_CEDS.TIME_STAMP;           05040000
    CALL RCB0M1M (PTR_INT_AREA);                                        05050000
                                    /* ABEND                        */  05060000
    CALL RCBBMBM_ERROR (NULL(),                                         05070000
                        'OTHER',                                        05080000
                        '#007');                                        05090000
   END;                                                                 05100000
                      /* CHECK CORRECT RUN DATES IF COUNTRIES EQUAL */  05110000
                                                                        05120000
 IF (SUBSTR (STRING(SSK),1,6) = SUBSTR (STRING(SK1),1,6)  &             05130000
     SUBSTR (STRING(SSK),1,6) = SUBSTR (STRING(SK2),1,6))               05140000
 THEN                                                                   05150000
   DO;                                                                  05160000
     IF (RCBBMBS1_1.RUN_DATE ¬= RCBBMBS1_2.RUN_DATE)                    05170000
     THEN                                                               05180000
       DO;                                                              05190000
         PARM_INT_AREA.MSG_VAR_CODES    = '';                           05200000
         PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                         05210000
         PARM_INT_AREA.MESSAGE_NUMBER   = '0167';                       05220000
         PARM_INT_AREA.MSG_VAR_CODE_6   = 'D1';                         05230000
         PARM_INT_AREA.MSG_VAR_VALUE_6  = RCBBMBS1_1.RUN_DATE;          05240000
         PARM_INT_AREA.MSG_VAR_CODE_7   = 'D2';                         05250000
         PARM_INT_AREA.MSG_VAR_VALUE_7  = RCBBMBS1_2.RUN_DATE;          05260000
         CALL RCB0M1M (PTR_INT_AREA);                                   05270000
         CALL RCBBMBM_ERROR (NULL(),                                    05280000
                             'OTHER',                                   05290000
                             '#008');                                   05300000
       END;                                                             05310000
   END;                                                                 05320000
                                                                        05330000
0END RCBBMBM_INIT_COUNTRY;                                              05340000
1/********************************************************************/ 05350000
 /*                                                                  */ 05360000
 /* MODULE NAME      : RCBBMBM_INS                                   */ 05370000
 /*                                                                  */ 05380000
 /* DESCRIPTION      : PROCESS NEW RECORD                            */ 05390000
 /*                                                                  */ 05400000
 /********************************************************************/ 05410000
0RCBBMBM_INS: PROC;                                                     05420000
0IOAREA_OUT            = '';                                            05430000
 RCBBMBS2_3.REC_TYPE   = '02';                                          05440000
 RCBBMBS2_3.CTRYNO     = RCBBMBS1_1.CTRYNO;                             05450000
 RCBBMBS2_3.PGR_TYPE   = RCBBMBS1_1.PGR_TYPE;                           05460000
 RCBBMBS2_3.RUN_DATE   = RCBBMBS1_1.RUN_DATE;                           05470000
 RCBBMBS2_3.ACTION_IND = 'I';                                           05480000
 RCBBMBS2_3.RCB400S    = RCBBMBS1_1.RCB400S;                            05490000
 RCBBMBS2_3.RCB400SI   = RCBBMBS1_1.RCB400SI;                           05500000
                                     /* DEFAULT FIELDS               */ 05510000
 IF RCBBMBS2_3.EFFECTIVE_DATE         = ''                              05520000
 THEN DO;                                                               05530000
   RCBBMBS2_3.EFFECTIVE_DATE          = RCBBMBS2_3.RUN_DATE;            05540000
   END;                                                                 05550000
 IF RCBBMBS2_3.END_DATE               = ''                              05560000
 THEN DO;                                                               05570000
   RCBBMBS2_3.END_DATE                = '9999-12-31';                   05580000
   END;                                                                 05590000
 COUNT.CNT_CTRY.INSERTS = COUNT.CNT_CTRY.INSERTS + 1;                   05600000
                                        /* DEFAULT WARRANTY CATEGORY */ 05610000
 CALL RCBBMBM_INIT_WAR_CAT;                               /* PTM1333 */ 05620000
 CALL RCBBMBM_WRITE;                                                    05630000
 END RCBBMBM_INS;                                                       05640000
1/********************************************************************/ 05650000
 /*                                                                  */ 05660000
 /* MODULE NAME      : RCBBMBM_DEL                                   */ 05670000
 /*                                                                  */ 05680000
 /* DESCRIPTION      : PROCESS OBSOLETE RECORD                       */ 05690000
 /*                                                                  */ 05700000
 /********************************************************************/ 05710000
0RCBBMBM_DEL: PROC;                                                     05720000
0IOAREA_OUT            = '';                                            05730000
 RCBBMBS2_3.REC_TYPE   = '02';                                          05740000
 RCBBMBS2_3.CTRYNO     = RCBBMBS1_2.CTRYNO;                             05750000
 RCBBMBS2_3.PGR_TYPE   = RCBBMBS1_2.PGR_TYPE;                           05760000
 RCBBMBS2_3.RUN_DATE   = RCBBMBS1_2.RUN_DATE;                           05770000
 RCBBMBS2_3.ACTION_IND = 'D';                                           05780000
 RCBBMBS2_3.RCB400S    = RCBBMBS1_2.RCB400S;                            05790000
 RCBBMBS2_3.RCB400SI   = RCBBMBS1_2.RCB400SI;                           05800000
                                     /* CLOSE ONLY NOT YET CLOSED    */ 05810000
 IF RCBBMBS2_3.END_DATE              >= RCBBMBS2_3.RUN_DATE             05820000
 THEN DO;                                                               05830000
   RCBBMBS2_3.END_DATE   = RCBBMBM_DATE(RCBBMBS2_3.RUN_DATE,-1);        05840000
   RCBBMBS2_3.INDNULL(28)= 0;                                           05850000
   COUNT.CNT_CTRY.DELETES = COUNT.CNT_CTRY.DELETES + 1;                 05860000
   CALL RCBBMBM_WRITE;                                                  05870000
 END;                                                                   05880000
 ELSE DO;                                                               05890000
   COUNT.CNT_CTRY.SKIPPED = COUNT.CNT_CTRY.SKIPPED + 1;                 05900000
 END;                                                                   05910000
 END RCBBMBM_DEL;                                                       05920000
1/********************************************************************/ 05930000
 /*                                                                  */ 05940000
 /* MODULE NAME      : RCBBMBM_UPD                                   */ 05950000
 /*                                                                  */ 05960000
 /* DESCRIPTION      : PROCESS CHANGED RECORD                        */ 05970000
 /*                                                                  */ 05980000
 /********************************************************************/ 05990000
0RCBBMBM_UPD: PROC;                                                     06000000
0IOAREA_OUT            = '';                                            06010000
 RCBBMBS2_3.REC_TYPE   = '02';                                          06020000
 RCBBMBS2_3.CTRYNO     = RCBBMBS1_1.CTRYNO;                             06030000
 RCBBMBS2_3.PGR_TYPE   = RCBBMBS1_1.PGR_TYPE;                           06040000
 RCBBMBS2_3.RUN_DATE   = RCBBMBS1_1.RUN_DATE;                           06050000
 RCBBMBS2_3.ACTION_IND = 'U';                                           06060000
 RCBBMBS2_3.RCB400S    = RCBBMBS1_1.RCB400S;                            06070000
 RCBBMBS2_3.RCB400SI   = RCBBMBS1_1.RCB400SI;                           06080000
 SWITCH_CHANGED        = FALSE;                                         06090000
                                     /* FILL WORK EFF_DATE           */ 06100000
 IF RCBBMBS2_3.EFFECTIVE_DATE         = ''                              06110000
 THEN DO;                                                               06120000
   WRK_EFF_DATE                       = RCBBMBS1_2.EFFECTIVE_DATE;      06130000
   END;                                                                 06140000
 ELSE DO;                                                               06150000
   WRK_EFF_DATE                       = RCBBMBS2_3.EFFECTIVE_DATE;      06160000
   END;                                                                 06170000
                                     /* FILL WORK END_DATE           */ 06180000
 IF RCBBMBS2_3.END_DATE               = ''                              06190000
 THEN DO;                                                               06200000
   WRK_END_DATE                       = RCBBMBS1_2.END_DATE;            06210000
   END;                                                                 06220000
 ELSE DO;                                                               06230000
   WRK_END_DATE                       = RCBBMBS2_3.END_DATE;            06240000
   END;                                                                 06250000
                                     /* COMPARE WITH RUNDATE         */ 06260000
 IF RCBBMBS2_3.EFFECTIVE_DATE         = '' &                            06270000
    WRK_EFF_DATE > RCBBMBS2_3.RUN_DATE                                  06280000
 THEN DO;                                                               06290000
   WRK_EFF_DATE = RCBBMBS2_3.RUN_DATE;                    /* PTM1380 */ 06300000
   END;                                                                 06310000
 IF RCBBMBS2_3.END_DATE               = '' &                            06320000
    WRK_END_DATE < RCBBMBS2_3.RUN_DATE                                  06330000
 THEN DO;                                                               06340000
   WRK_END_DATE                       = '9999-12-31';                   06350000
   END;                                                                 06360000
                                     /* COMPARE WRK DATES            */ 06370000
 IF RCBBMBS2_3.EFFECTIVE_DATE         = '' &                            06380000
    RCBBMBS2_3.END_DATE              ¬= '' &                            06390000
    WRK_EFF_DATE > WRK_END_DATE                                         06400000
 THEN DO;                                                               06410000
   WRK_EFF_DATE                       = WRK_END_DATE;                   06420000
   END;                                                                 06430000
 IF RCBBMBS2_3.END_DATE               = '' &                            06440000
    RCBBMBS1_1.EFFECTIVE_DATE        ¬= '' &                            06450000
    WRK_EFF_DATE > WRK_END_DATE                                         06460000
 THEN DO;                                                               06470000
   WRK_END_DATE                       = '9999-12-31';                   06480000
   END;                                                                 06490000
                                     /* SET ACTION RECORD DATES      */ 06500000
 RCBBMBS2_3.EFFECTIVE_DATE            = WRK_EFF_DATE;                   06510000
 RCBBMBS2_3.END_DATE                  = WRK_END_DATE;                   06520000
                                     /* COMPARE FIELDS               */ 06530000
 RCBBMBS2_3.REPAIR_CENTER_MARK        = RCBBMBS1_2.REPAIR_CENTER_MARK;  06540000
 RCBBMBS2_3.INDNULL(4)                = RCBBMBS1_2.INDNULL(4);          06550000
 RCBBMBS2_3.MACHINE_CATEGORY          = RCBBMBS1_2.MACHINE_CATEGORY;    06560000
 RCBBMBS2_3.INDNULL(5)                = RCBBMBS1_2.INDNULL(5);          06570000
 RCBBMBS2_3.REGROUP_PR_CAT            = RCBBMBS1_2.REGROUP_PR_CAT;      06580000
 RCBBMBS2_3.INDNULL(6)                = RCBBMBS1_2.INDNULL(6);          06590000
 RCBBMBS2_3.ACTIVITY_REP_OPT          = RCBBMBS1_2.ACTIVITY_REP_OPT;    06600000
 RCBBMBS2_3.INDNULL(7)                = RCBBMBS1_2.INDNULL(7);          06610000
 RCBBMBS2_3.MC_MAINT_GROUP            = RCBBMBS1_2.MC_MAINT_GROUP;      06620000
 RCBBMBS2_3.INDNULL(8)                = RCBBMBS1_2.INDNULL(8);          06630000
 RCBBMBS2_3.MIN_MONTH_MAINT_CH        = RCBBMBS1_2.MIN_MONTH_MAINT_CH;  06640000
 RCBBMBS2_3.INDNULL(9)                = RCBBMBS1_2.INDNULL(9);          06650000
 RCBBMBS2_3.DEVELOP_DIV_CODE          = RCBBMBS1_2.DEVELOP_DIV_CODE;    06660000
 RCBBMBS2_3.INDNULL(10)               = RCBBMBS1_2.INDNULL(10);         06670000
 RCBBMBS2_3.CUSTOMER_SETUP_IND        = RCBBMBS1_2.CUSTOMER_SETUP_IND;  06680000
 RCBBMBS2_3.INDNULL(11)               = RCBBMBS1_2.INDNULL(11);         06690000
 RCBBMBS2_3.WARRANTY_CATEGORY         = RCBBMBS1_2.WARRANTY_CATEGORY;   06700000
 RCBBMBS2_3.INDNULL(12)               = RCBBMBS1_2.INDNULL(12);         06710000
                                                      /* SOC PTM1333 */ 06720000
 IF (RCBBMBS2_3.INDNULL(14)           ¬= 0)|                            06730000
    (RCBBMBS2_3.WARRANTY_CATEGORY     = ' ')                            06740000
 THEN DO;                                                               06750000
                      /* DEFAULT WARRANTY CATEGORY                   */ 06760000
                      /* THERE IS ONLY A SINGLE COURSE IN THIS CASE  */ 06770000
   CALL RCBBMBM_INIT_WAR_CAT;                                           06780000
   SWITCH_CHANGED                     = TRUE;                           06790000
 END;                                                                   06800000
 ELSE DO;                                                               06810000
                      /* CHECK THE VALUE                             */ 06820000
   CALL RCBBMBM_CHK_WAR_CAT;                                            06830000
 END;                                                                   06840000
                                                      /* EOC PTM1333 */ 06850000
 RCBBMBS2_3.CE_PRODUCT_KEY            = RCBBMBS1_2.CE_PRODUCT_KEY;      06860000
 RCBBMBS2_3.INDNULL(13)               = RCBBMBS1_2.INDNULL(13);         06870000
 IF RCBBMBS2_3.INDNULL(14)            ¬= RCBBMBS1_2.INDNULL(14)         06880000
 THEN                                                                   06890000
     SWITCH_CHANGED                   = TRUE;                           06900000
 ELSE                                                                   06910000
   IF RCBBMBS2_3.INDNULL(14)          = 0                               06920000
   THEN                                                                 06930000
     IF RCBBMBS2_3.SERVICE_LVL_CODE_1 ¬= RCBBMBS1_2.SERVICE_LVL_CODE_1  06940000
     THEN                                                               06950000
       SWITCH_CHANGED                 = TRUE;                           06960000
 IF RCBBMBS2_3.INDNULL(15)            ¬= RCBBMBS1_2.INDNULL(15)         06970000
 THEN                                                                   06980000
     SWITCH_CHANGED                   = TRUE;                           06990000
 ELSE                                                                   07000000
   IF RCBBMBS2_3.INDNULL(15)          = 0                               07010000
   THEN                                                                 07020000
     IF RCBBMBS2_3.WARRANTY_DURATN_1  ¬= RCBBMBS1_2.WARRANTY_DURATN_1   07030000
     THEN                                                               07040000
       SWITCH_CHANGED                 = TRUE;                           07050000
 IF RCBBMBS2_3.INDNULL(16)            ¬= RCBBMBS1_2.INDNULL(16)         07060000
 THEN                                                                   07070000
     SWITCH_CHANGED                   = TRUE;                           07080000
 ELSE                                                                   07090000
   IF RCBBMBS2_3.INDNULL(16)          = 0                               07100000
   THEN                                                                 07110000
     IF RCBBMBS2_3.SERVICE_LVL_CODE_2 ¬= RCBBMBS1_2.SERVICE_LVL_CODE_2  07120000
     THEN                                                               07130000
       SWITCH_CHANGED                 = TRUE;                           07140000
 IF RCBBMBS2_3.INDNULL(17)            ¬= RCBBMBS1_2.INDNULL(17)         07150000
 THEN                                                                   07160000
     SWITCH_CHANGED                   = TRUE;                           07170000
 ELSE                                                                   07180000
   IF RCBBMBS2_3.INDNULL(17)          = 0                               07190000
   THEN                                                                 07200000
     IF RCBBMBS2_3.WARRANTY_DURATN_2  ¬= RCBBMBS1_2.WARRANTY_DURATN_2   07210000
     THEN                                                               07220000
       SWITCH_CHANGED                 = TRUE;                           07230000
 IF RCBBMBS2_3.INDNULL(18)            ¬= RCBBMBS1_2.INDNULL(18)         07240000
 THEN                                                                   07250000
     SWITCH_CHANGED                   = TRUE;                           07260000
 ELSE                                                                   07270000
   IF RCBBMBS2_3.INDNULL(18)          = 0                               07280000
   THEN                                                                 07290000
     IF RCBBMBS2_3.SERVICE_LVL_CODE_C ¬= RCBBMBS1_2.SERVICE_LVL_CODE_C  07300000
     THEN                                                               07310000
       SWITCH_CHANGED                 = TRUE;                           07320000
 IF RCBBMBS2_3.INDNULL(19)            ¬= RCBBMBS1_2.INDNULL(19)         07330000
 THEN                                                                   07340000
     SWITCH_CHANGED                   = TRUE;                           07350000
 ELSE                                                                   07360000
   IF RCBBMBS2_3.INDNULL(19)          = 0                               07370000
   THEN                                                                 07380000
     IF RCBBMBS2_3.SERVICE_LVL_CD_MA1 ¬= RCBBMBS1_2.SERVICE_LVL_CD_MA1  07390000
     THEN                                                               07400000
       SWITCH_CHANGED                 = TRUE;                           07410000
 IF RCBBMBS2_3.INDNULL(20)            ¬= RCBBMBS1_2.INDNULL(20)         07420000
 THEN                                                                   07430000
     SWITCH_CHANGED                   = TRUE;                           07440000
 ELSE                                                                   07450000
   IF RCBBMBS2_3.INDNULL(20)          = 0                               07460000
   THEN                                                                 07470000
     IF RCBBMBS2_3.SERVICE_LVL_CD_MA2 ¬= RCBBMBS1_2.SERVICE_LVL_CD_MA2  07480000
     THEN                                                               07490000
       SWITCH_CHANGED                 = TRUE;                           07500000
 IF RCBBMBS2_3.INDNULL(21)            ¬= RCBBMBS1_2.INDNULL(21)         07510000
 THEN                                                                   07520000
     SWITCH_CHANGED                   = TRUE;                           07530000
 ELSE                                                                   07540000
   IF RCBBMBS2_3.INDNULL(21)          = 0                               07550000
   THEN                                                                 07560000
     IF RCBBMBS2_3.SERVICE_LVL_CD_MA3 ¬= RCBBMBS1_2.SERVICE_LVL_CD_MA3  07570000
     THEN                                                               07580000
       SWITCH_CHANGED                 = TRUE;                           07590000
 RCBBMBS2_3.PROD_REVENUE_DIV          = RCBBMBS1_2.PROD_REVENUE_DIV;    07600000
 RCBBMBS2_3.INDNULL(22)               = RCBBMBS1_2.INDNULL(22);         07610000
 RCBBMBS2_3.SEGMENT_ACRONYM           = RCBBMBS1_2.SEGMENT_ACRONYM;     07620000
 RCBBMBS2_3.INDNULL(23)               = RCBBMBS1_2.INDNULL(23);         07630000
 RCBBMBS2_3.MANUAL_DIVISION           = RCBBMBS1_2.MANUAL_DIVISION;     07640000
 RCBBMBS2_3.INDNULL(24)               = RCBBMBS1_2.INDNULL(24);         07650000
 IF RCBBMBS2_3.INDNULL(25)            ¬= RCBBMBS1_2.INDNULL(25)         07660000
 THEN                                                                   07670000
     SWITCH_CHANGED                   = TRUE;                           07680000
 ELSE                                                                   07690000
   IF RCBBMBS2_3.INDNULL(25)          = 0                               07700000
   THEN                                                                 07710000
     IF RCBBMBS2_3.EXPLICIT_TYPE      ¬= RCBBMBS1_2.EXPLICIT_TYPE       07720000
     THEN                                                               07730000
       SWITCH_CHANGED                 = TRUE;                           07740000
 RCBBMBS2_3.EFFECTIVE_DATE            = RCBBMBS1_2.EFFECTIVE_DATE;      07750000
 RCBBMBS2_3.END_DATE                  = RCBBMBS1_2.END_DATE;            07760000
                                     /* UPDATE ONLY IF CHANGED       */ 07770000
 IF SWITCH_CHANGED                                                      07780000
 THEN DO;                                                               07790000
   COUNT.CNT_CTRY.UPDATES = COUNT.CNT_CTRY.UPDATES + 1;                 07800000
   CALL RCBBMBM_WRITE;                                                  07810000
   END;                                                                 07820000
 ELSE DO;                                                               07830000
   COUNT.CNT_CTRY.MATCHES = COUNT.CNT_CTRY.MATCHES + 1;                 07840000
   END;                                                                 07850000
 END RCBBMBM_UPD;                                                       07860000
1/********************************************************************/ 07870000
 /*                                                                  */ 07880000
 /* MODULE NAME      : RCBBMBM_INIT_WAR_CAT                          */ 07890000
 /*                                                                  */ 07900000
 /* DESCRIPTION      : SET THE WARRANTY CATEGORY FROM THE DURATION,  */ 07910000
 /*                    IF IT WAS NOT ALREADY SET FROM CEMT           */ 07920000
 /*                                                                  */ 07930000
 /********************************************************************/ 07940000
                                                      /* SOC PTM1333 */ 07950000
 RCBBMBM_INIT_WAR_CAT: PROC;                                            07960000
 CALL RCBBMBM_WRK_WAR_CAT;                                              07970000
 IF WRK_WAR_CAT ¬= ' '                                                  07980000
 THEN DO;                                                               07990000
   RCBBMBS2_3.INDNULL(12)          = 0;                                 08000000
   RCBBMBS2_3.WARRANTY_CATEGORY    = WRK_WAR_CAT;                       08010000
 END;                                                                   08020000
 ELSE                                                                   08030000
   RCBBMBS2_3.INDNULL(12)          = -1;                                08040000
                                                                        08050000
 END RCBBMBM_INIT_WAR_CAT;                                              08060000
1/********************************************************************/ 08070000
 /*                                                                  */ 08080000
 /* MODULE NAME      : RCBBMBM_CHK_WAR_CAT                           */ 08090000
 /*                                                                  */ 08100000
 /* DESCRIPTION      : GIVE A MESSAGE IF THERE IS A DURATION         */ 08110000
 /*                    MISMATCH BETWEEN SERVICE_REFERENCE AND CEMT   */ 08120000
 /*                                                                  */ 08130000
 /********************************************************************/ 08140000
 RCBBMBM_CHK_WAR_CAT: PROC;                                             08150000
 CALL RCBBMBM_WRK_WAR_CAT;                                              08160000
 IF WRK_WAR_CAT ¬= RCBBMBS2_3.WARRANTY_CATEGORY                         08170000
 THEN DO;                                                               08180000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 08190000
   PARM_INT_AREA.MESSAGE_TYPE     = 'BU';                               08200000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0225';                             08210000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'PT';                               08220000
   PARM_INT_AREA.MSG_VAR_VALUE_6  =  RCBBMBS2_3.PRODUCT_TYPE ||         08230000
                                     RCBBMBS2_3.MODEL_NUMBER;           08240000
   PARM_INT_AREA.MSG_VAR_CODE_7   = 'DR';                               08250000
   PARM_INT_AREA.MSG_VAR_VALUE_7  = WRK_DURATION;                       08260000
   PARM_INT_AREA.MSG_VAR_CODE_8   = 'WC';                               08270000
   PARM_INT_AREA.MSG_VAR_VALUE_8  = RCBBMBS2_3.WARRANTY_CATEGORY;       08280000
   CALL RCB0M1M (PTR_INT_AREA);                                         08290000
 END;                                                                   08300000
 END RCBBMBM_CHK_WAR_CAT;                                               08310000
1/********************************************************************/ 08320000
 /*                                                                  */ 08330000
 /* MODULE NAME      : RCBBMBM_WRK_WAR_CAT                           */ 08340000
 /*                                                                  */ 08350000
 /* DESCRIPTION      : DETERMINE A WARRANTY CATEGORY FROM DURATION   */ 08360000
 /*                    IN A WORK FIELD                               */ 08370000
 /*                                                                  */ 08380000
 /********************************************************************/ 08390000
 RCBBMBM_WRK_WAR_CAT: PROC;                                             08400000
 IF RCBBMBS2_3.INDNULL(16)          = -1                                08410000
 THEN                                                                   08420000
   WRK_DURATION = RCBBMBS2_3.WARRANTY_DURATN_1;                         08430000
 ELSE                                                                   08440000
   WRK_DURATION = RCBBMBS2_3.WARRANTY_DURATN_1 +                        08450000
                          RCBBMBS2_3.WARRANTY_DURATN_2 ;                08460000
 SELECT;                                                                08470000
   WHEN (WRK_DURATION = 3)                                              08480000
     WRK_WAR_CAT      = 'B';                                            08490000
   WHEN (WRK_DURATION = 6)                                              08500000
     WRK_WAR_CAT      = 'C';                                            08510000
   WHEN (WRK_DURATION = 12)                                             08520000
     WRK_WAR_CAT      = 'A';                                            08530000
   WHEN (WRK_DURATION = 24)                                             08540000
     WRK_WAR_CAT      = 'F';                                            08550000
   WHEN (WRK_DURATION = 36)                                             08560000
     WRK_WAR_CAT      = 'D';                                            08570000
   WHEN (WRK_DURATION = 48)                                             08580000
     WRK_WAR_CAT      = 'G';                                            08590000
   WHEN (WRK_DURATION = 60)                                             08600000
     WRK_WAR_CAT      = 'E';                                            08610000
   OTHERWISE                                                            08620000
     WRK_WAR_CAT      = ' ';                                            08630000
 END;                                                                   08640000
 END RCBBMBM_WRK_WAR_CAT;                                               08650000
                                                      /* EOC PTM1333 */ 08660000
1/********************************************************************/ 08670000
 /*                                                                  */ 08680000
 /* MODULE NAME      : RCBBMBM_READ1                                 */ 08690000
 /*                                                                  */ 08700000
 /* DESCRIPTION      : READ UPSTREAM RECORD                          */ 08710000
 /*                                                                  */ 08720000
 /********************************************************************/ 08730000
0RCBBMBM_READ1: PROC;                                                   08740000
                                                                        08750000
0READ FILE (RCBBMA0) INTO (IOAREA_IN_1);                                08760000
0IF SK1.EOF = '0'                                                       08770000
 THEN DO;                                                               08780000
   SK1.REC_TYPE = RCBBMBS1_1.REC_TYPE;                                  08790000
0  IF RCBBMBS1_1.REC_TYPE = '02'                                        08800000
   THEN                                                                 08810000
     DO;                                                                08820000
       SK1.CTRYNO = RCBBMBS1_1.CTRYNO;                                  08830000
       SK1.COUNTRY_NUMBER       = RCBBMBS1_1.COUNTRY_NUMBER;            08840000
       SK1.PRODUCT_TYPE         = RCBBMBS1_1.PRODUCT_TYPE;              08850000
       SK1.MODEL_NUMBER         = RCBBMBS1_1.MODEL_NUMBER;              08860000
     END;                                                               08870000
   END;                                                                 08880000
 END RCBBMBM_READ1;                                                     08890000
1/********************************************************************/ 08900000
 /*                                                                  */ 08910000
 /* MODULE NAME      : RCBBMBM_CALC1                                 */ 08920000
 /*                                                                  */ 08930000
 /* DESCRIPTION      : CALC HASH TOTAL AND COUNTS FOR UPSTREAM FILE  */ 08940000
 /*                                                                  */ 08950000
 /********************************************************************/ 08960000
0RCBBMBM_CALC1: PROC;                                                   08970000
                                                                        08980000
 COUNT.CNT_CTRY.RCBBMA0   = COUNT.CNT_CTRY.RCBBMA0 + 1;                 08990000
 WRK_HASH_FIELD           =                                             09000000
 SUBSTR (RCBBMBS1_1.RCB400S.PRODUCT_TYPE, 1, 4);                        09010000
                                                                        09020000
 CALL RCB018M (WRK_HASH_FIELD,                                          09030000
               COUNT.HASH_RCBBMA0,                                      09040000
               PTR_INT_AREA);                                           09050000
                                                                        09060000
 END RCBBMBM_CALC1;                                                     09070000
1/********************************************************************/ 09080000
 /*                                                                  */ 09090000
 /* MODULE NAME      : RCBBMBM_READ2                                 */ 09100000
 /*                                                                  */ 09110000
 /* DESCRIPTION      : READ CEDS RECORD AND COUNT HASH TOTAL         */ 09120000
 /*                                                                  */ 09130000
 /********************************************************************/ 09140000
0RCBBMBM_READ2: PROC;                                                   09150000
0READ FILE (RCBBE21) INTO (IOAREA_IN_2);                                09160000
0IF SK2.EOF = '0'                                                       09170000
 THEN DO;                                                               09180000
   SK2.REC_TYPE = RCBBMBS1_2.REC_TYPE;                                  09190000
   IF RCBBMBS1_2.REC_TYPE = '02'                                        09200000
   THEN                                                                 09210000
     DO;                                                                09220000
       SK2.CTRYNO = RCBBMBS1_2.CTRYNO;                                  09230000
       SK2.COUNTRY_NUMBER       = RCBBMBS1_2.COUNTRY_NUMBER;            09240000
       SK2.PRODUCT_TYPE         = RCBBMBS1_2.PRODUCT_TYPE;              09250000
       SK2.MODEL_NUMBER         = RCBBMBS1_2.MODEL_NUMBER;              09260000
     END;                                                               09270000
   END;                                                                 09280000
 END RCBBMBM_READ2;                                                     09290000
1/********************************************************************/ 09300000
 /*                                                                  */ 09310000
 /* MODULE NAME      : RCBBMBM_CALC2                                 */ 09320000
 /*                                                                  */ 09330000
 /* DESCRIPTION      : CALC HASH TOTAL AND COUNTS FOR CEDS FILE      */ 09340000
 /*                                                                  */ 09350000
 /********************************************************************/ 09360000
0RCBBMBM_CALC2: PROC;                                                   09370000
                                                                        09380000
 COUNT.CNT_CTRY.RCBBE21   = COUNT.CNT_CTRY.RCBBE21 + 1;                 09390000
 WRK_HASH_FIELD           =                                             09400000
 SUBSTR (RCBBMBS1_2.RCB400S.PRODUCT_TYPE, 1, 4);                        09410000
                                                                        09420000
 CALL RCB018M (WRK_HASH_FIELD,                                          09430000
               COUNT.HASH_RCBBE21,                                      09440000
               PTR_INT_AREA);                                           09450000
                                                                        09460000
0END RCBBMBM_CALC2;                                                     09470000
1/********************************************************************/ 09480000
 /*                                                                  */ 09490000
 /* MODULE NAME      : RCBBMBM_WRITE                                 */ 09500000
 /*                                                                  */ 09510000
 /* DESCRIPTION      : WRITE ACTION RECORD AND COUNT HASH TOTAL      */ 09520000
 /*                                                                  */ 09530000
 /********************************************************************/ 09540000
0RCBBMBM_WRITE: PROC;                                                   09550000
0WRITE FILE (RCBBMC0) FROM (IOAREA_OUT);                                09560000
                                                                        09570000
 IF RCBBMBS2_3.REC_TYPE = '02'                   /* COUNT HASH */       09580000
 THEN                                                                   09590000
   DO;                                                                  09600000
     COUNT.CNT_CTRY.RCBBMC0 = COUNT.CNT_CTRY.RCBBMC0 + 1;               09610000
     WRK_HASH_FIELD =                                                   09620000
     SUBSTR (RCBBMBS2_3.RCB400S.PRODUCT_TYPE, 1, 4);                    09630000
                                                                        09640000
     CALL RCB018M (WRK_HASH_FIELD,                                      09650000
                   COUNT.HASH_RCBBMC0,                                  09660000
                   PTR_INT_AREA);                                       09670000
   END;                                                                 09680000
 END RCBBMBM_WRITE;                                                     09690000
1/********************************************************************/ 09700000
 /*                                                                  */ 09710000
 /* MODULE NAME      : RCBBMBM_SIC                                   */ 09720000
 /*                                                                  */ 09730000
 /* DESCRIPTION      : SET ITERATION CONDITIONS                      */ 09740000
 /*                                                                  */ 09750000
 /********************************************************************/ 09760000
0RCBBMBM_SIC: PROC;                                                     09770000
0PREV_SSK = SSK;                                                        09780000
0IF STRING (SK1) < STRING (SK2)                                         09790000
 THEN                                                                   09800000
   DO;                                                                  09810000
     SSK = SK1;                                                         09820000
   END;                                                                 09830000
 ELSE                                                                   09840000
   DO;                                                                  09850000
     SSK = SK2;                                                         09860000
   END;                                                                 09870000
 PARM_INT_AREA.SEQUENCE_KEY = STRING(SSK);                /* RC01141 */ 09880000
0END RCBBMBM_SIC;                                                       09890000
1/********************************************************************/ 09900000
 /*                                                                  */ 09910000
 /* MODULE NAME      : RCBBMBM_CHECK_HEADER                          */ 09920000
 /*                                                                  */ 09930000
 /* DESCRIPTION      : CHECK THE HEADERS                             */ 09940000
 /*                    TIMESTAMPS OF BOTH FILE HEADERS ARE SAVED.    */ 09950000
 /*                    SOURCE INDICATOR OF THE UPSTREAM FILE HEADER  */ 09960000
 /*                    IS SAVED.                                     */ 09970000
 /*                                                                  */ 09980000
 /********************************************************************/ 09990000
0RCBBMBM_CHECK_HEADER: PROC;                                            10000000
                                                                        10010000
 CALL RCBBMBM_READ1;                 /* READ UPSTREAM HEADER         */ 10020000
 SELECT;                                                                10030000
                                     /* EMPTY FILE                   */ 10040000
   WHEN (SK1.EOF = '1') DO;                                             10050000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               10060000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             10070000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0013';                           10080000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             10090000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBMA0';                        10100000
     CALL RCB0M1M (PTR_INT_AREA);                                       10110000
                                     /* ABEND                        */ 10120000
     CALL RCBBMBM_ERROR (NULL(),                                        10130000
                         'OTHER',                                       10140000
                         '#009');                                       10150000
     END;                                                               10160000
                                     /* INVALID RECORD TYPE HEADER   */ 10170000
   WHEN (RCBBMBSH_1.REC_TYPE ¬= '01') DO;                               10180000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               10190000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             10200000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0018';                           10210000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             10220000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBMA0';                        10230000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'RT';                             10240000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = RCBBMBSH_1.REC_TYPE;              10250000
     CALL RCB0M1M (PTR_INT_AREA);                                       10260000
                                     /* ABEND                        */ 10270000
     CALL RCBBMBM_ERROR (NULL(),                                        10280000
                         'OTHER',                                       10290000
                         '#010');                                       10300000
     END;                                                               10310000
                                     /* INVALID FILE ID HEADER       */ 10320000
   WHEN (RCBBMBSH_1.FILE_ID ¬= 'RCBBMA0') DO;                           10330000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               10340000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             10350000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0014';                           10360000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             10370000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBMA0';                        10380000
     CALL RCB0M1M (PTR_INT_AREA);                                       10390000
                                     /* ABEND                        */ 10400000
     CALL RCBBMBM_ERROR (NULL(),                                        10410000
                         'OTHER',                                       10420000
                         '#011');                                       10430000
     END;                                                               10440000
   OTHERWISE;                                                           10450000
   END;                                                                 10460000
                                   /* SAVE TIMESTAMP OF UPSTREAM FILE */10470000
 WRK_TIME_STAMP_RCBBMA0 = RCBBMBSH_1.TIMESTAMP;                         10480000
                                   /* SAVE SOURCE_INDICATOR           */10490000
 WRK_SOURCE_INDICATOR   = RCBBMBSH_1.SOURCE_INDICATOR;                  10500000
                                                                        10510000
 CALL RCBBMBM_READ2;                 /* READ CEDS HEADER             */ 10520000
 SELECT;                                                                10530000
                                     /* EMPTY FILE                   */ 10540000
   WHEN (SK2.EOF = '1') DO;                                             10550000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               10560000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             10570000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0013';                           10580000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             10590000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBE21';                        10600000
     CALL RCB0M1M (PTR_INT_AREA);                                       10610000
                                     /* ABEND                        */ 10620000
     CALL RCBBMBM_ERROR (NULL(),                                        10630000
                         'OTHER',                                       10640000
                         '#012');                                       10650000
     END;                                                               10660000
                                     /* INVALID RECORD TYPE HEADER   */ 10670000
   WHEN (RCBBMBSH_2.REC_TYPE ¬= '01') DO;                               10680000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               10690000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             10700000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0018';                           10710000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             10720000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBE21';                        10730000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'RT';                             10740000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = RCBBMBSH_2.REC_TYPE;              10750000
     CALL RCB0M1M (PTR_INT_AREA);                                       10760000
                                     /* ABEND                        */ 10770000
     CALL RCBBMBM_ERROR (NULL(),                                        10780000
                         'OTHER',                                       10790000
                         '#013');                                       10800000
     END;                                                               10810000
                                     /* INVALID FILE ID HEADER       */ 10820000
   WHEN (RCBBMBSH_2.FILE_ID  ¬= 'RCBBE21' ) DO;                         10830000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               10840000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             10850000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0014';                           10860000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             10870000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBE21';                        10880000
     CALL RCB0M1M (PTR_INT_AREA);                                       10890000
                                     /* ABEND                        */ 10900000
     CALL RCBBMBM_ERROR (NULL(),                                        10910000
                         'OTHER',                                       10920000
                         '#014');                                       10930000
     END;                                                               10940000
   OTHERWISE;                                                           10950000
   END;                                                                 10960000
                                     /* SAVE TIMESTAMP OF CEDS FILE */  10970000
 WRK_TIME_STAMP_RCBBE21 = RCBBMBSH_2.TIMESTAMP;                         10980000
                                                                        10990000
 END RCBBMBM_CHECK_HEADER;                                              11000000
1/********************************************************************/ 11010000
 /*                                                                  */ 11020000
 /* MODULE NAME      : RCBBMBM_CHECK_HASH                            */ 11030000
 /*                                                                  */ 11040000
 /* DESCRIPTION      : CHECK THAT THE HASH TOTALS FROM PARAMETER     */ 11050000
 /*                    RCB024 MATCH WITH THE CALCULATED HASH TOTALS  */ 11060000
 /*                    FROM THE UPSTREAM AND THE CEDS FILES          */ 11070000
 /*                                                                  */ 11080000
 /********************************************************************/ 11090000
0RCBBMBM_CHECK_HASH: PROC;                                              11100000
 IF COUNT.HASH_RCBBMA0 ¬= RCBP24S_UPSTR.HASH_TOTAL                      11110000
 THEN                                                                   11120000
   DO;                                                                  11130000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             11140000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0175';                           11150000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               11160000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             11170000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_UPSTR;                   11180000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'HT';                             11190000
     CNT_PIC15                      = COUNT.HASH_RCBBMA0;               11200000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;                        11210000
     PARM_INT_AREA.MSG_VAR_CODE_8   = 'HT';                             11220000
     CNT_PIC15                      = RCBP24S_UPSTR.HASH_TOTAL;         11230000
     PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC15;                        11240000
     CALL RCB0M1M (PTR_INT_AREA);                                       11250000
     CALL RCBBMBM_ERROR (NULL(),                                        11260000
                         'OTHER',                                       11270000
                         '#015');                                       11280000
   END;                                                                 11290000
                                                                        11300000
 IF COUNT.HASH_RCBBE21 ¬= RCBP24S_CEDS.HASH_TOTAL                       11310000
 THEN                                                                   11320000
   DO;                                                                  11330000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             11340000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0175';                           11350000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               11360000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             11370000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_CEDS;                    11380000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'HT';                             11390000
     CNT_PIC15                      = COUNT.HASH_RCBBE21;               11400000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;                        11410000
     PARM_INT_AREA.MSG_VAR_CODE_8   = 'HT';                             11420000
     CNT_PIC15                      = RCBP24S_CEDS.HASH_TOTAL;          11430000
     PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC15;                        11440000
     CALL RCB0M1M (PTR_INT_AREA);                                       11450000
     CALL RCBBMBM_ERROR (NULL(),                                        11460000
                         'OTHER',                                       11470000
                         '#016');                                       11480000
   END;                                                                 11490000
0END RCBBMBM_CHECK_HASH;                                                11500000
1/********************************************************************/ 11510000
 /*                                                                  */ 11520000
 /* MODULE NAME      : RCBBMBM_CHECK_TRAILERS                        */ 11530000
 /*                                                                  */ 11540000
 /* DESCRIPTION      : CHECK THE TRAILERS                            */ 11550000
 /*                                                                  */ 11560000
 /********************************************************************/ 11570000
0RCBBMBM_CHECK_TRAILERS: PROC;                                          11580000
                                                                        11590000
 IF SK1.EOF = '1'                                                       11600000
 THEN DO;                            /* NO TRAILER RECORD            */ 11610000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 11620000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               11630000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0017';                             11640000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               11650000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'UPSTREAM FILE RCBBMA0';            11660000
   CALL RCB0M1M (PTR_INT_AREA);                                         11670000
   CALL RCBBMBM_ERROR (NULL(),                                          11680000
                      'OTHER',                                          11690000
                      '#017');                                          11700000
   END;                                                                 11710000
                                                                        11720000
 IF RCBBMBST_1.CNT_RECS ¬= COUNT.CNT_TOT.RCBBMA0                        11730000
 THEN DO;                          /* INVALID COUNT TRAILER        */   11740000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 11750000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               11760000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0007';                             11770000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               11780000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'UPSTREAM FILE RCBBMA0';            11790000
   PARM_INT_AREA.MSG_VAR_CODE_7   = 'C7';                               11800000
   PARM_INT_AREA.MSG_VAR_VALUE_7  = COUNT.CNT_TOT.RCBBMA0;              11810000
   PARM_INT_AREA.MSG_VAR_CODE_8   = 'C8';                               11820000
   PARM_INT_AREA.MSG_VAR_VALUE_8  = RCBBMBST_1.CNT_RECS;                11830000
   CALL RCB0M1M (PTR_INT_AREA);                                         11840000
   CALL RCBBMBM_ERROR (NULL(),                                          11850000
                      'OTHER',                                          11860000
                      '#018');                                          11870000
   END;                                                                 11880000
                                                                        11890000
 CALL RCBBMBM_READ1;                 /* CHECK RECORDS AFTER TRAILER  */ 11900000
 IF SK1.EOF = '0'                                                       11910000
 THEN DO;                          /* RECORDS AFTER TRAILER        */   11920000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 11930000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               11940000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0015';                             11950000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               11960000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'UPSTREAM FILE RCBBMA0';            11970000
   CALL RCB0M1M (PTR_INT_AREA);                                         11980000
   CALL RCBBMBM_ERROR (NULL(),                                          11990000
                      'OTHER',                                          12000000
                      '#019');                                          12010000
   END;                                                                 12020000
                                                                        12030000
 IF SK2.EOF = '1'                                                       12040000
 THEN DO;                            /* NO TRAILER RECORD            */ 12050000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 12060000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               12070000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0017';                             12080000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               12090000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'CEDS FILE RCBBE21';                12100000
   CALL RCB0M1M (PTR_INT_AREA);                                         12110000
   CALL RCBBMBM_ERROR (NULL(),                                          12120000
                      'OTHER',                                          12130000
                      '#020');                                          12140000
   END;                                                                 12150000
 IF RCBBMBST_2.CNT_RECS ¬= COUNT.CNT_TOT.RCBBE21                        12170000
 THEN DO;                          /* INVALID COUNT TRAILER        */   12180000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 12190000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               12200000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0007';                             12210000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               12220000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'CEDS FILE RCBBE21';                12230000
   PARM_INT_AREA.MSG_VAR_CODE_7   = 'C7';                               12240000
   PARM_INT_AREA.MSG_VAR_VALUE_7  = COUNT.CNT_CTRY.RCBBE21;             12250000
   PARM_INT_AREA.MSG_VAR_CODE_8   = 'C8';                               12260000
   PARM_INT_AREA.MSG_VAR_VALUE_8  = RCBBMBST_2.CNT_RECS;                12270000
   CALL RCB0M1M (PTR_INT_AREA);                                         12280000
   CALL RCBBMBM_ERROR (NULL(),                                          12290000
                      'OTHER',                                          12300000
                      '#021');                                          12310000
   END;                                                                 12320000
                                                                        12330000
 CALL RCBBMBM_READ2;                 /* CHECK RECORDS AFTER TRAILER  */ 12340000
 IF SK2.EOF = '0'                                                       12350000
 THEN DO;                          /* RECORDS AFTER TRAILER        */   12360000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 12370000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               12380000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0015';                             12390000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               12400000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'CEDS FILE RCBBE21';                12410000
   CALL RCB0M1M (PTR_INT_AREA);                                         12420000
   CALL RCBBMBM_ERROR (NULL(),                                          12430000
                      'OTHER',                                          12440000
                      '#022');                                          12450000
   END;                                                                 12460000
                                                                        12470000
 END RCBBMBM_CHECK_TRAILERS;                                            12480000
1/********************************************************************/ 12490000
 /*                                                                  */ 12500000
 /* MODULE NAME      : RCBBMBM_FILL_HEADER                           */ 12510000
 /*                                                                  */ 12520000
 /* DESCRIPTION      : FILL THE HEADER OF THE ACTION FILE            */ 12530000
 /*                                                                  */ 12540000
 /********************************************************************/ 12550000
0RCBBMBM_FILL_HEADER: PROC;                                             12560000
0IOAREA_OUT                   = '';                                     12570000
 RCBBMBSH_3.REC_TYPE          = '01';                                   12580000
 RCBBMBSH_3.FILE_ID           = 'RCBBMC0';                              12590000
 RCBBMBSH_3.SOURCE_INDICATOR  = WRK_SOURCE_INDICATOR;                   12600000
 RCBBMBSH_3.TIMESTAMP         = WRK_DATE_TIME;                          12610000
 CALL RCBBMBM_WRITE;                                                    12620000
 END RCBBMBM_FILL_HEADER;                                               12630000
1/********************************************************************/ 12640000
 /*                                                                  */ 12650000
 /* MODULE NAME      : RCBBMBM_FILL_TRAILERS                         */ 12660000
 /*                                                                  */ 12670000
 /* DESCRIPTION      : FILL THE TRAILER                              */ 12680000
 /*                                                                  */ 12690000
 /********************************************************************/ 12700000
0RCBBMBM_FILL_TRAILERS: PROC;                                           12710000
0IOAREA_OUT          = '';                                              12720000
 RCBBMBST_3.REC_TYPE = '99';                                            12730000
 RCBBMBST_3.CNT_RECS = COUNT.CNT_TOT.RCBBMC0;                           12740000
 CALL RCBBMBM_WRITE;                                                    12750000
 END RCBBMBM_FILL_TRAILERS;                                             12760000
1/********************************************************************/ 12770000
 /*                                                                  */ 12780000
 /* MODULE NAME      : RCBBMBM_SAVE_HASH                             */ 12790000
 /*                                                                  */ 12800000
 /* DESCRIPTION      : SAVE HASH TOTAL INFORMATION ON PARAMETER.     */ 12810000
 /*                    IF THE PARAMETER DOES NOT YET EXIST, IT WILL  */ 12820000
 /*                    BE INSERTED.                                  */ 12830000
 /*                                                                  */ 12840000
 /*                    ISSUE MESSAGE 0173                            */ 12850000
 /*                                                                  */ 12860000
 /********************************************************************/ 12870000
0 RCBBMBM_SAVE_HASH : PROC;                                             12880000
                                     /* INIT TABLESTRUCTURE          */ 12890000
 TB_RCBV500                  = '';                                      12900000
 TB_RCBV500_I                = '';                                      12910000
 TB_RCBP24S.NUMBER           = 'RCB024';                                12920000
 TB_RCBP24S.PROC_ID          = RCBPROC_REC.PROC_ID;                     12930000
 TB_RCBP24S.CTRYNO           = PREV_SSK.CTRYNO;                         12940000
 TB_RCBP24S.FILE_NAME        = WRK_FILE_ACT;                            12950000
 TB_RCBP24S.SEQ_NUMBER       = '01';                                    12960000
 TB_RCBP24S.TIME_STAMP       = WRK_DATE_TIME;                           12970000
 TB_RCBP24S.HASH_TOTAL       = COUNT.HASH_RCBBMC0;                      12980000
 TB_RCBP24S.LENGTH_PARM      = WRK_LENGTH_RCB024;                       12990000
                                                                        13000000
0CALL RCBG50M (ADDR(TB_RCBV500),    /* UPDATE PARAMETER RCB024    */    13010000
               ADDR(TB_RCBV500_I),                                      13020000
               PTR_RET_AREA_BB,                                         13030000
               PTR_INT_AREA);                                           13040000
0SELECT(PARM_RET_AREA_BB.RETURN_CODE);                                  13050000
   WHEN (0);                                                            13060000
   WHEN (4)                          /* WHEN NOT FOUND THEN INSERT  */  13070000
     DO;                                                                13080000
       CALL RCBF50M (ADDR(TB_RCBV500),                                  13090000
                     ADDR(TB_RCBV500_I),                                13100000
                     PTR_RET_AREA_BB,                                   13110000
                     PTR_INT_AREA);                                     13120000
       SELECT(PARM_RET_AREA_BB.RETURN_CODE);                            13130000
         WHEN (0);                                                      13140000
         OTHERWISE                                                      13150000
           DO;                                                          13160000
             CALL RCBBMBM_ERROR (ADDR (PARM_RET_AREA_BB.RETURN_SQL),    13170000
                                 'DB2',                                 13180000
                                 '#023');                               13190000
           END;                                                         13200000
       END;                                                             13210000
     END;                                                               13220000
   OTHERWISE                                                            13230000
      DO;                                                               13240000
        CALL RCBBMBM_ERROR (ADDR (PARM_RET_AREA_BB.RETURN_SQL),         13250000
                            'DB2',                                      13260000
                            '#024');                                    13270000
      END;                                                              13280000
 END;                                                                   13290000
                                                                        13300016
 PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 13310000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0173';                               13320000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   13330000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 13340000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_ACT;                         13350000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'TP';                                 13360000
 PARM_INT_AREA.MSG_VAR_VALUE_7  = WRK_DATE_TIME;                        13370000
 PARM_INT_AREA.MSG_VAR_CODE_8   = 'HT';                                 13380000
 CNT_PIC15                      = COUNT.HASH_RCBBMC0;                   13390000
 PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC15;                            13400016
 CALL RCB0M1M (PTR_INT_AREA);                                           13410016
                                                                        13420000
0END RCBBMBM_SAVE_HASH;                                                 13430000
1/********************************************************************/ 13440000
 /*                                                                  */ 13450000
 /* MODULE NAME      : RCBBMBM_END_COUNTRY                           */ 13460000
 /*                                                                  */ 13470000
 /* DESCRIPTION      : ENDING ACTIONS FOR A COUNTRY                  */ 13480000
 /*                                                                  */ 13490000
 /********************************************************************/ 13500000
0RCBBMBM_END_COUNTRY: PROC;                                             13510000
                                      /* ADD COUNTRY COUNTS TO TOTAL */ 13520000
                                                                        13530000
 COUNT.CNT_TOT.RCBBMA0   =  COUNT.CNT_TOT.RCBBMA0                       13540000
                              + COUNT.CNT_CTRY.RCBBMA0;                 13550000
 COUNT.CNT_TOT.RCBBE21   =  COUNT.CNT_TOT.RCBBE21                       13560000
                              + COUNT.CNT_CTRY.RCBBE21;                 13570000
 COUNT.CNT_TOT.RCBBMC0   =  COUNT.CNT_TOT.RCBBMC0                       13580000
                              + COUNT.CNT_CTRY.RCBBMC0;                 13590000
 COUNT.CNT_TOT.INSERTS   =  COUNT.CNT_TOT.INSERTS                       13600000
                              + COUNT.CNT_CTRY.INSERTS;                 13610000
 COUNT.CNT_TOT.UPDATES   =  COUNT.CNT_TOT.UPDATES                       13620000
                              + COUNT.CNT_CTRY.UPDATES;                 13630000
 COUNT.CNT_TOT.DELETES   =  COUNT.CNT_TOT.DELETES                       13640000
                              + COUNT.CNT_CTRY.DELETES;                 13650000
 COUNT.CNT_TOT.MATCHES   =  COUNT.CNT_TOT.MATCHES                       13660000
                              + COUNT.CNT_CTRY.MATCHES;                 13670000
 COUNT.CNT_TOT.SKIPPED   =  COUNT.CNT_TOT.SKIPPED                       13680000
                              + COUNT.CNT_CTRY.SKIPPED;                 13690000
                                                                        13700000
 PARM_INT_AREA.MESSAGE_TYPE     = 'IS';      /* ISSUE COUNT MESSAGES */ 13710000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0003';                               13720000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   13730000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 13740000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBMA0';                            13750000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C1';                                 13760000
                                                      /* SOC RB01299 */ 13761002
 /*CNT_PIC9                       = COUNT.CNT_CTRY.RCBBMA0;          */ 13770002
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                        */ 13780002
 CNT_PIC15                      = COUNT.CNT_CTRY.RCBBMA0;               13781002
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;          /* EOC RB01299 */ 13782005
 CALL RCB0M1M (PTR_INT_AREA);                                           13790000
                                                                        13800000
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 13810000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0003';                               13820000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   13830000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 13840000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBE21';                            13850000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C1';                                 13860000
                                                      /* SOC RB01299 */ 13861004
 /*CNT_PIC9                     = COUNT.CNT_CTRY.RCBBE21;            */ 13870004
 /*PARM_INT_AREA.MSG_VAR_VALUE_7= CNT_PIC9;                          */ 13880005
 CNT_PIC15                    = COUNT.CNT_CTRY.RCBBE21;                 13881004
 PARM_INT_AREA.MSG_VAR_VALUE_7= CNT_PIC15;            /* EOC RB01299 */ 13882005
 CALL RCB0M1M (PTR_INT_AREA);                                           13890000
                                                                        13891005
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 13900000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0004';                               13910000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   13920000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 13930000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBMC0';                            13940000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C6';                                 13950000
                                                      /* SOC RB01299 */ 13951002
 /*CNT_PIC9                     = COUNT.CNT_CTRY.RCBBMC0;            */ 13960002
 /*PARM_INT_AREA.MSG_VAR_VALUE_7= CNT_PIC9;                          */ 13970002
 CNT_PIC15                      = COUNT.CNT_CTRY.RCBBMC0;               13971002
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;          /* EOC RB01299 */ 13972005
 CALL RCB0M1M (PTR_INT_AREA);                                           13980000
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 13990000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0158';                               14000000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   14010000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'IN';                                 14020000
                                                      /* SOC RB01299 */ 14021002
 /*CNT_PIC9                     = COUNT.CNT_CTRY.INSERTS;            */ 14030002
 /*PARM_INT_AREA.MSG_VAR_VALUE_6= CNT_PIC9;                          */ 14040002
 CNT_PIC15                      = COUNT.CNT_CTRY.INSERTS;               14041002
 PARM_INT_AREA.MSG_VAR_VALUE_6  = CNT_PIC15;          /* EOC RB01299 */ 14042005
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'UP';                                 14050000
                                                      /* SOC RB01299 */ 14051002
 /*CNT_PIC9                     = COUNT.CNT_CTRY.UPDATES;            */ 14060002
 /*PARM_INT_AREA.MSG_VAR_VALUE_7= CNT_PIC9;                          */ 14070002
 CNT_PIC15                      = COUNT.CNT_CTRY.UPDATES;               14071002
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;          /* EOC RB01299 */ 14072005
 PARM_INT_AREA.MSG_VAR_CODE_8   = 'DL';                                 14080000
                                                      /* SOC RB01299 */ 14081002
 /*CNT_PIC9                       = COUNT.CNT_CTRY.DELETES;          */ 14090002
 /*PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC9;                        */ 14100002
 CNT_PIC15                      = COUNT.CNT_CTRY.DELETES;               14101002
 PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC15;          /* EOC RB01299 */ 14102005
 PARM_INT_AREA.MSG_VAR_CODE_9   = 'EQ';                                 14110000
                                                      /* SOC RB01299 */ 14111002
 /*CNT_PIC9                       = COUNT.CNT_CTRY.MATCHES;          */ 14120002
 /*PARM_INT_AREA.MSG_VAR_VALUE_9  = CNT_PIC9;                        */ 14130002
 CNT_PIC15                      = COUNT.CNT_CTRY.MATCHES;               14131002
 PARM_INT_AREA.MSG_VAR_VALUE_9  = CNT_PIC15;          /* EOC RB01299 */ 14132005
 PARM_INT_AREA.MSG_VAR_CODE_10  = 'SD';                                 14140000
                                                      /* SOC RB01299 */ 14141002
 /*CNT_PIC9                       = COUNT.CNT_CTRY.SKIPPED;          */ 14150002
 /*PARM_INT_AREA.MSG_VAR_VALUE_10 = CNT_PIC9;                        */ 14160002
 CNT_PIC15                      = COUNT.CNT_CTRY.SKIPPED;               14161002
 PARM_INT_AREA.MSG_VAR_VALUE_10 = CNT_PIC15;          /* EOC RB01299 */ 14162005
 CALL RCB0M1M (PTR_INT_AREA);                                           14170000
                                                                        14180000
 CALL RCBBMBM_CHECK_HASH;  /* CHECK HASH OF UPSTREAM AND CEDS FILE */   14190000
 CALL RCBBMBM_SAVE_HASH;   /* SAVE  HASH OF ACTION FILE IN RCB024  */   14200000
                                                                        14210000
0END RCBBMBM_END_COUNTRY;                                               14220000
1/********************************************************************/ 14230000
 /*                                                                  */ 14240000
 /* MODULE NAME      : RCBBMBM_TERM                                  */ 14250000
 /*                                                                  */ 14260000
 /* DESCRIPTION      : TERMINATE PROGRAM                             */ 14270000
 /*                                                                  */ 14280000
 /********************************************************************/ 14290000
0RCBBMBM_TERM: PROC;                                                    14300000
0PARM_INT_AREA.COUNTRY_NUMBER   = '';                                   14310000
0CALL RCBBMBM_CHECK_TRAILERS;                                           14330000
 CALL RCBBMBM_FILL_TRAILERS;                                            14340000
                                                                        14350000
 PARM_INT_AREA.MESSAGE_TYPE     = 'IS';      /* ISSUE COUNT MESSAGES */ 14360000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0003';                               14370000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   14380000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 14390000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBMA0';                            14400000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C1';                                 14410000
                                                      /* SOC RB01299 */ 14411002
 /*CNT_PIC9                       = COUNT.CNT_TOT.RCBBMA0;           */ 14420002
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                        */ 14430002
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                        */ 14430126
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                        */ 14430226
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                        */ 14430326
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                        */ 14430426
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                        */ 14430526
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                        */ 14430626
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                        */ 14430726
 CNT_PIC15                      = COUNT.CNT_TOT.RCBBMA0;                14431627
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;          /* EOC RB01299 */ 14432005
 CALL RCB0M1M (PTR_INT_AREA);                                           14440000
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 14450000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0003';                               14460000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   14470000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 14480000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBE21';                            14490000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C1';                                 14500000
                                                      /* SOC RB01299 */ 14501004
 /*CNT_PIC9                     = COUNT.CNT_TOT.RCBBE21;             */ 14510004
 /*PARM_INT_AREA.MSG_VAR_VALUE_7= CNT_PIC9;                          */ 14520004
 CNT_PIC15                      = COUNT.CNT_TOT.RCBBE21;                14521004
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;          /* EOC RB01299 */ 14522005
 CALL RCB0M1M (PTR_INT_AREA);                                           14530000
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 14540000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0004';                               14550000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   14560000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 14570000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBMC0';                            14580000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C6';                                 14590000
                                                      /* SOC RB01299 */ 14591002
 /*CNT_PIC9                       = COUNT.CNT_TOT.RCBBMC0;           */ 14600002
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                        */ 14610002
 CNT_PIC15                      = COUNT.CNT_TOT.RCBBMC0;                14611002
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;          /* EOC RB01299 */ 14612005
 CALL RCB0M1M (PTR_INT_AREA);                                           14620000
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 14630000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0158';                               14640000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   14650000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'IN';                                 14660000
                                                      /* SOC RB01299 */ 14661002
 /*CNT_PIC9                       = COUNT.CNT_TOT.INSERTS;           */ 14670002
 /*PARM_INT_AREA.MSG_VAR_VALUE_6  = CNT_PIC9;                        */ 14680002
 CNT_PIC15                      = COUNT.CNT_TOT.INSERTS;                14681002
 PARM_INT_AREA.MSG_VAR_VALUE_6  = CNT_PIC15;          /* EOC RB01299 */ 14682005
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'UP';                                 14690000
                                                      /* SOC RB01299 */ 14691002
 /*CNT_PIC9                       = COUNT.CNT_TOT.UPDATES;           */ 14700002
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                        */ 14710002
 CNT_PIC15                      = COUNT.CNT_TOT.UPDATES;                14711002
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;          /* EOC RB01299 */ 14712005
 PARM_INT_AREA.MSG_VAR_CODE_8   = 'DL';                                 14720000
                                                      /* SOC RB01299 */ 14721002
 /*CNT_PIC9                       = COUNT.CNT_TOT.DELETES;           */ 14730002
 /*PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC9;                        */ 14740002
 CNT_PIC15                      = COUNT.CNT_TOT.DELETES;                14741002
 PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC15;          /* EOC RB01299 */ 14742005
 PARM_INT_AREA.MSG_VAR_CODE_9   = 'EQ';                                 14750000
                                                      /* SOC RB01299 */ 14751002
 /*CNT_PIC9                       = COUNT.CNT_TOT.MATCHES;           */ 14760002
 /*PARM_INT_AREA.MSG_VAR_VALUE_9  = CNT_PIC9;                        */ 14770002
 CNT_PIC15                      = COUNT.CNT_TOT.MATCHES;                14771002
 PARM_INT_AREA.MSG_VAR_VALUE_9  = CNT_PIC15;          /* EOC RB01299 */ 14772005
 PARM_INT_AREA.MSG_VAR_CODE_10  = 'SD';                                 14780000
                                                      /* SOC RB01299 */ 14781002
 /*CNT_PIC9                       = COUNT.CNT_TOT.SKIPPED;           */ 14790002
 /*PARM_INT_AREA.MSG_VAR_VALUE_10 = CNT_PIC9;                        */ 14800002
 CNT_PIC15                      = COUNT.CNT_TOT.SKIPPED;                14800102
 PARM_INT_AREA.MSG_VAR_VALUE_10 = CNT_PIC15;          /* EOC RB01299 */ 14800205
 CALL RCB0M1M (PTR_INT_AREA);                                           14810000
                                     /* CLOSE ALL FILES              */ 14820000
 CLOSE FILE (RCBBMA0);                                                  14830000
 CLOSE FILE (RCBBE21);                                                  14840000
 CLOSE FILE (RCBBMC0);                                                  14850000
 CLOSE FILE (RCBPROC);                                                  14860000
                                     /* ISSUE END MESSAGE            */ 14870000
 PARM_INT_AREA.MSG_AREA.MESSAGE_TYPE     = 'IS';                        14880000
 PARM_INT_AREA.MSG_AREA.MESSAGE_NUMBER   = '9999';                      14890000
 PARM_INT_AREA.MSG_AREA.MSG_VAR_CODES    = ' ';                         14900000
 CALL RCB0M1M (PTR_INT_AREA);                                           14910000
                                     /* CLOSE MESSAGE FILE           */ 14920000
 PARM_INT_AREA.MSG_REQUEST    = 'C';                                    14930000
 CALL RCB0M1M (PTR_INT_AREA);                                           14940000
 END RCBBMBM_TERM;                                                      14950000
1/********************************************************************/ 14960000
 /*                                                                  */ 14970000
 /* MODULE NAME      : RCBBMBM_DATE                                  */ 14980000
 /*                                                                  */ 14990000
 /* DESCRIPTION      : CALCULATE DATES                               */ 15000000
 /*                                                                  */ 15010000
 /********************************************************************/ 15020000
0RCBBMBM_DATE: PROC(DATE1, NUMBER) RETURNS(CHAR(10));                   15030000
0DCL DATE1        CHAR(10);                                             15040000
 DCL NUMBER       FIXED DEC(15);                                        15050000
0RCBZ03S.WD_PERIOD  = NUMBER;                                           15060000
 RCBZ03S.WD_IN_DATE = DATE1;                                            15070000
 CALL RCB004M (ADDR (RCBZ03S));                                         15080000
 SELECT (RCBZ03S.WD_STATUS);                                            15090000
 WHEN ('')                                                              15100000
   DO;                                                                  15110000
     RETURN (SUBSTR (RCBZ03S.WD_OUT_DATE,1,10));                        15120000
   END;                                                                 15130000
 OTHERWISE                                                              15140000
   DO;                                                                  15150000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             15160000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0007';                           15170000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               15180000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'RC';                             15190000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = RCBZ03S.WD_STATUS;                15200000
     CALL RCB0M1M (PTR_INT_AREA);                                       15210000
                                     /* ABEND                        */ 15220000
     CALL RCBBMBM_ERROR (NULL(),                                        15230000
                         'OTHER',                                       15240000
                         '#025');                                       15250000
   END;                                                                 15260000
 END;                                                                   15270000
 END RCBBMBM_DATE;                                                      15280000
1/********************************************************************/ 15290000
 /*                                                                  */ 15300000
 /* MODULE NAME      : RCBBMBM_ERROR                                 */ 15310000
 /*                                                                  */ 15320000
 /* DESCRIPTION      : CALLS THE COMMON ERROR ROUTINE AFTER FILLING  */ 15330000
 /*                    THE INPUT VARIABLES                           */ 15340000
 /*                                                                  */ 15350000
 /********************************************************************/ 15360000
0 RCBBMBM_ERROR: PROC (PTR_ERROR,                                       15370000
                       ERR_TYPE,                                        15380000
                       CALL_ID);                                        15390000
0DCL PTR_ERROR    PTR;                                                  15400000
 DCL ERR_TYPE     CHAR(8);                                              15410000
 DCL CALL_ID      CHAR(4);                                              15420000
0PARM_INT_AREA.PTR_ERROR         = PTR_ERROR;                           15430000
 PARM_INT_AREA.ERR_TYPE          = ERR_TYPE;                            15440000
 PARM_INT_AREA.CALL_ID           = CALL_ID;                             15450000
0CALL RCB0E1M (PTR_INT_AREA);                                           15460000
0END RCBBMBM_ERROR;                                                     15470000
1/********************************************************************/ 15480000
 /* DO NOT CHANGE THIS PART, IT IS MEANT FOR ABR                     */ 15490000
 /********************************************************************/ 15500000
0%INCLUDE DAIFPLH ;                    /* COMPILE DATE/TIME STAMP    */ 15510000
 $DAIMOD (RCBBMBM);                    /* MODULE TO BE COMPILED      */ 15520000
0/********************************************************************/ 15530000
 /* END OF ABR BLOCK                                                 */ 15540000
 /********************************************************************/ 15550000
 END RCBBMBM;                                                           15560000