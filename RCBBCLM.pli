 /* RCBBCLM - COMPARE FOR RCBV0260_HW_IN_ORD                         */ 00010000
 /*                                                                  */ 00020000
 /* 5695-153 (C) COPYRIGHT IBM EMEA WORLD TRADE CORPORATION 1991     */ 00030000
 /* LICENSED MATERIAL - PROGRAM PROPERTY OF IBM                      */ 00040000
 /* REFER TO COPYRIGHT INSTRUCTIONS: FORM G120-2083                  */ 00050000
 /*                                                                  */ 00060000
 /********************************************************************/ 00070000
 /* PROGRAM          : RCBBCLP                                       */ 00080000
 /*                                                                  */ 00090000
 /* LANGUAGE         : PLI                                           */ 00100000
 /*                                                                  */ 00110000
 /* DATE GENERATED   : 30 JUN 2004 - 09:39:15                        */ 00120000
 /*                                                                  */ 00130000
 /* GENERATED BY     : RCBB0PZ0 - GENERATE COMPARE PROGRAM           */ 00140000
 /*                                                                  */ 00150000
 /* TYPE             : BATCH                                         */ 00160000
 /*                                                                  */ 00170000
 /* DESCRIPTION      : COMPARE FOR RCBV0260_HW_IN_ORD                */ 00180000
 /*                    THIS PROGRAM COMPARES TWO INPUT FILES,        */ 00190000
 /*                    DIFFERENCES WILL RESULT IN RECORDS            */ 00200000
 /*                    ON THE ACTIONS FILE.                          */ 00210000
 /*                    THE COMPARE PROCESS IS OF TYPE 2,             */ 00220000
 /*                    DATES INVOLVED, EFF. DATE NOT PART OF KEY.    */ 00240000
 /*                                                                  */ 00260000
 /* INPUT            : - FILES : UPSTREAM RCBBCA7                    */ 00270000
 /*                              CEDS     RCBBC61                    */ 00280000
 /*                                                                  */ 00290000
 /* OUTPUT           : - FILES : ACTIONS  RCBBCL1                    */ 00300000
 /*                              MESSAGE  RCB0M1F0                   */ 00310000
 /*                                                                  */ 00320000
 /* EXTERNAL MODULES : - RCB0M1M   MESSAGE MODULE                    */ 00330000
 /*                    - RCB0E1M   ERROR MODULE                      */ 00340000
 /*                    - RCB0T1M   RETRIEVE SYSTEM DATE              */ 00350000
 /*                    - RCB004M   DATE CALCULATION                  */ 00360000
 /*                    - RCB018M   CALCULATE HASH TOTALS             */ 00370000
 /*                    - RCBF50M   INSERT    PARAMETER               */ 00380000
 /*                    - RCBG50M   UPDATE    PARAMETER               */ 00390000
 /*                    - RCBI50M   REFERENCE PARAMETER               */ 00400000
 /*                                                 SOC CEDS00000618 */ 00400115
 /*                    - RCBIADM   REFERENCE BUILDING BLOCK          */ 00401008
 /*                                                 EOC CEDS00000618 */ 00402015
 /*                                                                  */ 00410000
 /* MESSAGES         : 0003,0004,0007,0013,0014,0015,0017,0018,      */ 00420000
 /*                    0158,0167,0173,0174,0175,9999                 */ 00430000
 /*                                                                  */ 00440000
 /* THE FOLLOWING EXCEPTION ROUTINES HAVE BEEN APPLIED DURING        */ 00450000
 /* GENERATION :  5                                                  */ 00460000
 /*                                                                  */ 00470000
 /* MAINTENANCE LOG  :                                               */ 00480000
 /* ---------------                                                  */ 00490000
 /*                                                                  */ 00500000
 /* DATE       | WORK-ITEMNO. | DESCRIPTION                          */ 00510000
 /* ---------------------------------------------------------------- */ 00520000
 /* 1992-03-02 |              | INITIAL DEVELOPMENT                  */ 00530000
 /* 1992-07-20 | CED0001      | QF A1: HASH TOTAL & TIMESTAMP CHECK  */ 00540000
 /* 1993-02-27 | RC1032       | MCO / NULL INDICATORS                */ 00550000
 /* 1994-05-27 | PTM 519      | SEE PTM DESCRIPTION                  */ 00560000
 /* 1995-08-04 | RC01141      | FILL SEQUENCE_KEY (DG)               */ 00570000
 /* 1997-04-09 | PTM1036      | USE STANDARD PROLOG                  */ 00580000
 /* 1999-07-28 | RC01219      | DORO                                 */ 00590000
 /* 2000-05-16 | PTM1324      | ONLINE ADDITIONAL SERVICE ROWS DELETE*/ 00600000
 /* 2012-12-17 | CEDS00000618 | IGNORE LARGE NUMBER OF UPDATE DUE TO */ 00601015
 /*            |              | OU CODE NOT FOUND IN RCBT0040_OU     */ 00602008
 /*                                                                  */ 00610000
 /********************************************************************/ 00620000
1RCBBCLM: PROC                                                          00630000
          OPTIONS (MAIN)                                                00640000
          REORDER;                                                      00650000
0/********************************************************************/ 00660000
 /* FILE DECLARATIONS                                                */ 00670000
 /********************************************************************/ 00680000
0DCL RCBBCA7        FILE             /* UPSTREAM FILE                */ 00690000
                    RECORD                                              00700000
                    INPUT                                               00710000
                    SEQUENTIAL                                          00720000
                    ENV (FB RECSIZE(214));                              00730000
 DCL RCBBC61        FILE             /* CEDS FILE                    */ 00740000
                    RECORD                                              00750000
                    INPUT                                               00760000
                    SEQUENTIAL                                          00770000
                    ENV (FB RECSIZE(214));                              00780000
 DCL RCBBCL1        FILE             /* ACTIONS FILE                 */ 00790000
                    RECORD                                              00800000
                    OUTPUT                                              00810000
                    SEQUENTIAL                                          00820000
                    ENV (FB RECSIZE(215));                              00830000
                                                                        00840000
 DCL RCBPROC        FILE             /* INPUT CARD FOR PROC_ID       */ 00850000
                    RECORD                                              00860000
                    INPUT;                                              00870000
0/********************************************************************/ 00880000
 /* RECORD STRUCTURES FOR FILES                                      */ 00890000
 /********************************************************************/ 00900000
0                                    /*   IOAREA UPSTREAM FILE       */ 00910000
 DCL IOAREA_IN_1    CHAR(214);                                          00920000
 DCL 1 RCBBCLSH_1   BASED(ADDR(IOAREA_IN_1)),                           00930000
       %INCLUDE RCBBAASH;;                                              00940000
 DCL 1 RCBBCLST_1   BASED(ADDR(IOAREA_IN_1)),                           00950000
       %INCLUDE RCBBAAST;;                                              00960000
 DCL 1 RCBBCLS1_1   BASED(ADDR(IOAREA_IN_1)),                           00970000
       %INCLUDE RCBBAAS1;,                                              00980000
      3 RCB260S,                                                        00990000
        %INCLUDE RCB260S;,                                              01000000
      3 RCB260SI,                                                       01010000
        %INCLUDE RCB260SI;;                                             01020000
                                     /*   IOAREA CEDS FILE           */ 01030000
 DCL IOAREA_IN_2    CHAR(214);                                          01040000
 DCL 1 RCBBCLSH_2   BASED(ADDR(IOAREA_IN_2)),                           01050000
       %INCLUDE RCBBAASH;;                                              01060000
 DCL 1 RCBBCLST_2   BASED(ADDR(IOAREA_IN_2)),                           01070000
       %INCLUDE RCBBAAST;;                                              01080000
 DCL 1 RCBBCLS1_2   BASED(ADDR(IOAREA_IN_2)),                           01090000
       %INCLUDE RCBBAAS1;,                                              01100000
      3 RCB260S,                                                        01110000
        %INCLUDE RCB260S;,                                              01120000
      3 RCB260SI,                                                       01130000
        %INCLUDE RCB260SI;;                                             01140000
                                     /*   IOAREA ACTIONS FILE        */ 01150000
 DCL IOAREA_OUT     CHAR(215);                                          01160000
 DCL 1 RCBBCLSH_3   BASED(ADDR(IOAREA_OUT)),                            01170000
       %INCLUDE RCBBAASH;;                                              01180000
 DCL 1 RCBBCLST_3   BASED(ADDR(IOAREA_OUT)),                            01190000
       %INCLUDE RCBBAAST;;                                              01200000
 DCL 1 RCBBCLS2_3   BASED(ADDR(IOAREA_OUT)),                            01210000
       %INCLUDE RCBBAAS2;,                                              01220000
      3 RCB260S,                                                        01230000
        %INCLUDE RCB260S;,                                              01240000
      3 RCB260SI,                                                       01250000
        %INCLUDE RCB260SI;;                                             01260000
                                                 /* SOC  CEDS00000618 */01260115
 DCL 1 RCB040S,                                                         01261006
        %INCLUDE (RCB040S);;                                            01264006
 DCL 1 RCB040SI,                                                        01264106
        %INCLUDE (RCB040SI);;                                           01266006
 DCL 1 RCBP13S,                                                         01266111
       %INCLUDE (RCBP13S);;                                             01266211
                                                 /* EOC  CEDS00000618 */01267015
                                     /*   INPUT CARD                 */ 01270000
 DCL 1 RCBPROC_REC,                                                     01280000
       %INCLUDE (RCBZ27S);;                                             01290000
0/********************************************************************/ 01300000
 /* EXTERNAL PARAMETER INTERFACES                                    */ 01310000
 /********************************************************************/ 01320000
0DCL PTR_INT_AREA            PTR;                                       01330000
 DCL PTR_RET_AREA_BB         PTR;                                       01340000
0DCL 1 PARM_INT_AREA,                                                   01350000
       %INCLUDE RCBZ01S;;                                               01360000
 DCL 1 PARM_RET_AREA_BB,                                                01370000
       %INCLUDE RCBZ02S;;                                               01380000
 DCL 1 RCBZ03S,                                                         01390000
       %INCLUDE RCBZ03S;;                                               01400000
                                                 /* SOC  CEDS00000618 */01400115
 DCL RCB040S_PTR    PTR;                                                01401006
 DCL RCB040SI_PTR   PTR;                                                01402006
 DCL RCBV500_PTR    PTR;                                                01402114
 DCL RCBV500I_PTR   PTR;                                                01402214
                                                 /* EOC  CEDS00000618 */01403015
0/********************************************************************/ 01410000
 /* DB2 TABLE STRUCTURES                                             */ 01420000
 /********************************************************************/ 01430000
0DCL 1 TB_RCBV500,                                                      01440000
       %INCLUDE (RCB500S);;                                             01450000
0DCL 1 TB_RCBV500_I,                                                    01460000
       %INCLUDE (RCB500SI);;                                            01470000
0DCL 1 TB_RCBP24S         BASED (ADDR (TB_RCBV500)),                    01480000
       %INCLUDE (RCBP24S);;                                             01490000
                                                 /* SOC  CEDS00000618 */01490115
 DCL 1 TB_RCBP13S             BASED (RCBV500_PTR),                      01491011
       %INCLUDE (RCBP13S);;                                             01492011
                                                 /* EOC  CEDS00000618 */01493015
0/********************************************************************/ 01500000
 /* SORT KEYS                                                        */ 01510000
 /********************************************************************/ 01520000
0DCL 1 SSK,                          /* SMALLEST SORT KEY            */ 01530000
      3 EOF                  CHAR(1)      INIT('0'),                    01540000
      3 REC_TYPE             CHAR(2),                                   01550000
      3 CTRYNO               CHAR(3),                                   01560000
      3 ORDER_REF_NUMBER     CHAR(6),                                   01561000
      3 COUNTRY_NUMBER       CHAR(3),                                   01562000
      3 END                  CHAR(0);                                   01570000
 DCL 1 PREV_SSK     LIKE SSK;        /* PREVIOUS SMALLEST SORT KEY   */ 01580000
 DCL 1 SK1          LIKE SSK;        /* SORT KEY UPSTREAM FILE       */ 01590000
 DCL 1 SK2          LIKE SSK;        /* SORT KEY CEDS FILE           */ 01600000
0/********************************************************************/ 01610000
 /* EXTERNAL ENTRIES                                                 */ 01620000
 /********************************************************************/ 01630000
0DCL RCB0M1M  EXT ENTRY;             /* MESSAGE MODULE               */ 01640000
 DCL RCB0E1M  EXT ENTRY;             /* ERROR MODULE                 */ 01650000
 DCL RCB0T1M  EXT ENTRY;             /* RETRIEVE SYSTEM DATE         */ 01660000
 DCL RCB004M  EXT ENTRY;             /* DATE CALCULATION             */ 01670000
 DCL RCB018M  EXT ENTRY;             /* CALCULATE HASH TOTALS        */ 01680000
 DCL RCBF50M  EXT ENTRY;             /* INSERT   PARAMETER           */ 01690000
 DCL RCBG50M  EXT ENTRY;             /* UPDATE   PARAMETER           */ 01700000
 DCL RCBI50M  EXT ENTRY;             /* RETRIEVE PARAMETER           */ 01710000
                                                /* SOC  CEDS00000618 */ 01710115
 DCL RCBIADM  EXT ENTRY;             /* REFERENCE BUILDING BLOCK     */ 01711008
                                                /* EOC  CEDS00000618 */ 01712015
0/********************************************************************/ 01720000
 /* COUNTS                                                           */ 01730000
 /********************************************************************/ 01740000
0DCL 1 COUNT,                                                           01750000
       3 CNT_CTRY,                                                      01760000
         5 RCBBCA7       FIXED DEC(9),    /* COUNT UPSTREAM RECORDS  */ 01770000
         5 RCBBC61       FIXED DEC(9),    /* COUNT CEDS RECORDS      */ 01780000
         5 RCBBCL1       FIXED DEC(9),    /* COUNT ACTIONS RECORDS   */ 01790000
         5 MATCHES       FIXED DEC(9),    /* COUNT MATCHED RECORDS   */ 01800000
         5 INSERTS       FIXED DEC(9),    /* COUNT INSERT ACTIONS    */ 01810000
         5 UPDATES       FIXED DEC(9),    /* COUNT UPDATE ACTIONS    */ 01820000
         5 DELETES       FIXED DEC(9),    /* COUNT DELETE ACTIONS    */ 01830000
         5 SKIPPED       FIXED DEC(9),    /* COUNT SKIPPED ACTIONS   */ 01840000
         5 HASH_RCBBCA7 FIXED DEC(15,0), /* HASH UPSTREAM FILE       */ 01850000
         5 HASH_RCBBC61 FIXED DEC(15,0), /* HASH CEDS FILE           */ 01860000
         5 HASH_RCBBCL1 FIXED DEC(15,0), /* HASH ACTION FILE         */ 01870000
       3 CNT_TOT,                                                       01880000
         5 RCBBCA7       FIXED DEC(9),    /* TOTAL UPSTREAM RECORDS  */ 01890000
         5 RCBBC61       FIXED DEC(9),    /* TOTAL CEDS RECORDS      */ 01900000
         5 RCBBCL1       FIXED DEC(9),    /* TOTAL ACTIONS RECORDS   */ 01910000
         5 MATCHES       FIXED DEC(9),    /* TOTAL MATCHED RECORDS   */ 01920000
         5 INSERTS       FIXED DEC(9),    /* TOTAL INSERT ACTIONS    */ 01930000
         5 UPDATES       FIXED DEC(9),    /* TOTAL UPDATE ACTIONS    */ 01940000
         5 DELETES       FIXED DEC(9),    /* TOTAL DELETE ACTIONS    */ 01950000
         5 SKIPPED       FIXED DEC(9);    /* TOTAL SKIPPED ACTIONS   */ 01960000
                                                                        01970000
 DCL CNT_PIC9         PIC'(09)9';       /* CONVERSION OF COUNTS      */ 01980000
 DCL CNT_PIC15        PIC'(15)9';       /* CONVERSION OF HASH TOTAL  */ 01990000
0/********************************************************************/ 02000000
 /* PROGRAM CONTROL PARAMETERS                                       */ 02010000
 /********************************************************************/ 02020000
0DCL 1 RCBP24S_UPSTR,                                                   02030000
     %INCLUDE (RCBP24S);;                                               02040000
0DCL 1 RCBP24S_CEDS,                                                    02050000
     %INCLUDE (RCBP24S);;                                               02060000
0/********************************************************************/ 02070000
 /* BIT SWITCHES                                                     */ 02080000
 /********************************************************************/ 02090000
0DCL TRUE                BIT(1)             INIT ('1'B);                02100000
 DCL FALSE               BIT(1)             INIT ('0'B);                02110000
 DCL SWITCH_CHANGED      BIT(1);                                        02120000
 DCL SWITCH_EOF_RCBPROC  BIT (1)            INIT ('0'B);                02130000
                                                 /* SOC  CEDS00000618 */02130115
 DCL SWITCH_OU_NOT_FOUND BIT (1)            INIT ('0'B);                02131012
                                                 /* EOC  CEDS00000618 */02132015
0/********************************************************************/ 02140000
 /* ALL OTHER USED TEMPORARY FIELDS                                  */ 02150000
 /********************************************************************/ 02160000
0DCL 1 WORK_FIELDS,                                                     02170000
       3 WRK_MOD_NAME             CHAR(8),                              02180000
       3 WRK_CTRYNO               CHAR(3),                              02190000
       3 WRK_SOURCE_INDICATOR     CHAR(1),                              02200000
       3 WRK_HASH_FIELD           CHAR(4),                              02210000
       3 WRK_LENGTH_RCB024        FIXED BIN (15,0),                     02220000
       3 WRK_FILE_UPSTR           CHAR(7)       INIT ('RCBBCA7'),       02230000
       3 WRK_FILE_CEDS            CHAR(7)       INIT ('RCBBC61'),       02240000
       3 WRK_FILE_ACT             CHAR(7)       INIT ('RCBBCL1'),       02250000
       3 WRK_DATE_TIME            CHAR(20)      INIT (' '),             02260000
       3 WRK_TIME_STAMP_RCBBCA7   CHAR(20)      INIT (' '),             02270000
       3 WRK_TIME_STAMP_RCBBC61   CHAR(20)      INIT (' '),             02280000
       3 WRK_RUN_DATE             CHAR(10),                             02290000
       3 WRK_EFF_DATE             CHAR(10),                             02300000
       3 WRK_END_DATE             CHAR(10);                             02310000
0/********************************************************************/ 02340000
 /* BUILTIN                                                          */ 02350000
 /********************************************************************/ 02360000
0DCL (ADDR,                                                             02370000
      CSTG,                                                             02380000
      LOW,                                                              02390000
      NULL,                                                             02400000
      STRING,                                                           02410000
      SUBSTR,                                                           02420000
      TIME,                                                             02430000
      VERIFY) BUILTIN;                                                  02440000
0/********************************************************************/ 02450000
 /* ON CONDITIONS                                                    */ 02460000
 /********************************************************************/ 02470000
0ON ENDFILE (RCBBCA7)                                                   02480000
   SK1.EOF = '1';                                                       02490000
 ON ENDFILE (RCBBC61)                                                   02500000
   SK2.EOF = '1';                                                       02510000
 ON ENDFILE (RCBPROC)                                                   02520000
   SWITCH_EOF_RCBPROC = TRUE;                                           02530000
0/********************************************************************/ 02540000
 /* ON ERROR CONDITIONS                                              */ 02550000
 /********************************************************************/ 02560000
0%INCLUDE RCB0E0M;                                                      02570000
 END;                                                                   02580000
1/********************************************************************/ 02590000
 /*                 S T A R T   P R O C E S S I N G                  */ 02600000
 /********************************************************************/ 02610000
0CALL RCBBCLM_INIT;                                                     02620000
0DO WHILE (SSK.EOF = '0'                                                02630000
        &  SSK.REC_TYPE ¬= '99');    /* WHILE NOT EOF                */ 02640000
0  CALL RCBBCLM_INIT_COUNTRY;                                           02650000
0  DO WHILE (SUBSTR (STRING (PREV_SSK), 1, 6)  /* WHILE SAME COUNTRY */ 02660000
             = SUBSTR (STRING (SSK), 1, 6));                            02670000
     SELECT;                                                            02680000
                                     /* SK UPSTREAM SMALLEST         */ 02690000
       WHEN (STRING(SK1) < STRING(SK2)) DO;                             02700000
         CALL RCBBCLM_INS;                                              02710000
         CALL RCBBCLM_CALC1;                                            02720000
         CALL RCBBCLM_READ1;                                            02730000
         END;                                                           02740000
                                     /* SK CEDS SMALLEST             */ 02750000
       WHEN (STRING(SK2) < STRING(SK1)) DO;                             02760000
         CALL RCBBCLM_DEL;                                              02770000
         CALL RCBBCLM_CALC2;                                            02780000
         CALL RCBBCLM_READ2;                                            02790000
         END;                                                           02800000
                                     /* KEYS ARE EQUAL               */ 02810000
       OTHERWISE DO;                 /* SOME DATA FIELDS MAY DIFFER  */ 02820000
         IF IOAREA_IN_1 ¬= IOAREA_IN_2                                  02830005
         THEN DO;                                                       02840005
           CALL RCBBCLM_UPD;                                            02850000
           END;                                                         02860005
         ELSE DO;                                                       02870000
           COUNT.CNT_CTRY.MATCHES = COUNT.CNT_CTRY.MATCHES + 1;         02880000
           END;                                                         02890000
         CALL RCBBCLM_CALC1;                                            02900000
         CALL RCBBCLM_READ1;         /* READ NEXT UPSTREAM RECORD    */ 02910000
         CALL RCBBCLM_CALC2;                                            02920000
         CALL RCBBCLM_READ2;         /* READ NEXT CEDS RECORD        */ 02930000
         END;                                                           02940000
     END;                                                               02950000
                                                                        02960000
     CALL RCBBCLM_SIC;               /* SET ITERATION CONDITIONS     */ 02970000
   END;                                                                 02980000
0  CALL RCBBCLM_END_COUNTRY;                                            02990000
0END;                                                                   03000000
                                     /* TERMINATE PROGRAM            */ 03010000
 CALL RCBBCLM_TERM;                                                     03020000
1/********************************************************************/ 03030000
 /*                                                                  */ 03040000
 /* MODULE NAME      : RCBBCLM_INIT                                  */ 03050000
 /*                                                                  */ 03060000
 /* DESCRIPTION      : INIT PROGRAM                                  */ 03070000
 /*                                                                  */ 03080000
 /********************************************************************/ 03090000
0RCBBCLM_INIT: PROC;                                                    03100000
                                     /* INITIALIZE POINTERS          */ 03110000
 PTR_INT_AREA    = ADDR (PARM_INT_AREA);                                03120000
 PTR_RET_AREA_BB = ADDR (PARM_RET_AREA_BB);                             03130000
                                                 /* SOC  CEDS00000618 */03130115
 RCB040S_PTR     = ADDR (RCB040S);                                      03131006
 RCB040SI_PTR    = ADDR (RCB040SI);                                     03132006
 RCBV500_PTR     = ADDR (TB_RCBV500);                                   03132111
 RCBV500I_PTR    = ADDR (TB_RCBV500_I);                                 03132211
                                                 /* EOC  CEDS00000618 */03133015
                                     /* INITIALIZE MESSAGE AREA      */ 03140000
 WRK_MOD_NAME                  = SDAISTP.SDAINAM;                       03150000
 PARM_INT_AREA.MSG_AREA        = '';                                    03160000
 PARM_INT_AREA.ERR_AREA        = '';                                    03170000
 PARM_INT_AREA.MSG_REQUEST     = 'O';                                   03180000
 PARM_INT_AREA.MSG_TARGET      = 'F';                                   03190000
 PARM_INT_AREA.ID_SOURCE_APPL  = 'RCB';                                 03200000
 PARM_INT_AREA.ID_SOURCE_PROG  = SUBSTR(WRK_MOD_NAME,1,6) || 'P';       03210000
 PARM_INT_AREA.ID_MOD_PATH (1) = WRK_MOD_NAME;                          03220000
 PARM_INT_AREA.ID_MOD_LEVEL    = 1;                                     03230000
 PARM_INT_AREA.PTR_PCB_IO      = NULL();                                03240000
 PARM_INT_AREA.PTR_PCB_ALT     = NULL();                                03250000
 PARM_INT_AREA.SYSTEM_TYPE     = 'B';                                   03260000
0PARM_INT_AREA.COUNTRY_NUMBER  = '';                                    03270000
                                     /* OPEN MESSAGE FILE            */ 03280000
 CALL RCB0M1M (PTR_INT_AREA);                                           03290000
                                     /* RETRIEVE SYSTEM DATE         */ 03300000
 CALL RCB0T1M (PTR_INT_AREA);                                           03310000
                                     /* INIT OTHER VARIABLES         */ 03320000
 SK1.EOF                = '0';                                          03330000
 SK2.EOF                = '0';                                          03340000
 COUNT                  =  0;                                           03350000
 WRK_CTRYNO             =  LOW(3);                                      03360000
 WRK_DATE_TIME          =  PARM_INT_AREA.SYSTEM_DATE || '.' || TIME();  03370000
 WRK_LENGTH_RCB024      = CSTG (TB_RCBP24S.TIME_STAMP) +                03380000
                          CSTG (TB_RCBP24S.HASH_TOTAL);                 03390000
 RCBZ03S.WD_IN_FORMAT   = 'ISO';                                        03400000
 RCBZ03S.WD_OUT_FORMAT  = 'ISO';                                        03410000
 RCBZ03S.WD_FUNCTION    = 'C';                                          03420000
 RCBZ03S.WD_PERIOD_TYPE = 'D';                                          03430000
                                                                        03440000
 OPEN FILE (RCBBCA7);            /* OPEN ALL FILES                  */  03450000
 OPEN FILE (RCBBC61);                                                   03460000
 OPEN FILE (RCBBCL1);                                                   03470000
 OPEN FILE (RCBPROC);                                                   03480000
                                                                        03490000
 READ FILE (RCBPROC) INTO (RCBPROC_REC);  /* READ RCBPROC CARD */       03500000
                                                                        03510000
 IF SWITCH_EOF_RCBPROC                                                  03520000
 THEN                                                                   03530000
   DO;                                                                  03540000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               03550000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             03560000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0013';                           03570000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             03580000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBPROC';                        03590000
     CALL RCB0M1M (PTR_INT_AREA);                                       03600000
     CALL RCBBCLM_ERROR (NULL(), 'OTHER', '#001');                      03610000
   END;                                                                 03620000
                                                                        03630000
 PARM_INT_AREA.PROC_ID = RCBPROC_REC.PROC_ID;            /* PTM 519 */  03640000
                                                                        03650000
                                 /* CHECK HEADER RECORDS            */  03660000
 CALL RCBBCLM_CHECK_HEADER;                                             03670000
 CALL RCBBCLM_FILL_HEADER;                                              03680000
                                 /* READ RECORDS OF BOTH FILES      */  03690000
 CALL RCBBCLM_READ1;                                                    03700000
 CALL RCBBCLM_READ2;                                                    03710000
                                 /* SET ITERATION CONDITIONS        */  03720000
 CALL RCBBCLM_SIC;                                                      03730000
                                                                        03740000
 END RCBBCLM_INIT;                                                      03750000
1/********************************************************************/ 03760000
 /*                                                                  */ 03770000
 /* MODULE NAME      : RCBBCLM_INIT_COUNTRY                          */ 03780000
 /*                                                                  */ 03790000
 /* DESCRIPTION      : INITIAL ACTIONS FOR A COUNTRY                 */ 03800000
 /*                    RETRIEVE RCB024 PARAMETER FOR THE UPSTREAM    */ 03810000
 /*                    AND CEDS FILE AND CHECK TIME STAMPS           */ 03820000
 /*                                                                  */ 03830000
 /********************************************************************/ 03840000
0RCBBCLM_INIT_COUNTRY: PROC;                                            03850000
0COUNT.CNT_CTRY = 0;                  /* RESET COUNTRY COUNTERS    */   03860000
0PREV_SSK                     = SSK;                                    03870000
 PARM_INT_AREA.COUNTRY_NUMBER = SSK.CTRYNO;                             03880000
                                     /* RETRIEVE PARAMETER RCB024    */ 03890000
 TB_RCBV500                   = '';                                     03900000
 TB_RCBV500_I                 = '';                                     03910000
 TB_RCBP24S.NUMBER            = 'RCB024';                               03920000
 TB_RCBP24S.PROC_ID           =  RCBPROC_REC.PROC_ID;                   03930000
 TB_RCBP24S.CTRYNO            =  SSK.CTRYNO;                            03940000
 TB_RCBP24S.FILE_NAME         =  WRK_FILE_UPSTR;                        03950000
 TB_RCBP24S.SEQ_NUMBER        = '01';                                   03960000
                                                                        03970000
0CALL RCBI50M ('U',                                        /* RC01219 */03980000
               ADDR(TB_RCBV500),                                        03990000
               ADDR(TB_RCBV500_I),                                      04000000
               PTR_RET_AREA_BB,                                         04010000
               PTR_INT_AREA);                                           04020000
0SELECT(PARM_RET_AREA_BB.RETURN_CODE);                                  04030000
 WHEN (0)                                                               04040000
   DO;                                                                  04050000
     RCBP24S_UPSTR = TB_RCBP24S, BY NAME;                               04060000
   END;                                                                 04070000
 WHEN (4)                                                               04080000
   DO;                                                                  04090000
     PARM_INT_AREA.MESSAGE_TYPE      = 'IS';                            04100000
     PARM_INT_AREA.MESSAGE_NUMBER    = 'I050';                          04110000
     PARM_INT_AREA.MSG_VAR_CODES     = '';                              04120000
     PARM_INT_AREA.MSG_VAR_CODE_6    = 'PN';                            04130000
     PARM_INT_AREA.MSG_VAR_VALUE_6   = 'RCB024';                        04140000
     PARM_INT_AREA.MSG_VAR_CODE_7    = 'PK';                            04150000
     PARM_INT_AREA.MSG_VAR_VALUE_7   =  STRING (TB_RCBP24S.EXTRA_KEY);  04160000
     CALL RCB0M1M (PTR_INT_AREA);                                       04170000
     CALL RCBBCLM_ERROR (NULL(),                                        04180000
                        'OTHER',                                        04190000
                        '#002');                                        04200000
    END;                                                                04210000
  OTHERWISE                                                             04220000
    DO;                                                                 04230000
      CALL RCBBCLM_ERROR (ADDR (PARM_RET_AREA_BB.RETURN_SQL),           04240000
                          'DB2',                                        04250000
                          '#003');                                      04260000
    END;                                                                04270000
  END;                                                                  04280000
                                                                        04290000
 IF RCBP24S_UPSTR.TIME_STAMP ¬= WRK_TIME_STAMP_RCBBCA7                  04300000
 THEN                                                                   04310000
   DO;                                                                  04320000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             04330000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               04340000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0174';                           04350000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             04360000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_UPSTR;                   04370000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'TP';                             04380000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = WRK_TIME_STAMP_RCBBCA7;           04390000
     PARM_INT_AREA.MSG_VAR_CODE_8   = 'TP';                             04400000
     PARM_INT_AREA.MSG_VAR_VALUE_8  = RCBP24S_UPSTR.TIME_STAMP;         04410000
     CALL RCB0M1M (PTR_INT_AREA);                                       04420000
                                     /* ABEND                        */ 04430000
     CALL RCBBCLM_ERROR (NULL(),                                        04440000
                         'OTHER',                                       04450000
                         '#004');                                       04460000
   END;                                                                 04470000
                                                                        04480000
                                     /* RETRIEVE PARAMETER RCB024    */ 04490000
 TB_RCBV500                   = '';                                     04500000
 TB_RCBV500_I                 = '';                                     04510000
 TB_RCBP24S.NUMBER            = 'RCB024';                               04520000
 TB_RCBP24S.PROC_ID           = RCBPROC_REC.PROC_ID;                    04530000
 TB_RCBP24S.CTRYNO            = SSK.CTRYNO;                             04540000
 TB_RCBP24S.FILE_NAME         = WRK_FILE_CEDS;                          04550000
 TB_RCBP24S.SEQ_NUMBER        = '01';                                   04560000
                                                                        04570000
0CALL RCBI50M ('U',                                        /* RC01219 */04580000
               ADDR(TB_RCBV500),                                        04590000
               ADDR(TB_RCBV500_I),                                      04600000
               PTR_RET_AREA_BB,                                         04610000
               PTR_INT_AREA);                                           04620000
0SELECT(PARM_RET_AREA_BB.RETURN_CODE);                                  04630000
   WHEN (0)                                                             04640000
     DO;                                                                04650000
       RCBP24S_CEDS = TB_RCBP24S, BY NAME;                              04660000
     END;                                                               04670000
   WHEN (4)                                                             04680000
     DO;                                                                04690000
       PARM_INT_AREA.MESSAGE_TYPE      = 'IS';                          04700000
       PARM_INT_AREA.MESSAGE_NUMBER    = 'I050';                        04710000
       PARM_INT_AREA.MSG_VAR_CODES     = '';                            04720000
       PARM_INT_AREA.MSG_VAR_CODE_6    = 'PN';                          04730000
       PARM_INT_AREA.MSG_VAR_VALUE_6   = 'RCB024';                      04740000
       PARM_INT_AREA.MSG_VAR_CODE_7    = 'PK';                          04750000
       PARM_INT_AREA.MSG_VAR_VALUE_7   =  STRING (TB_RCBP24S.EXTRA_KEY);04760000
       CALL RCB0M1M (PTR_INT_AREA);                                     04770000
       CALL RCBBCLM_ERROR (NULL(),                                      04780000
                          'OTHER',                                      04790000
                          '#005');                                      04800000
     END;                                                               04810000
   OTHERWISE                                                            04820000
     DO;                                                                04830000
       CALL RCBBCLM_ERROR (ADDR (PARM_RET_AREA_BB.RETURN_SQL),          04840000
                           'DB2',                                       04850000
                           '#006');                                     04860000
     END;                                                               04870000
 END;                                                                   04880000
                                                                        04890000
 IF RCBP24S_CEDS.TIME_STAMP ¬= WRK_TIME_STAMP_RCBBC61                   04900000
 THEN                                                                   04910000
   DO;                                                                  04920000
    PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                              04930000
    PARM_INT_AREA.MSG_VAR_CODES    = '';                                04940000
    PARM_INT_AREA.MESSAGE_NUMBER   = '0174';                            04950000
    PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                              04960000
    PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_CEDS;                     04970000
    PARM_INT_AREA.MSG_VAR_CODE_7   = 'TP';                              04980000
    PARM_INT_AREA.MSG_VAR_VALUE_7  = WRK_TIME_STAMP_RCBBC61;            04990000
    PARM_INT_AREA.MSG_VAR_CODE_8   = 'TP';                              05000000
    PARM_INT_AREA.MSG_VAR_VALUE_8  = RCBP24S_CEDS.TIME_STAMP;           05010000
    CALL RCB0M1M (PTR_INT_AREA);                                        05020000
                                    /* ABEND                        */  05030000
    CALL RCBBCLM_ERROR (NULL(),                                         05040000
                        'OTHER',                                        05050000
                        '#007');                                        05060000
   END;                                                                 05070000
                      /* CHECK CORRECT RUN DATES IF COUNTRIES EQUAL */  05080000
                                                                        05090000
 IF (SUBSTR (STRING(SSK),1,6) = SUBSTR (STRING(SK1),1,6)  &             05100000
     SUBSTR (STRING(SSK),1,6) = SUBSTR (STRING(SK2),1,6))               05110000
 THEN                                                                   05120000
   DO;                                                                  05130000
     IF (RCBBCLS1_1.RUN_DATE ¬= RCBBCLS1_2.RUN_DATE)                    05140000
     THEN                                                               05150000
       DO;                                                              05160000
         PARM_INT_AREA.MSG_VAR_CODES    = '';                           05170000
         PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                         05180000
         PARM_INT_AREA.MESSAGE_NUMBER   = '0167';                       05190000
         PARM_INT_AREA.MSG_VAR_CODE_6   = 'D1';                         05200000
         PARM_INT_AREA.MSG_VAR_VALUE_6  = RCBBCLS1_1.RUN_DATE;          05210000
         PARM_INT_AREA.MSG_VAR_CODE_7   = 'D2';                         05220000
         PARM_INT_AREA.MSG_VAR_VALUE_7  = RCBBCLS1_2.RUN_DATE;          05230000
         CALL RCB0M1M (PTR_INT_AREA);                                   05240000
         CALL RCBBCLM_ERROR (NULL(),                                    05250000
                             'OTHER',                                   05260000
                             '#008');                                   05270000
       END;                                                             05280000
   END;                                                                 05290000
                                                                        05300000
0END RCBBCLM_INIT_COUNTRY;                                              05310000
1/********************************************************************/ 05320000
 /*                                                                  */ 05330000
 /* MODULE NAME      : RCBBCLM_INS                                   */ 05340000
 /*                                                                  */ 05350000
 /* DESCRIPTION      : PROCESS NEW RECORD                            */ 05360000
 /*                                                                  */ 05370000
 /********************************************************************/ 05380000
0RCBBCLM_INS: PROC;                                                     05390000
0IOAREA_OUT            = '';                                            05400000
 RCBBCLS2_3.REC_TYPE   = '02';                                          05410000
 RCBBCLS2_3.CTRYNO     = RCBBCLS1_1.CTRYNO;                             05420000
 RCBBCLS2_3.PGR_TYPE   = RCBBCLS1_1.PGR_TYPE;                           05430000
 RCBBCLS2_3.RUN_DATE   = RCBBCLS1_1.RUN_DATE;                           05440000
 RCBBCLS2_3.ACTION_IND = 'I';                                           05450000
 RCBBCLS2_3.RCB260S    = RCBBCLS1_1.RCB260S;                            05460000
 RCBBCLS2_3.RCB260SI   = RCBBCLS1_1.RCB260SI;                           05470000
                                     /* DEFAULT FIELDS               */ 05471000
 IF RCBBCLS2_3.ORDER_DATE             = ''                              05472000
 THEN DO;                                                               05473000
   RCBBCLS2_3.ORDER_DATE              = RCBBCLS2_3.RUN_DATE;            05474000
   END;                                                                 05475000
 IF RCBBCLS2_3.END_DATE               = ''                              05476000
 THEN DO;                                                               05477000
   RCBBCLS2_3.END_DATE                = '9999-12-31';                   05478000
   END;                                                                 05479000
 COUNT.CNT_CTRY.INSERTS = COUNT.CNT_CTRY.INSERTS + 1;                   05479100
 CALL RCBBCLM_WRITE;                                                    05479200
 END RCBBCLM_INS;                                                       05480000
1/********************************************************************/ 05490000
 /*                                                                  */ 05500000
 /* MODULE NAME      : RCBBCLM_DEL                                   */ 05510000
 /*                                                                  */ 05520000
 /* DESCRIPTION      : PROCESS OBSOLETE RECORD                       */ 05530000
 /*                                                                  */ 05540000
 /********************************************************************/ 05550000
0RCBBCLM_DEL: PROC;                                                     05560000
0IOAREA_OUT            = '';                                            05570000
 RCBBCLS2_3.REC_TYPE   = '02';                                          05580000
 RCBBCLS2_3.CTRYNO     = RCBBCLS1_2.CTRYNO;                             05590000
 RCBBCLS2_3.PGR_TYPE   = RCBBCLS1_2.PGR_TYPE;                           05600000
 RCBBCLS2_3.RUN_DATE   = RCBBCLS1_2.RUN_DATE;                           05610000
 RCBBCLS2_3.ACTION_IND = 'D';                                           05620000
 RCBBCLS2_3.RCB260S    = RCBBCLS1_2.RCB260S;                            05630000
 RCBBCLS2_3.RCB260SI   = RCBBCLS1_2.RCB260SI;                           05640000
                                     /* CLOSE ONLY NOT YET CLOSED    */ 05641000
 IF RCBBCLS2_3.END_DATE              >= RCBBCLS2_3.RUN_DATE             05642000
 THEN DO;                                                               05643000
   RCBBCLS2_3.END_DATE   = RCBBCLM_DATE(RCBBCLS2_3.RUN_DATE,-1);        05644000
   RCBBCLS2_3.INDNULL(22)= 0;                                           05645000
   COUNT.CNT_CTRY.DELETES = COUNT.CNT_CTRY.DELETES + 1;                 05646000
   CALL RCBBCLM_WRITE;                                                  05647000
 END;                                                                   05648000
 ELSE DO;                                                               05649000
   COUNT.CNT_CTRY.SKIPPED = COUNT.CNT_CTRY.SKIPPED + 1;                 05649100
 END;                                                                   05649200
 END RCBBCLM_DEL;                                                       05650000
1/********************************************************************/ 05660000
 /*                                                                  */ 05670000
 /* MODULE NAME      : RCBBCLM_UPD                                   */ 05680000
 /*                                                                  */ 05690000
 /* DESCRIPTION      : PROCESS CHANGED RECORD                        */ 05700000
 /*                                                                  */ 05710000
 /********************************************************************/ 05720000
0RCBBCLM_UPD: PROC;                                                     05730000
0IOAREA_OUT            = '';                                            05740000
 RCBBCLS2_3.REC_TYPE   = '02';                                          05750000
 RCBBCLS2_3.CTRYNO     = RCBBCLS1_1.CTRYNO;                             05760000
 RCBBCLS2_3.PGR_TYPE   = RCBBCLS1_1.PGR_TYPE;                           05770000
 RCBBCLS2_3.RUN_DATE   = RCBBCLS1_1.RUN_DATE;                           05780000
 RCBBCLS2_3.ACTION_IND = 'U';                                           05790000
 RCBBCLS2_3.RCB260S    = RCBBCLS1_1.RCB260S;                            05800000
 RCBBCLS2_3.RCB260SI   = RCBBCLS1_1.RCB260SI;                           05810000
 SWITCH_CHANGED        = FALSE;                                         05820000
                                     /* FILL WORK EFF_DATE           */ 05820505
 IF RCBBCLS2_3.ORDER_DATE             = ''                              05820605
 THEN DO;                                                               05820705
   WRK_EFF_DATE                       = RCBBCLS1_2.ORDER_DATE;          05820805
   END;                                                                 05820905
 ELSE DO;                                                               05821005
   WRK_EFF_DATE                       = RCBBCLS2_3.ORDER_DATE;          05821105
   END;                                                                 05821205
                                     /* FILL WORK END_DATE           */ 05821305
 IF RCBBCLS2_3.END_DATE               = ''                              05821405
 THEN DO;                                                               05821505
   WRK_END_DATE                       = RCBBCLS1_2.END_DATE;            05821605
   END;                                                                 05821705
 ELSE DO;                                                               05821805
   WRK_END_DATE                       = RCBBCLS2_3.END_DATE;            05821905
   END;                                                                 05822005
                                     /* COMPARE WITH RUNDATE         */ 05822105
 IF RCBBCLS2_3.ORDER_DATE             = '' &                            05822205
    WRK_EFF_DATE > RCBBCLS2_3.RUN_DATE                                  05822305
 THEN DO;                                                               05822405
   WRK_EFF_DATE = RCBBCLS2_3.RUN_DATE;                    /* PTM1380 */ 05822505
   END;                                                                 05822605
 IF RCBBCLS2_3.END_DATE               = '' &                            05822705
    WRK_END_DATE < RCBBCLS2_3.RUN_DATE                                  05822805
 THEN DO;                                                               05822905
   WRK_END_DATE                       = '9999-12-31';                   05823005
   END;                                                                 05823105
                                     /* COMPARE WRK DATES            */ 05823205
 IF RCBBCLS2_3.ORDER_DATE             = '' &                            05823305
    RCBBCLS2_3.END_DATE              ¬= '' &                            05823405
    WRK_EFF_DATE > WRK_END_DATE                                         05823505
 THEN DO;                                                               05823605
   WRK_EFF_DATE                       = WRK_END_DATE;                   05823705
   END;                                                                 05823805
 IF RCBBCLS2_3.END_DATE               = '' &                            05823905
    RCBBCLS1_1.ORDER_DATE            ¬= '' &                            05824005
    WRK_EFF_DATE > WRK_END_DATE                                         05824105
 THEN DO;                                                               05824205
   WRK_END_DATE                       = '9999-12-31';                   05824305
   END;                                                                 05824405
                                     /* SET ACTION RECORD DATES      */ 05824505
 RCBBCLS2_3.ORDER_DATE                = WRK_EFF_DATE;                   05824605
 RCBBCLS2_3.END_DATE                  = WRK_END_DATE;                   05824705
                                     /* COMPARE FIELDS               */ 05825805
 IF RCBBCLS2_3.PRODUCT_TYPE           ¬= RCBBCLS1_2.PRODUCT_TYPE        05825905
 THEN DO;                                                               05826005
   SWITCH_CHANGED                     = TRUE;                           05826205
   END;                                                                 05826305
 IF RCBBCLS2_3.MODEL_NUMBER           ¬= RCBBCLS1_2.MODEL_NUMBER        05826405
 THEN DO;                                                               05827000
   SWITCH_CHANGED                     = TRUE;                           05828000
   END;                                                                 05829000
 IF RCBBCLS2_3.INDNULL(4)             ¬= RCBBCLS1_2.INDNULL(4)          05829100
 THEN                                                                   05829200
     SWITCH_CHANGED                   = TRUE;                           05829400
 ELSE                                                                   05829500
   IF RCBBCLS2_3.INDNULL(4)           = 0                               05829600
   THEN                                                                 05829700
     IF RCBBCLS2_3.ORIGIN             ¬= RCBBCLS1_2.ORIGIN              05829800
     THEN                                                               05829900
       SWITCH_CHANGED                 = TRUE;                           05830000
 IF RCBBCLS2_3.INDNULL(5)             ¬= RCBBCLS1_2.INDNULL(5)          05830100
 THEN                                                                   05830200
     SWITCH_CHANGED                   = TRUE;                           05830400
 ELSE                                                                   05830500
   IF RCBBCLS2_3.INDNULL(5)           = 0                               05830600
   THEN                                                                 05830700
     IF RCBBCLS2_3.SEQUENCE_NUMBER    ¬= RCBBCLS1_2.SEQUENCE_NUMBER     05830800
     THEN                                                               05830900
       SWITCH_CHANGED                 = TRUE;                           05831100
 IF RCBBCLS2_3.CUSTOMER_USER          ¬= RCBBCLS1_2.CUSTOMER_USER       05831200
 THEN DO;                                                               05831300
   SWITCH_CHANGED                     = TRUE;                           05831400
   END;                                                                 05831500
 IF RCBBCLS2_3.INDNULL(7)             ¬= RCBBCLS1_2.INDNULL(7)          05831600
 THEN                                                                   05831700
     SWITCH_CHANGED                   = TRUE;                           05831800
 ELSE                                                                   05831900
   IF RCBBCLS2_3.INDNULL(7)           = 0                               05832000
   THEN                                                                 05832100
     IF RCBBCLS2_3.CUSTOMER_OWNER     ¬= RCBBCLS1_2.CUSTOMER_OWNER      05832200
     THEN                                                               05832300
       SWITCH_CHANGED                 = TRUE;                           05832400
 IF RCBBCLS2_3.INDNULL(8)             ¬= RCBBCLS1_2.INDNULL(8)          05832500
 THEN                                                                   05832600
     SWITCH_CHANGED                   = TRUE;                           05832700
 ELSE                                                                   05832800
   IF RCBBCLS2_3.INDNULL(8)           = 0                               05832900
   THEN                                                                 05833000
     IF RCBBCLS2_3.CUST_REQ_ARRIVDATE ¬= RCBBCLS1_2.CUST_REQ_ARRIVDATE  05833100
     THEN                                                               05833200
       SWITCH_CHANGED                 = TRUE;                           05833300
 IF RCBBCLS2_3.INDNULL(9)             ¬= RCBBCLS1_2.INDNULL(9)          05833400
 THEN                                                                   05833500
     SWITCH_CHANGED                   = TRUE;                           05833600
 ELSE                                                                   05833700
   IF RCBBCLS2_3.INDNULL(9)           = 0                               05833800
   THEN                                                                 05833900
     IF RCBBCLS2_3.DP_SYSTEM_NUMBER   ¬= RCBBCLS1_2.DP_SYSTEM_NUMBER    05834000
     THEN                                                               05834100
       SWITCH_CHANGED                 = TRUE;                           05834200
 IF RCBBCLS2_3.INDNULL(10)            ¬= RCBBCLS1_2.INDNULL(10)         05834300
 THEN                                                                   05834400
     SWITCH_CHANGED                   = TRUE;                           05834500
 ELSE                                                                   05834600
   IF RCBBCLS2_3.INDNULL(10)          = 0                               05834700
   THEN                                                                 05834800
     IF RCBBCLS2_3.MARKET_RESP_CODE   ¬= RCBBCLS1_2.MARKET_RESP_CODE    05834900
     THEN                                                               05835000
       SWITCH_CHANGED                 = TRUE;                           05835100
 IF RCBBCLS2_3.OU_CODE                ¬= RCBBCLS1_2.OU_CODE             05837300
 THEN DO;                                                               05837400
   SWITCH_CHANGED                     = TRUE;                           05837905
   RCBBCLS2_3.ACTION_IND              = 'V';                            05838005
   END;                                                                 05838105
                                                  /* SOC CEDS00000618 */05838215
 CALL RCBBCLM_RETRIEVE_RCBP13S;                                         05838412
 IF ( RCBBCLS2_3.ACTION_IND ='V' & RCBP13S.MAINT_SYSTEM_HW ¬= 'C')      05838612
 THEN                                                                   05838712
 DO;                                                                    05838812
  CALL RCBBCLM_RETRIEVE_40_OU;                                          05839012
 IF SWITCH_OU_NOT_FOUND THEN                                            05839112
  DO;                                                                   05839215
   RCBBCLS2_3.INDNULL(11) = 99;                                         05839315
   RCBBCLS2_3.INDNULL(12) = 99                                          05839415
   SWITCH_CHANGED         = FALSE;                                      05839515
 END;                                                                   05839612
                                                  /* EOC CEDS00000618 */05839715
 IF RCBBCLS2_3.INDNULL(13)            ¬= RCBBCLS1_2.INDNULL(13)         05839811
 THEN                                                                   05839911
     SWITCH_CHANGED                   = TRUE;                           05840011
 ELSE                                                                   05840111
   IF RCBBCLS2_3.INDNULL(13)          = 0                               05840211
   THEN                                                                 05840311
     IF RCBBCLS2_3.INSTALLING_OU      ¬= RCBBCLS1_2.INSTALLING_OU       05840411
     THEN                                                               05840511
       SWITCH_CHANGED                 = TRUE;                           05840611
 IF RCBBCLS2_3.INDNULL(14)            ¬= RCBBCLS1_2.INDNULL(14)         05840711
 THEN                                                                   05840811
     SWITCH_CHANGED                   = TRUE;                           05840911
 ELSE                                                                   05841011
   IF RCBBCLS2_3.INDNULL(14)          = 0                               05841111
   THEN                                                                 05841211
     IF RCBBCLS2_3.SELLING_OU         ¬= RCBBCLS1_2.SELLING_OU          05841311
     THEN                                                               05841411
       SWITCH_CHANGED                 = TRUE;                           05841511
 IF RCBBCLS2_3.INDNULL(15)            ¬= RCBBCLS1_2.INDNULL(15)         05841611
 THEN                                                                   05841711
     SWITCH_CHANGED                   = TRUE;                           05841811
 ELSE                                                                   05841911
   IF RCBBCLS2_3.INDNULL(15)          = 0                               05842011
   THEN                                                                 05842111
     IF RCBBCLS2_3.SCHED_COMPL_DATE   ¬= RCBBCLS1_2.SCHED_COMPL_DATE    05842211
     THEN                                                               05842311
       SWITCH_CHANGED                 = TRUE;                           05842411
 IF RCBBCLS2_3.INDNULL(16)            ¬= RCBBCLS1_2.INDNULL(16)         05842511
 THEN                                                                   05842611
     SWITCH_CHANGED                   = TRUE;                           05842711
 ELSE                                                                   05842811
   IF RCBBCLS2_3.INDNULL(16)          = 0                               05842911
   THEN                                                                 05843011
     IF RCBBCLS2_3.SCHED_REMOVAL_DATE ¬= RCBBCLS1_2.SCHED_REMOVAL_DATE  05843111
     THEN                                                               05843211
       SWITCH_CHANGED                 = TRUE;                           05843311
 IF RCBBCLS2_3.INDNULL(17)            ¬= RCBBCLS1_2.INDNULL(17)         05843411
 THEN                                                                   05843511
     SWITCH_CHANGED                   = TRUE;                           05843611
 ELSE                                                                   05843711
   IF RCBBCLS2_3.INDNULL(17)          = 0                               05843811
   THEN                                                                 05843911
     IF RCBBCLS2_3.TYPE_OF_MAINT      ¬= RCBBCLS1_2.TYPE_OF_MAINT       05844011
     THEN                                                               05844111
       SWITCH_CHANGED                 = TRUE;                           05844211
 IF RCBBCLS2_3.INDNULL(18)            ¬= RCBBCLS1_2.INDNULL(18)         05844311
 THEN                                                                   05844411
     SWITCH_CHANGED                   = TRUE;                           05844511
 ELSE                                                                   05844611
   IF RCBBCLS2_3.INDNULL(18)          = 0                               05844711
   THEN                                                                 05844811
     IF RCBBCLS2_3.TYPE_OF_WARRANTY   ¬= RCBBCLS1_2.TYPE_OF_WARRANTY    05844911
     THEN                                                               05845011
       SWITCH_CHANGED                 = TRUE;                           05845111
 IF RCBBCLS2_3.INDNULL(19)            ¬= RCBBCLS1_2.INDNULL(19)         05845211
 THEN                                                                   05845311
     SWITCH_CHANGED                   = TRUE;                           05845411
 ELSE                                                                   05845511
   IF RCBBCLS2_3.INDNULL(19)          = 0                               05845611
   THEN                                                                 05845711
     IF RCBBCLS2_3.TYPE_OF_AGREEMENT  ¬= RCBBCLS1_2.TYPE_OF_AGREEMENT   05845811
     THEN                                                               05845911
       SWITCH_CHANGED                 = TRUE;                           05846011
 IF RCBBCLS2_3.ORDER_DATE             ¬= RCBBCLS1_2.ORDER_DATE          05846111
 THEN DO;                                                               05846211
   SWITCH_CHANGED                     = TRUE;                           05846311
   END;                                                                 05846411
 IF RCBBCLS2_3.END_DATE               ¬= RCBBCLS1_2.END_DATE            05846511
 THEN DO;                                                               05846611
   SWITCH_CHANGED                     = TRUE;                           05846711
   END;                                                                 05846811
                                     /* UPDATE ONLY IF CHANGED       */ 05846911
 IF SWITCH_CHANGED                                                      05847011
 THEN DO;                                                               05847111
   COUNT.CNT_CTRY.UPDATES = COUNT.CNT_CTRY.UPDATES + 1;                 05847211
   CALL RCBBCLM_WRITE;                                                  05847311
   END;                                                                 05847411
 ELSE DO;                                                               05847511
   COUNT.CNT_CTRY.MATCHES = COUNT.CNT_CTRY.MATCHES + 1;                 05847611
   END;                                                                 05847711
 END RCBBCLM_UPD;                                                       05847811
1/********************************************************************/ 05847911
 /*                                                     CEDS00000618 */ 05848016
 /* MODULE NAME      : RCBBCLM_RETRIEVE_RCBP13S                      */ 05848111
 /*                                                                  */ 05848211
 /* DESCRIPTION      : RETRIEVE THE RCB013 PARAMETER                 */ 05848311
 /*                                                                  */ 05848411
 /********************************************************************/ 05848511
0RCBBCLM_RETRIEVE_RCBP13S: PROC;                                        05848611
0PARM_RET_AREA_BB     = '';                                             05848711
 TB_RCBV500           = '';                                             05848811
 TB_RCBV500_I         = '';                                             05848911
 TB_RCBP13S.NUMBER = 'RCB013';                                          05849011
 TB_RCBP13S.CTRYNO = RCBBCLS1_1.CTRYNO;                                 05849111
0CALL RCBI50M ('U',                                                     05849214
               RCBV500_PTR,                                             05849311
               RCBV500I_PTR,                                            05849411
               PTR_RET_AREA_BB,                                         05849511
               PTR_INT_AREA);                                           05849611
 SELECT(PARM_RET_AREA_BB.RETURN_CODE);                                  05849711
 WHEN (0)                                                               05849811
   DO;                                                                  05849911
     RCBP13S = TB_RCBP13S;                                              05850011
   END;                                                                 05850111
 WHEN (4)                                                               05850211
   DO;                                                                  05850311
     CALL RCBBCLM_ISSUE_NO_RCBP13S;                                     05850411
0    CALL RCBBCLM_ERROR (ADDR (PARM_RET_AREA_BB.RETURN_SQL),            05850511
                         'OTHER',                                       05850611
                         '#027');                                       05850711
   END;                                                                 05850811
 OTHERWISE                                                              05850911
   DO;                                                                  05851011
     CALL RCBBCLM_ERROR (ADDR (PARM_RET_AREA_BB.RETURN_SQL),            05851111
                         'DB2',                                         05851211
                         '#028');                                       05851311
   END;                                                                 05851411
   END;                                                                 05851511
0END RCBBCLM_RETRIEVE_RCBP13S;                                          05851616
1/********************************************************************/ 05851711
 /*                                                     CEDS00000618 */ 05851816
 /* MODULE NAME      : RCBBCLM_ISSUE_NO_RCBP13S                      */ 05851911
 /*                                                                  */ 05852011
 /* DESCRIPTION      : ISSUE MESSAGE NO RCB013 PARAMETER FOUND       */ 05852111
 /*                                                                  */ 05852211
 /********************************************************************/ 05852311
0RCBBCLM_ISSUE_NO_RCBP13S: PROC;                                        05852411
0PARM_INT_AREA.MESSAGE_TYPE      = 'IS';                                05852511
 PARM_INT_AREA.MESSAGE_NUMBER    = 'I050';                              05852611
 PARM_INT_AREA.MSG_VAR_CODES     = ' ';                                 05852711
 PARM_INT_AREA.MSG_VAR_CODE_6    = 'PN';                                05852811
 PARM_INT_AREA.MSG_VAR_VALUE_6   = RCBP13S.NUMBER;                      05852911
 PARM_INT_AREA.MSG_VAR_CODE_7    = 'PK';                                05853011
 PARM_INT_AREA.MSG_VAR_VALUE_7   = RCBP13S.CTRYNO;                      05853111
 CALL RCB0M1M (PTR_INT_AREA);                                           05853211
 END RCBBCLM_ISSUE_NO_RCBP13S;                                          05853316
1/********************************************************************/ 05853411
 /*                                                     CEDS00000618 */ 05853516
 /*                                                                  */ 05853611
 /* MODULE NAME      : RCBBCLM_RETRIEVE_40_OU                        */ 05853711
 /*                                                                  */ 05853811
 /* DESCRIPTION      : SEARCH ROW IN RCBV0040_OU USING               */ 05853911
 /*                    RCBIADM                                       */ 05854011
 /*                                                                  */ 05854111
 /********************************************************************/ 05854211
0RCBBCLM_RETRIEVE_40_OU: PROC;                                          05854311
                                                                        05854411
                                     /* COPY INPUT RECORD INFO       */ 05854511
 RCB040S.COUNTRY_NUMBER = RCBBCLS2_3.COUNTRY_NUMBER;                    05854611
 RCB040S.OU_CODE        = RCBBCLS2_3.OU_CODE;                           05854711
 RCB040S.EFFECTIVE_DATE = RCBBCLS2_3.ORDER_DATE;                        05854811
 SWITCH_OU_NOT_FOUND = FALSE;                                           05854912
                                     /* SEARCH OF TABLE ROW          */ 05855011
 CALL RCBIADM (RCB040S_PTR,                                             05855111
               RCB040SI_PTR,                                            05855211
               PTR_RET_AREA_BB,                                         05855311
               PTR_INT_AREA);                                           05855411
                                                                        05855511
 SELECT (PARM_RET_AREA_BB.RETURN_CODE);                                 05855611
 WHEN (0);                                                              05855711
 WHEN (4)                                                               05855811
   DO;                                                                  05855911
     SWITCH_OU_NOT_FOUND = TRUE;                                        05856012
     PARM_INT_AREA.MESSAGE_TYPE      = 'IS';                            05856111
     PARM_INT_AREA.MESSAGE_NUMBER    = '0192';                          05856211
     PARM_INT_AREA.MSG_VAR_CODES     = ' ';                             05856311
     PARM_INT_AREA.MSG_VAR_CODE_5    = 'HW';                            05856411
     PARM_INT_AREA.MSG_VAR_VALUE_5   = RCBBCLS2_3.PRODUCT_TYPE ||       05856511
                                       RCBBCLS2_3.ORIGIN ||             05856611
                                       RCBBCLS2_3.SEQUENCE_NUMBER;      05856711
     PARM_INT_AREA.MSG_VAR_CODE_6    = 'FN';                            05856811
     PARM_INT_AREA.MSG_VAR_VALUE_6   = 'OU_CODE';                       05856911
     PARM_INT_AREA.MSG_VAR_CODE_7    = 'OU';                            05857011
     PARM_INT_AREA.MSG_VAR_VALUE_7   =  RCBBCLS2_3.OU_CODE;             05857111
     CALL RCB0M1M (PTR_INT_AREA);                                       05857211
                                                                        05857311
     RCB040S.COUNTRY_NUMBER = RCBBCLS2_3.COUNTRY_NUMBER;                05857411
     IF RCB040S.COUNTRY_NUMBER = '758'                                  05857511
     THEN                                                               05857611
        RCB040S.OU_CODE        = '9001   ';                             05857711
     ELSE                                                               05857811
        RCB040S.OU_CODE        = '';                                    05857911
                                                                        05858011
     RCBBCLS2_3.OU_CODE           = RCB040S.OU_CODE;                    05858111
   END;                                                                 05858211
 OTHERWISE                                                              05858311
   DO;                                                                  05858411
     CALL RCBBCLM_ERROR(ADDR(PARM_RET_AREA_BB.RETURN_SQL),              05858511
                        'DB2','#026');                                  05858611
   END;                                                                 05858711
 END;                                                                   05858811
 END RCBBCLM_RETRIEVE_40_OU;                                            05858916
1/********************************************************************/ 05859011
 /*                                                                  */ 05859100
 /* MODULE NAME      : RCBBCLM_READ1                                 */ 05860000
 /*                                                                  */ 05870000
 /* DESCRIPTION      : READ UPSTREAM RECORD                          */ 05880000
 /*                                                                  */ 05890000
 /********************************************************************/ 05900000
0RCBBCLM_READ1: PROC;                                                   05910000
                                                                        05920000
0READ FILE (RCBBCA7) INTO (IOAREA_IN_1);                                05930000
0IF SK1.EOF = '0'                                                       05940000
 THEN DO;                                                               05950000
   SK1.REC_TYPE = RCBBCLS1_1.REC_TYPE;                                  05960000
0  IF RCBBCLS1_1.REC_TYPE = '02'                                        05970000
   THEN                                                                 05980000
     DO;                                                                05990000
       SK1.CTRYNO = RCBBCLS1_1.CTRYNO;                                  06000000
       SK1.ORDER_REF_NUMBER     = RCBBCLS1_1.ORDER_REF_NUMBER;          06001000
       SK1.COUNTRY_NUMBER       = RCBBCLS1_1.COUNTRY_NUMBER;            06002000
     END;                                                               06010000
   END;                                                                 06020000
 END RCBBCLM_READ1;                                                     06030000
1/********************************************************************/ 06040000
 /*                                                                  */ 06050000
 /* MODULE NAME      : RCBBCLM_CALC1                                 */ 06060000
 /*                                                                  */ 06070000
 /* DESCRIPTION      : CALC HASH TOTAL AND COUNTS FOR UPSTREAM FILE  */ 06080000
 /*                                                                  */ 06090000
 /********************************************************************/ 06100000
0RCBBCLM_CALC1: PROC;                                                   06110000
                                                                        06120000
 COUNT.CNT_CTRY.RCBBCA7   = COUNT.CNT_CTRY.RCBBCA7 + 1;                 06130000
 WRK_HASH_FIELD           =                                             06140000
 SUBSTR (RCBBCLS1_1.RCB260S.ORDER_REF_NUMBER, 1, 4);                    06150000
                                                                        06160000
 CALL RCB018M (WRK_HASH_FIELD,                                          06170000
               COUNT.HASH_RCBBCA7,                                      06180000
               PTR_INT_AREA);                                           06190000
                                                                        06200000
 END RCBBCLM_CALC1;                                                     06210000
1/********************************************************************/ 06220000
 /*                                                                  */ 06230000
 /* MODULE NAME      : RCBBCLM_READ2                                 */ 06240000
 /*                                                                  */ 06250000
 /* DESCRIPTION      : READ CEDS RECORD AND COUNT HASH TOTAL         */ 06260000
 /*                                                                  */ 06270000
 /********************************************************************/ 06280000
0RCBBCLM_READ2: PROC;                                                   06290000
0READ FILE (RCBBC61) INTO (IOAREA_IN_2);                                06300000
0IF SK2.EOF = '0'                                                       06310000
 THEN DO;                                                               06320000
   SK2.REC_TYPE = RCBBCLS1_2.REC_TYPE;                                  06330000
   IF RCBBCLS1_2.REC_TYPE = '02'                                        06340000
   THEN                                                                 06350000
     DO;                                                                06360000
       SK2.CTRYNO = RCBBCLS1_2.CTRYNO;                                  06370000
       SK2.ORDER_REF_NUMBER     = RCBBCLS1_2.ORDER_REF_NUMBER;          06371000
       SK2.COUNTRY_NUMBER       = RCBBCLS1_2.COUNTRY_NUMBER;            06372000
     END;                                                               06380000
   END;                                                                 06390000
 END RCBBCLM_READ2;                                                     06400000
1/********************************************************************/ 06410000
 /*                                                                  */ 06420000
 /* MODULE NAME      : RCBBCLM_CALC2                                 */ 06430000
 /*                                                                  */ 06440000
 /* DESCRIPTION      : CALC HASH TOTAL AND COUNTS FOR CEDS FILE      */ 06450000
 /*                                                                  */ 06460000
 /********************************************************************/ 06470000
0RCBBCLM_CALC2: PROC;                                                   06480000
                                                                        06490000
 COUNT.CNT_CTRY.RCBBC61   = COUNT.CNT_CTRY.RCBBC61 + 1;                 06500000
 WRK_HASH_FIELD           =                                             06510000
 SUBSTR (RCBBCLS1_2.RCB260S.ORDER_REF_NUMBER, 1, 4);                    06520000
                                                                        06530000
 CALL RCB018M (WRK_HASH_FIELD,                                          06540000
               COUNT.HASH_RCBBC61,                                      06550000
               PTR_INT_AREA);                                           06560000
                                                                        06570000
0END RCBBCLM_CALC2;                                                     06580000
1/********************************************************************/ 06590000
 /*                                                                  */ 06600000
 /* MODULE NAME      : RCBBCLM_WRITE                                 */ 06610000
 /*                                                                  */ 06620000
 /* DESCRIPTION      : WRITE ACTION RECORD AND COUNT HASH TOTAL      */ 06630000
 /*                                                                  */ 06640000
 /********************************************************************/ 06650000
0RCBBCLM_WRITE: PROC;                                                   06660000
0WRITE FILE (RCBBCL1) FROM (IOAREA_OUT);                                06670000
                                                                        06680000
 IF RCBBCLS2_3.REC_TYPE = '02'                   /* COUNT HASH */       06690000
 THEN                                                                   06700000
   DO;                                                                  06710000
     COUNT.CNT_CTRY.RCBBCL1 = COUNT.CNT_CTRY.RCBBCL1 + 1;               06720000
     WRK_HASH_FIELD =                                                   06730000
     SUBSTR (RCBBCLS2_3.RCB260S.ORDER_REF_NUMBER, 1, 4);                06740000
                                                                        06750000
     CALL RCB018M (WRK_HASH_FIELD,                                      06760000
                   COUNT.HASH_RCBBCL1,                                  06770000
                   PTR_INT_AREA);                                       06780000
   END;                                                                 06790000
 END RCBBCLM_WRITE;                                                     06800000
1/********************************************************************/ 06810000
 /*                                                                  */ 06820000
 /* MODULE NAME      : RCBBCLM_SIC                                   */ 06830000
 /*                                                                  */ 06840000
 /* DESCRIPTION      : SET ITERATION CONDITIONS                      */ 06850000
 /*                                                                  */ 06860000
 /********************************************************************/ 06870000
0RCBBCLM_SIC: PROC;                                                     06880000
0PREV_SSK = SSK;                                                        06890000
0IF STRING (SK1) < STRING (SK2)                                         06900000
 THEN                                                                   06910000
   DO;                                                                  06920000
     SSK = SK1;                                                         06930000
   END;                                                                 06940000
 ELSE                                                                   06950000
   DO;                                                                  06960000
     SSK = SK2;                                                         06970000
   END;                                                                 06980000
 PARM_INT_AREA.SEQUENCE_KEY = STRING(SSK);                /* RC01141 */ 06990000
0END RCBBCLM_SIC;                                                       07000000
1/********************************************************************/ 07010000
 /*                                                                  */ 07020000
 /* MODULE NAME      : RCBBCLM_CHECK_HEADER                          */ 07030000
 /*                                                                  */ 07040000
 /* DESCRIPTION      : CHECK THE HEADERS                             */ 07050000
 /*                    TIMESTAMPS OF BOTH FILE HEADERS ARE SAVED.    */ 07060000
 /*                    SOURCE INDICATOR OF THE UPSTREAM FILE HEADER  */ 07070000
 /*                    IS SAVED.                                     */ 07080000
 /*                                                                  */ 07090000
 /********************************************************************/ 07100000
0RCBBCLM_CHECK_HEADER: PROC;                                            07110000
                                                                        07120000
 CALL RCBBCLM_READ1;                 /* READ UPSTREAM HEADER         */ 07130000
 SELECT;                                                                07140000
                                     /* EMPTY FILE                   */ 07150000
   WHEN (SK1.EOF = '1') DO;                                             07160000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               07170000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             07180000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0013';                           07190000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             07200000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBCA7';                        07210000
     CALL RCB0M1M (PTR_INT_AREA);                                       07220000
                                     /* ABEND                        */ 07230000
     CALL RCBBCLM_ERROR (NULL(),                                        07240000
                         'OTHER',                                       07250000
                         '#009');                                       07260000
     END;                                                               07270000
                                     /* INVALID RECORD TYPE HEADER   */ 07280000
   WHEN (RCBBCLSH_1.REC_TYPE ¬= '01') DO;                               07290000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               07300000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             07310000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0018';                           07320000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             07330000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBCA7';                        07340000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'RT';                             07350000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = RCBBCLSH_1.REC_TYPE;              07360000
     CALL RCB0M1M (PTR_INT_AREA);                                       07370000
                                     /* ABEND                        */ 07380000
     CALL RCBBCLM_ERROR (NULL(),                                        07390000
                         'OTHER',                                       07400000
                         '#010');                                       07410000
     END;                                                               07420000
                                     /* INVALID FILE ID HEADER       */ 07430000
   WHEN (RCBBCLSH_1.FILE_ID ¬= 'RCBBCA7') DO;                           07440000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               07450000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             07460000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0014';                           07470000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             07480000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBCA7';                        07490000
     CALL RCB0M1M (PTR_INT_AREA);                                       07500000
                                     /* ABEND                        */ 07510000
     CALL RCBBCLM_ERROR (NULL(),                                        07520000
                         'OTHER',                                       07530000
                         '#011');                                       07540000
     END;                                                               07550000
   OTHERWISE;                                                           07560000
   END;                                                                 07570000
                                   /* SAVE TIMESTAMP OF UPSTREAM FILE */07580000
 WRK_TIME_STAMP_RCBBCA7 = RCBBCLSH_1.TIMESTAMP;                         07590000
                                   /* SAVE SOURCE_INDICATOR           */07600000
 WRK_SOURCE_INDICATOR   = RCBBCLSH_1.SOURCE_INDICATOR;                  07610000
                                                                        07620000
 CALL RCBBCLM_READ2;                 /* READ CEDS HEADER             */ 07630000
 SELECT;                                                                07640000
                                     /* EMPTY FILE                   */ 07650000
   WHEN (SK2.EOF = '1') DO;                                             07660000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               07670000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             07680000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0013';                           07690000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             07700000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBC61';                        07710000
     CALL RCB0M1M (PTR_INT_AREA);                                       07720000
                                     /* ABEND                        */ 07730000
     CALL RCBBCLM_ERROR (NULL(),                                        07740000
                         'OTHER',                                       07750000
                         '#012');                                       07760000
     END;                                                               07770000
                                     /* INVALID RECORD TYPE HEADER   */ 07780000
   WHEN (RCBBCLSH_2.REC_TYPE ¬= '01') DO;                               07790000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               07800000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             07810000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0018';                           07820000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             07830000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBC61';                        07840000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'RT';                             07850000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = RCBBCLSH_2.REC_TYPE;              07860000
     CALL RCB0M1M (PTR_INT_AREA);                                       07870000
                                     /* ABEND                        */ 07880000
     CALL RCBBCLM_ERROR (NULL(),                                        07890000
                         'OTHER',                                       07900000
                         '#013');                                       07910000
     END;                                                               07920000
                                     /* INVALID FILE ID HEADER       */ 07930000
   WHEN (RCBBCLSH_2.FILE_ID  ¬= 'RCBBC61' ) DO;                         07940000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               07950000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             07960000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0014';                           07970000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             07980000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBC61';                        07990000
     CALL RCB0M1M (PTR_INT_AREA);                                       08000000
                                     /* ABEND                        */ 08010000
     CALL RCBBCLM_ERROR (NULL(),                                        08020000
                         'OTHER',                                       08030000
                         '#014');                                       08040000
     END;                                                               08050000
   OTHERWISE;                                                           08060000
   END;                                                                 08070000
                                     /* SAVE TIMESTAMP OF CEDS FILE */  08080000
 WRK_TIME_STAMP_RCBBC61 = RCBBCLSH_2.TIMESTAMP;                         08090000
                                                                        08100000
 END RCBBCLM_CHECK_HEADER;                                              08110000
1/********************************************************************/ 08120000
 /*                                                                  */ 08130000
 /* MODULE NAME      : RCBBCLM_CHECK_HASH                            */ 08140000
 /*                                                                  */ 08150000
 /* DESCRIPTION      : CHECK THAT THE HASH TOTALS FROM PARAMETER     */ 08160000
 /*                    RCB024 MATCH WITH THE CALCULATED HASH TOTALS  */ 08170000
 /*                    FROM THE UPSTREAM AND THE CEDS FILES          */ 08180000
 /*                                                                  */ 08190000
 /********************************************************************/ 08200000
0RCBBCLM_CHECK_HASH: PROC;                                              08210000
 IF COUNT.HASH_RCBBCA7 ¬= RCBP24S_UPSTR.HASH_TOTAL                      08220000
 THEN                                                                   08230000
   DO;                                                                  08240000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             08250000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0175';                           08260000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               08270000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             08280000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_UPSTR;                   08290000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'HT';                             08300000
     CNT_PIC15                      = COUNT.HASH_RCBBCA7;               08310000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;                        08320000
     PARM_INT_AREA.MSG_VAR_CODE_8   = 'HT';                             08330000
     CNT_PIC15                      = RCBP24S_UPSTR.HASH_TOTAL;         08340000
     PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC15;                        08350000
     CALL RCB0M1M (PTR_INT_AREA);                                       08360000
     CALL RCBBCLM_ERROR (NULL(),                                        08370000
                         'OTHER',                                       08380000
                         '#015');                                       08390000
   END;                                                                 08400000
                                                                        08410000
 IF COUNT.HASH_RCBBC61 ¬= RCBP24S_CEDS.HASH_TOTAL                       08420000
 THEN                                                                   08430000
   DO;                                                                  08440000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             08450000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0175';                           08460000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               08470000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             08480000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_CEDS;                    08490000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'HT';                             08500000
     CNT_PIC15                      = COUNT.HASH_RCBBC61;               08510000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;                        08520000
     PARM_INT_AREA.MSG_VAR_CODE_8   = 'HT';                             08530000
     CNT_PIC15                      = RCBP24S_CEDS.HASH_TOTAL;          08540000
     PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC15;                        08550000
     CALL RCB0M1M (PTR_INT_AREA);                                       08560000
     CALL RCBBCLM_ERROR (NULL(),                                        08570000
                         'OTHER',                                       08580000
                         '#016');                                       08590000
   END;                                                                 08600000
0END RCBBCLM_CHECK_HASH;                                                08610000
1/********************************************************************/ 08620000
 /*                                                                  */ 08630000
 /* MODULE NAME      : RCBBCLM_CHECK_TRAILERS                        */ 08640000
 /*                                                                  */ 08650000
 /* DESCRIPTION      : CHECK THE TRAILERS                            */ 08660000
 /*                                                                  */ 08670000
 /********************************************************************/ 08680000
0RCBBCLM_CHECK_TRAILERS: PROC;                                          08690000
                                                                        08700000
 IF SK1.EOF = '1'                                                       08710000
 THEN DO;                            /* NO TRAILER RECORD            */ 08720000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 08730000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               08740000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0017';                             08750000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               08760000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'UPSTREAM FILE RCBBCA7';            08770000
   CALL RCB0M1M (PTR_INT_AREA);                                         08780000
   CALL RCBBCLM_ERROR (NULL(),                                          08790000
                      'OTHER',                                          08800000
                      '#017');                                          08810000
   END;                                                                 08820000
                                                                        08830000
 IF RCBBCLST_1.CNT_RECS ¬= COUNT.CNT_TOT.RCBBCA7                        08840000
 THEN DO;                          /* INVALID COUNT TRAILER        */   08850000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 08860000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               08870000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0007';                             08880000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               08890000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'UPSTREAM FILE RCBBCA7';            08900000
   PARM_INT_AREA.MSG_VAR_CODE_7   = 'C7';                               08910000
   PARM_INT_AREA.MSG_VAR_VALUE_7  = COUNT.CNT_TOT.RCBBCA7;              08920000
   PARM_INT_AREA.MSG_VAR_CODE_8   = 'C8';                               08930000
   PARM_INT_AREA.MSG_VAR_VALUE_8  = RCBBCLST_1.CNT_RECS;                08940000
   CALL RCB0M1M (PTR_INT_AREA);                                         08950000
   CALL RCBBCLM_ERROR (NULL(),                                          08960000
                      'OTHER',                                          08970000
                      '#018');                                          08980000
   END;                                                                 08990000
                                                                        09000000
 CALL RCBBCLM_READ1;                 /* CHECK RECORDS AFTER TRAILER  */ 09010000
 IF SK1.EOF = '0'                                                       09020000
 THEN DO;                          /* RECORDS AFTER TRAILER        */   09030000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 09040000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               09050000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0015';                             09060000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               09070000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'UPSTREAM FILE RCBBCA7';            09080000
   CALL RCB0M1M (PTR_INT_AREA);                                         09090000
   CALL RCBBCLM_ERROR (NULL(),                                          09100000
                      'OTHER',                                          09110000
                      '#019');                                          09120000
   END;                                                                 09130000
                                                                        09140000
 IF SK2.EOF = '1'                                                       09150000
 THEN DO;                            /* NO TRAILER RECORD            */ 09160000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 09170000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               09180000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0017';                             09190000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               09200000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'CEDS FILE RCBBC61';                09210000
   CALL RCB0M1M (PTR_INT_AREA);                                         09220000
   CALL RCBBCLM_ERROR (NULL(),                                          09230000
                      'OTHER',                                          09240000
                      '#020');                                          09250000
   END;                                                                 09260000
                                                                        09270000
 IF RCBBCLST_2.CNT_RECS ¬= COUNT.CNT_TOT.RCBBC61                        09280000
 THEN DO;                          /* INVALID COUNT TRAILER        */   09290000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 09300000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               09310000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0007';                             09320000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               09330000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'CEDS FILE RCBBC61';                09340000
   PARM_INT_AREA.MSG_VAR_CODE_7   = 'C7';                               09350000
   PARM_INT_AREA.MSG_VAR_VALUE_7  = COUNT.CNT_CTRY.RCBBC61;             09360000
   PARM_INT_AREA.MSG_VAR_CODE_8   = 'C8';                               09370000
   PARM_INT_AREA.MSG_VAR_VALUE_8  = RCBBCLST_2.CNT_RECS;                09380000
   CALL RCB0M1M (PTR_INT_AREA);                                         09390000
   CALL RCBBCLM_ERROR (NULL(),                                          09400000
                      'OTHER',                                          09410000
                      '#021');                                          09420000
   END;                                                                 09430000
                                                                        09440000
 CALL RCBBCLM_READ2;                 /* CHECK RECORDS AFTER TRAILER  */ 09450000
 IF SK2.EOF = '0'                                                       09460000
 THEN DO;                          /* RECORDS AFTER TRAILER        */   09470000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 09480000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               09490000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0015';                             09500000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               09510000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'CEDS FILE RCBBC61';                09520000
   CALL RCB0M1M (PTR_INT_AREA);                                         09530000
   CALL RCBBCLM_ERROR (NULL(),                                          09540000
                      'OTHER',                                          09550000
                      '#022');                                          09560000
   END;                                                                 09570000
                                                                        09580000
 END RCBBCLM_CHECK_TRAILERS;                                            09590000
1/********************************************************************/ 09600000
 /*                                                                  */ 09610000
 /* MODULE NAME      : RCBBCLM_FILL_HEADER                           */ 09620000
 /*                                                                  */ 09630000
 /* DESCRIPTION      : FILL THE HEADER OF THE ACTION FILE            */ 09640000
 /*                                                                  */ 09650000
 /********************************************************************/ 09660000
0RCBBCLM_FILL_HEADER: PROC;                                             09670000
0IOAREA_OUT                   = '';                                     09680000
 RCBBCLSH_3.REC_TYPE          = '01';                                   09690000
 RCBBCLSH_3.FILE_ID           = 'RCBBCL1';                              09700000
 RCBBCLSH_3.SOURCE_INDICATOR  = WRK_SOURCE_INDICATOR;                   09710000
 RCBBCLSH_3.TIMESTAMP         = WRK_DATE_TIME;                          09720000
 CALL RCBBCLM_WRITE;                                                    09730000
 END RCBBCLM_FILL_HEADER;                                               09740000
1/********************************************************************/ 09750000
 /*                                                                  */ 09760000
 /* MODULE NAME      : RCBBCLM_FILL_TRAILERS                         */ 09770000
 /*                                                                  */ 09780000
 /* DESCRIPTION      : FILL THE TRAILER                              */ 09790000
 /*                                                                  */ 09800000
 /********************************************************************/ 09810000
0RCBBCLM_FILL_TRAILERS: PROC;                                           09820000
0IOAREA_OUT          = '';                                              09830000
 RCBBCLST_3.REC_TYPE = '99';                                            09840000
 RCBBCLST_3.CNT_RECS = COUNT.CNT_TOT.RCBBCL1;                           09850000
 CALL RCBBCLM_WRITE;                                                    09860000
 END RCBBCLM_FILL_TRAILERS;                                             09870000
1/********************************************************************/ 09880000
 /*                                                                  */ 09890000
 /* MODULE NAME      : RCBBCLM_SAVE_HASH                             */ 09900000
 /*                                                                  */ 09910000
 /* DESCRIPTION      : SAVE HASH TOTAL INFORMATION ON PARAMETER.     */ 09920000
 /*                    IF THE PARAMETER DOES NOT YET EXIST, IT WILL  */ 09930000
 /*                    BE INSERTED.                                  */ 09940000
 /*                                                                  */ 09950000
 /*                    ISSUE MESSAGE 0173                            */ 09960000
 /*                                                                  */ 09970000
 /********************************************************************/ 09980000
0 RCBBCLM_SAVE_HASH : PROC;                                             09990000
                                     /* INIT TABLESTRUCTURE          */ 10000000
 TB_RCBV500                  = '';                                      10010000
 TB_RCBV500_I                = '';                                      10020000
 TB_RCBP24S.NUMBER           = 'RCB024';                                10030000
 TB_RCBP24S.PROC_ID          = RCBPROC_REC.PROC_ID;                     10040000
 TB_RCBP24S.CTRYNO           = PREV_SSK.CTRYNO;                         10050000
 TB_RCBP24S.FILE_NAME        = WRK_FILE_ACT;                            10060000
 TB_RCBP24S.SEQ_NUMBER       = '01';                                    10070000
 TB_RCBP24S.TIME_STAMP       = WRK_DATE_TIME;                           10080000
 TB_RCBP24S.HASH_TOTAL       = COUNT.HASH_RCBBCL1;                      10090000
 TB_RCBP24S.LENGTH_PARM      = WRK_LENGTH_RCB024;                       10100000
                                                                        10110000
0CALL RCBG50M (ADDR(TB_RCBV500),    /* UPDATE PARAMETER RCB024    */    10120000
               ADDR(TB_RCBV500_I),                                      10130000
               PTR_RET_AREA_BB,                                         10140000
               PTR_INT_AREA);                                           10150000
0SELECT(PARM_RET_AREA_BB.RETURN_CODE);                                  10160000
   WHEN (0);                                                            10170000
   WHEN (4)                          /* WHEN NOT FOUND THEN INSERT  */  10180000
     DO;                                                                10190000
       CALL RCBF50M (ADDR(TB_RCBV500),                                  10200000
                     ADDR(TB_RCBV500_I),                                10210000
                     PTR_RET_AREA_BB,                                   10220000
                     PTR_INT_AREA);                                     10230000
       SELECT(PARM_RET_AREA_BB.RETURN_CODE);                            10240000
         WHEN (0);                                                      10250000
         OTHERWISE                                                      10260000
           DO;                                                          10270000
             CALL RCBBCLM_ERROR (ADDR (PARM_RET_AREA_BB.RETURN_SQL),    10280000
                                 'DB2',                                 10290000
                                 '#023');                               10300000
           END;                                                         10310000
       END;                                                             10320000
     END;                                                               10330000
   OTHERWISE                                                            10340000
      DO;                                                               10350000
        CALL RCBBCLM_ERROR (ADDR (PARM_RET_AREA_BB.RETURN_SQL),         10360000
                            'DB2',                                      10370000
                            '#024');                                    10380000
      END;                                                              10390000
 END;                                                                   10400000
                                                                        10410000
 PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 10420000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0173';                               10430000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   10440000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 10450000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_ACT;                         10460000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'TP';                                 10470000
 PARM_INT_AREA.MSG_VAR_VALUE_7  = WRK_DATE_TIME;                        10480000
 PARM_INT_AREA.MSG_VAR_CODE_8   = 'HT';                                 10490000
 CNT_PIC15                      = COUNT.HASH_RCBBCL1;                   10500000
 PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC15;                            10510000
 CALL RCB0M1M (PTR_INT_AREA);                                           10520000
                                                                        10530000
0END RCBBCLM_SAVE_HASH;                                                 10540000
1/********************************************************************/ 10550000
 /*                                                                  */ 10560000
 /* MODULE NAME      : RCBBCLM_END_COUNTRY                           */ 10570000
 /*                                                                  */ 10580000
 /* DESCRIPTION      : ENDING ACTIONS FOR A COUNTRY                  */ 10590000
 /*                                                                  */ 10600000
 /********************************************************************/ 10610000
0RCBBCLM_END_COUNTRY: PROC;                                             10620000
                                      /* ADD COUNTRY COUNTS TO TOTAL */ 10630000
                                                                        10640000
 COUNT.CNT_TOT.RCBBCA7   =  COUNT.CNT_TOT.RCBBCA7                       10650000
                              + COUNT.CNT_CTRY.RCBBCA7;                 10660000
 COUNT.CNT_TOT.RCBBC61   =  COUNT.CNT_TOT.RCBBC61                       10670000
                              + COUNT.CNT_CTRY.RCBBC61;                 10680000
 COUNT.CNT_TOT.RCBBCL1   =  COUNT.CNT_TOT.RCBBCL1                       10690000
                              + COUNT.CNT_CTRY.RCBBCL1;                 10700000
 COUNT.CNT_TOT.INSERTS   =  COUNT.CNT_TOT.INSERTS                       10710000
                              + COUNT.CNT_CTRY.INSERTS;                 10720000
 COUNT.CNT_TOT.UPDATES   =  COUNT.CNT_TOT.UPDATES                       10730000
                              + COUNT.CNT_CTRY.UPDATES;                 10740000
 COUNT.CNT_TOT.DELETES   =  COUNT.CNT_TOT.DELETES                       10750000
                              + COUNT.CNT_CTRY.DELETES;                 10760000
 COUNT.CNT_TOT.MATCHES   =  COUNT.CNT_TOT.MATCHES                       10770000
                              + COUNT.CNT_CTRY.MATCHES;                 10780000
 COUNT.CNT_TOT.SKIPPED   =  COUNT.CNT_TOT.SKIPPED                       10790000
                              + COUNT.CNT_CTRY.SKIPPED;                 10800000
                                                                        10810000
 PARM_INT_AREA.MESSAGE_TYPE     = 'IS';      /* ISSUE COUNT MESSAGES */ 10820000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0003';                               10830000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   10840000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 10850000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBCA7';                            10860000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C1';                                 10870000
 CNT_PIC9                       = COUNT.CNT_CTRY.RCBBCA7;               10880000
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                             10890000
 CALL RCB0M1M (PTR_INT_AREA);                                           10900000
                                                                        10910000
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 10920000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0003';                               10930000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   10940000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 10950000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBC61';                            10960000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C1';                                 10970000
 CNT_PIC9                       = COUNT.CNT_CTRY.RCBBC61;               10980000
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                             10990000
 CALL RCB0M1M (PTR_INT_AREA);                                           11000000
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 11010000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0004';                               11020000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   11030000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 11040000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBCL1';                            11050000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C6';                                 11060000
 CNT_PIC9                       = COUNT.CNT_CTRY.RCBBCL1;               11070000
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                             11080000
 CALL RCB0M1M (PTR_INT_AREA);                                           11090000
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 11100000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0158';                               11110000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   11120000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'IN';                                 11130000
 CNT_PIC9                       = COUNT.CNT_CTRY.INSERTS;               11140000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = CNT_PIC9;                             11150000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'UP';                                 11160000
 CNT_PIC9                       = COUNT.CNT_CTRY.UPDATES;               11170000
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                             11180000
 PARM_INT_AREA.MSG_VAR_CODE_8   = 'DL';                                 11190000
 CNT_PIC9                       = COUNT.CNT_CTRY.DELETES;               11200000
 PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC9;                             11210000
 PARM_INT_AREA.MSG_VAR_CODE_9   = 'EQ';                                 11220000
 CNT_PIC9                       = COUNT.CNT_CTRY.MATCHES;               11230000
 PARM_INT_AREA.MSG_VAR_VALUE_9  = CNT_PIC9;                             11240000
 PARM_INT_AREA.MSG_VAR_CODE_10  = 'SD';                                 11250000
 CNT_PIC9                       = COUNT.CNT_CTRY.SKIPPED;               11260000
 PARM_INT_AREA.MSG_VAR_VALUE_10 = CNT_PIC9;                             11270000
 CALL RCB0M1M (PTR_INT_AREA);                                           11280000
                                                                        11290000
 CALL RCBBCLM_CHECK_HASH;  /* CHECK HASH OF UPSTREAM AND CEDS FILE */   11300000
 CALL RCBBCLM_SAVE_HASH;   /* SAVE  HASH OF ACTION FILE IN RCB024  */   11310000
                                                                        11320000
0END RCBBCLM_END_COUNTRY;                                               11330000
1/********************************************************************/ 11800000
 /*                                                                  */ 11810000
 /* MODULE NAME      : RCBBCLM_TERM                                  */ 11820000
 /*                                                                  */ 11830000
 /* DESCRIPTION      : TERMINATE PROGRAM                             */ 11840000
 /*                                                                  */ 11850000
 /********************************************************************/ 11860000
0RCBBCLM_TERM: PROC;                                                    11870000
0PARM_INT_AREA.COUNTRY_NUMBER   = '';                                   11880000
                                                                        11890000
0CALL RCBBCLM_CHECK_TRAILERS;                                           11900000
 CALL RCBBCLM_FILL_TRAILERS;                                            11910000
                                                                        11920000
 PARM_INT_AREA.MESSAGE_TYPE     = 'IS';      /* ISSUE COUNT MESSAGES */ 11930000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0003';                               11940000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   11950000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 11960000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBCA7';                            11970000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C1';                                 11980000
 CNT_PIC9                       = COUNT.CNT_TOT.RCBBCA7;                11990000
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                             12000000
 CALL RCB0M1M (PTR_INT_AREA);                                           12010000
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 12020000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0003';                               12030000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   12040000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 12050000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBC61';                            12060000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C1';                                 12070000
 CNT_PIC9                       = COUNT.CNT_TOT.RCBBC61;                12080000
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                             12090000
 CALL RCB0M1M (PTR_INT_AREA);                                           12100000
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 12110000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0004';                               12120000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   12130000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 12140000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBCL1';                            12150000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C6';                                 12160000
 CNT_PIC9                       = COUNT.CNT_TOT.RCBBCL1;                12170000
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                             12180000
 CALL RCB0M1M (PTR_INT_AREA);                                           12190000
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 12200000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0158';                               12210000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   12220000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'IN';                                 12230000
 CNT_PIC9                       = COUNT.CNT_TOT.INSERTS;                12240000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = CNT_PIC9;                             12250000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'UP';                                 12260000
 CNT_PIC9                       = COUNT.CNT_TOT.UPDATES;                12270000
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                             12280000
 PARM_INT_AREA.MSG_VAR_CODE_8   = 'DL';                                 12290000
 CNT_PIC9                       = COUNT.CNT_TOT.DELETES;                12300000
 PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC9;                             12310000
 PARM_INT_AREA.MSG_VAR_CODE_9   = 'EQ';                                 12320000
 CNT_PIC9                       = COUNT.CNT_TOT.MATCHES;                12330000
 PARM_INT_AREA.MSG_VAR_VALUE_9  = CNT_PIC9;                             12340000
 PARM_INT_AREA.MSG_VAR_CODE_10  = 'SD';                                 12350000
 CNT_PIC9                       = COUNT.CNT_TOT.SKIPPED;                12360000
 PARM_INT_AREA.MSG_VAR_VALUE_10 = CNT_PIC9;                             12370000
 CALL RCB0M1M (PTR_INT_AREA);                                           12380000
                                     /* CLOSE ALL FILES              */ 12390000
 CLOSE FILE (RCBBCA7);                                                  12400000
 CLOSE FILE (RCBBC61);                                                  12410000
 CLOSE FILE (RCBBCL1);                                                  12420000
 CLOSE FILE (RCBPROC);                                                  12430000
                                     /* ISSUE END MESSAGE            */ 12440000
 PARM_INT_AREA.MSG_AREA.MESSAGE_TYPE     = 'IS';                        12450000
 PARM_INT_AREA.MSG_AREA.MESSAGE_NUMBER   = '9999';                      12460000
 PARM_INT_AREA.MSG_AREA.MSG_VAR_CODES    = ' ';                         12470000
 CALL RCB0M1M (PTR_INT_AREA);                                           12480000
                                     /* CLOSE MESSAGE FILE           */ 12490000
 PARM_INT_AREA.MSG_REQUEST    = 'C';                                    12500000
 CALL RCB0M1M (PTR_INT_AREA);                                           12510000
 END RCBBCLM_TERM;                                                      12520000
1/********************************************************************/ 12530000
 /*                                                                  */ 12540000
 /* MODULE NAME      : RCBBCLM_DATE                                  */ 12550000
 /*                                                                  */ 12560000
 /* DESCRIPTION      : CALCULATE DATES                               */ 12570000
 /*                                                                  */ 12580000
 /********************************************************************/ 12590000
0RCBBCLM_DATE: PROC(DATE1, NUMBER) RETURNS(CHAR(10));                   12600000
0DCL DATE1        CHAR(10);                                             12610000
 DCL NUMBER       FIXED DEC(15);                                        12620000
0RCBZ03S.WD_PERIOD  = NUMBER;                                           12630000
 RCBZ03S.WD_IN_DATE = DATE1;                                            12640000
 CALL RCB004M (ADDR (RCBZ03S));                                         12650000
 SELECT (RCBZ03S.WD_STATUS);                                            12660000
 WHEN ('')                                                              12670000
   DO;                                                                  12680000
     RETURN (SUBSTR (RCBZ03S.WD_OUT_DATE,1,10));                        12690000
   END;                                                                 12700000
 OTHERWISE                                                              12710000
   DO;                                                                  12720000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             12730000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0007';                           12740000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               12750000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'RC';                             12760000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = RCBZ03S.WD_STATUS;                12770000
     CALL RCB0M1M (PTR_INT_AREA);                                       12780000
                                     /* ABEND                        */ 12790000
     CALL RCBBCLM_ERROR (NULL(),                                        12800000
                         'OTHER',                                       12810000
                         '#025');                                       12820000
   END;                                                                 12830000
 END;                                                                   12840000
 END RCBBCLM_DATE;                                                      12850000
1/********************************************************************/ 12860000
 /*                                                                  */ 12870000
 /* MODULE NAME      : RCBBCLM_ERROR                                 */ 12880000
 /*                                                                  */ 12890000
 /* DESCRIPTION      : CALLS THE COMMON ERROR ROUTINE AFTER FILLING  */ 12900000
 /*                    THE INPUT VARIABLES                           */ 12910000
 /*                                                                  */ 12920000
 /********************************************************************/ 12930000
0 RCBBCLM_ERROR: PROC (PTR_ERROR,                                       12940000
                       ERR_TYPE,                                        12950000
                       CALL_ID);                                        12960000
0DCL PTR_ERROR    PTR;                                                  12970000
 DCL ERR_TYPE     CHAR(8);                                              12980000
 DCL CALL_ID      CHAR(4);                                              12990000
0PARM_INT_AREA.PTR_ERROR         = PTR_ERROR;                           13000000
 PARM_INT_AREA.ERR_TYPE          = ERR_TYPE;                            13010000
 PARM_INT_AREA.CALL_ID           = CALL_ID;                             13020000
0CALL RCB0E1M (PTR_INT_AREA);                                           13030000
0END RCBBCLM_ERROR;                                                     13040000
1/********************************************************************/ 13050000
 /* DO NOT CHANGE THIS PART, IT IS MEANT FOR ABR                     */ 13060000
 /********************************************************************/ 13070000
0%INCLUDE DAIFPLH ;                    /* COMPILE DATE/TIME STAMP    */ 13080000
 $DAIMOD (RCBBCLM);                    /* MODULE TO BE COMPILED      */ 13090000
0/********************************************************************/ 13100000
 /* END OF ABR BLOCK                                                 */ 13110000
 /********************************************************************/ 13120000
 END RCBBCLM;                                                           13130000