 /* RCBBJBM - COMPARE FOR RCBV0470_SERV_COND                         */ 00010000
 /*                                                                  */ 00020000
 /* 5695-153 (C) COPYRIGHT IBM EMEA WORLD TRADE CORPORATION 1991     */ 00030000
 /* LICENSED MATERIAL - PROGRAM PROPERTY OF IBM                      */ 00040000
 /* REFER TO COPYRIGHT INSTRUCTIONS: FORM G120-2083                  */ 00050000
 /*                                                                  */ 00060000
 /********************************************************************/ 00070000
 /* PROGRAM          : RCBBJBP                                       */ 00080000
 /*                                                                  */ 00090000
 /* LANGUAGE         : PLI                                           */ 00100000
 /*                                                                  */ 00110000
 /* DATE GENERATED   : 3 OCT 1997 - 15:31:37                         */ 00120000
 /*                                                                  */ 00130000
 /* GENERATED BY     : RCBB0PZ0 - GENERATE COMPARE PROGRAM           */ 00140000
 /*                    !!!!! MANUALLY UPDATED BECAUSE NO   !!!!!     */ 00150000
 /*                    !!!!! NO COUNTRIES PRESENT IN T470  !!!!!     */ 00160000
 /*                                                                  */ 00170000
 /* TYPE             : BATCH                                         */ 00180000
 /*                                                                  */ 00190000
 /* DESCRIPTION      : COMPARE FOR RCBV0470_SERV_COND                */ 00200000
 /*                    THIS PROGRAM COMPARES TWO INPUT FILES,        */ 00210000
 /*                    DIFFERENCES WILL RESULT IN RECORDS            */ 00220000
 /*                    ON THE ACTIONS FILE.                          */ 00230000
 /*                    THE COMPARE PROCESS IS OF TYPE 1,             */ 00240000
 /*                    NO DATES INVOLVED IN COMPARE PROCESS.         */ 00250000
 /*                                                                  */ 00260000
 /* INPUT            : - FILES : UPSTREAM RCBBJA0                    */ 00270000
 /*                              CEDS     RCBBJ11                    */ 00280000
 /*                                                                  */ 00290000
 /* OUTPUT           : - FILES : ACTIONS  RCBBJC0                    */ 00300000
 /*                              MESSAGE  RCB0M1F0                   */ 00310000
 /*                                                                  */ 00320000
 /* EXTERNAL MODULES : - RCB0M1M   MESSAGE MODULE                    */ 00330000
 /*                    - RCB0E1M   ERROR MODULE                      */ 00340000
 /*                    - RCB0T1M   RETRIEVE SYSTEM DATE              */ 00350000
 /*                    - RCB018M   CALCULATE HASH TOTALS             */ 00360000
 /*                    - RCBF50M   INSERT    PARAMETER               */ 00370000
 /*                    - RCBG50M   UPDATE    PARAMETER               */ 00380000
 /*                    - RCBI50M   REFERENCE PARAMETER               */ 00390000
 /*                                                                  */ 00400000
 /* MESSAGES         : 0003,0004,0007,0013,0014,0015,0017,0018,      */ 00410000
 /*                    0158,0167,0173,0174,0175,9999                 */ 00420000
 /*                                                                  */ 00430000
 /* THE FOLLOWING EXCEPTION ROUTINES HAVE BEEN APPLIED DURING        */ 00440000
 /* GENERATION :  0                                                  */ 00450000
 /*                                                                  */ 00460000
 /* MAINTENANCE LOG  :                                               */ 00470000
 /* ---------------                                                  */ 00480000
 /*                                                                  */ 00490000
 /* DATE       | WORK-ITEMNO. | DESCRIPTION                          */ 00500000
 /* ---------------------------------------------------------------- */ 00510000
 /* 1992-03-02 |              | INITIAL DEVELOPMENT                  */ 00520000
 /* 1992-07-20 | CED0001      | QF A1: HASH TOTAL & TIMESTAMP CHECK  */ 00530000
 /* 1993-02-27 | RC1032       | MCO / NULL INDICATORS                */ 00540000
 /* 1994-05-27 | PTM 519      | SEE PTM DESCRIPTION                  */ 00550000
 /* 1995-08-04 | RC01141      | FILL SEQUENCE_KEY (DG)               */ 00560000
 /* 1997-04-09 | PTM1036      | USE STANDARD PROLOG                  */ 00570000
 /* 1999-02-18 | PTM1248      | ONLY PROCESS BLANK COUNTRY           */ 00580000
 /* 1999-07-28 | RC01219      | DORO                                 */ 00590000
 /* 2002-01-12 | RC01229      | SERV REF INTERIM                     */ 00600000
 /* 2002-06-17 | RA01233      | TACTICAL SERVICE REFERENCE           */ 00610000
 /* 2004-04-28 | RB01256      | ALIGN SLC ENTITY NAMES               */ 00620002
 /* 2009-04-06 | RB01299      | CEDS ALIGNMENT TO CHIS 810           */ 00620103
 /*                                                                  */ 00621002
 /********************************************************************/ 00630000
1RCBBJBM: PROC                                                          00640000
          OPTIONS (MAIN)                                                00650000
          REORDER;                                                      00660000
0/********************************************************************/ 00670000
 /* FILE DECLARATIONS                                                */ 00680000
 /********************************************************************/ 00690000
0DCL RCBBJA0        FILE             /* UPSTREAM FILE                */ 00700000
                    RECORD                                              00710000
                    INPUT                                               00720000
                    SEQUENTIAL                                          00730000
                    ENV (FB RECSIZE(373));                /* RA01233 */ 00740000
 DCL RCBBJ11        FILE             /* CEDS FILE                    */ 00750000
                    RECORD                                              00760000
                    INPUT                                               00770000
                    SEQUENTIAL                                          00780000
                    ENV (FB RECSIZE(373));                /* RA01233 */ 00790000
 DCL RCBBJC0        FILE             /* ACTIONS FILE                 */ 00800000
                    RECORD                                              00810000
                    OUTPUT                                              00820000
                    SEQUENTIAL                                          00830000
                    ENV (FB RECSIZE(374));                /* RA01233 */ 00840000
                                                                        00850000
 DCL RCBPROC        FILE             /* INPUT CARD FOR PROC_ID       */ 00860000
                    RECORD                                              00870000
                    INPUT;                                              00880000
0/********************************************************************/ 00890000
 /* RECORD STRUCTURES FOR FILES                                      */ 00900000
 /********************************************************************/ 00910000
0                                    /*   IOAREA UPSTREAM FILE       */ 00920000
 DCL IOAREA_IN_1    CHAR(373);                            /* RA01233 */ 00930000
 DCL 1 RCBBJBSH_1   BASED(ADDR(IOAREA_IN_1)),                           00940000
       %INCLUDE RCBBAASH;;                                              00950000
 DCL 1 RCBBJBST_1   BASED(ADDR(IOAREA_IN_1)),                           00960000
                                                        /*SOC RB01299*/ 00961003
 /*    %INCLUDE RCBBAAST;;                                           */ 00970003
       %INCLUDE RCBBMAST;;                                              00971003
                                                        /*EOC RB01299*/ 00972003
 DCL 1 RCBBJBS1_1   BASED(ADDR(IOAREA_IN_1)),                           00980000
       %INCLUDE RCBBAAS1;,                                              00990000
      3 RCB470S,                                                        01000000
        %INCLUDE RCB470S;,                                              01010000
      3 RCB470SI,                                                       01020000
        %INCLUDE RCB470SI;;                                             01030000
                                     /*   IOAREA CEDS FILE           */ 01040000
 DCL IOAREA_IN_2    CHAR(373);                            /* RA01233 */ 01050000
 DCL 1 RCBBJBSH_2   BASED(ADDR(IOAREA_IN_2)),                           01060000
       %INCLUDE RCBBAASH;;                                              01070000
 DCL 1 RCBBJBST_2   BASED(ADDR(IOAREA_IN_2)),                           01080000
                                                        /*SOC RB01299*/ 01081004
 /*    %INCLUDE RCBBAAST;;                                           */ 01090004
       %INCLUDE RCBBMAST;;                                              01091004
                                                        /*EOC RB01299*/ 01092004
 DCL 1 RCBBJBS1_2   BASED(ADDR(IOAREA_IN_2)),                           01100000
       %INCLUDE RCBBAAS1;,                                              01110000
      3 RCB470S,                                                        01120000
        %INCLUDE RCB470S;,                                              01130000
      3 RCB470SI,                                                       01140000
        %INCLUDE RCB470SI;;                                             01150000
                                     /*   IOAREA ACTIONS FILE        */ 01160000
 DCL IOAREA_OUT     CHAR(374);                            /* RA01233 */ 01170000
 DCL 1 RCBBJBSH_3   BASED(ADDR(IOAREA_OUT)),                            01180000
       %INCLUDE RCBBAASH;;                                              01190000
 DCL 1 RCBBJBST_3   BASED(ADDR(IOAREA_OUT)),                            01200000
                                                        /*SOC RB01299*/ 01211003
 /*    %INCLUDE RCBBAAST;;                                           */ 01212003
       %INCLUDE RCBBMAST;;                                              01213003
                                                        /*EOC RB01299*/ 01214003
 DCL 1 RCBBJBS2_3   BASED(ADDR(IOAREA_OUT)),                            01220000
       %INCLUDE RCBBAAS2;,                                              01230000
      3 RCB470S,                                                        01240000
        %INCLUDE RCB470S;,                                              01250000
      3 RCB470SI,                                                       01260000
        %INCLUDE RCB470SI;;                                             01270000
                                     /*   INPUT CARD                 */ 01280000
 DCL 1 RCBPROC_REC,                                                     01290000
       %INCLUDE (RCBZ27S);;                                             01300000
0/********************************************************************/ 01310000
 /* EXTERNAL PARAMETER INTERFACES                                    */ 01320000
 /********************************************************************/ 01330000
0DCL PTR_INT_AREA            PTR;                                       01340000
 DCL PTR_RET_AREA_BB         PTR;                                       01350000
0DCL 1 PARM_INT_AREA,                                                   01360000
       %INCLUDE RCBZ01S;;                                               01370000
 DCL 1 PARM_RET_AREA_BB,                                                01380000
       %INCLUDE RCBZ02S;;                                               01390000
0/********************************************************************/ 01400000
 /* DB2 TABLE STRUCTURES                                             */ 01410000
 /********************************************************************/ 01420000
0DCL 1 TB_RCBV500,                                                      01430000
       %INCLUDE (RCB500S);;                                             01440000
0DCL 1 TB_RCBV500_I,                                                    01450000
       %INCLUDE (RCB500SI);;                                            01460000
0DCL 1 TB_RCBP24S         BASED (ADDR (TB_RCBV500)),                    01470000
       %INCLUDE (RCBP24S);;                                             01480000
0/********************************************************************/ 01490000
 /* SORT KEYS                                                        */ 01500000
 /********************************************************************/ 01510000
0DCL 1 SSK,                          /* SMALLEST SORT KEY            */ 01520000
      3 EOF                  CHAR(1)      INIT('0'),                    01530000
      3 REC_TYPE             CHAR(2),                                   01540000
      3 CTRYNO               CHAR(3),                                   01550000
      3 SERVICE_LVL_CODE     CHAR(3),                                   01560000
      3 END                  CHAR(0);                                   01570000
 DCL 1 PREV_SSK     LIKE SSK;        /* PREVIOUS SMALLEST SORT KEY   */ 01580000
 DCL 1 SK1          LIKE SSK;        /* SORT KEY UPSTREAM FILE       */ 01590000
 DCL 1 SK2          LIKE SSK;        /* SORT KEY CEDS FILE           */ 01600000
0/********************************************************************/ 01610000
 /* EXTERNAL ENTRIES                                                 */ 01620000
 /********************************************************************/ 01630000
0DCL PLIXOPT  EXT VAR CHAR(30) INIT ('ISA(10K),NOSTAE');                01640000
0DCL RCB0M1M  EXT ENTRY;             /* MESSAGE MODULE               */ 01650000
 DCL RCB0E1M  EXT ENTRY;             /* ERROR MODULE                 */ 01660000
 DCL RCB0T1M  EXT ENTRY;             /* RETRIEVE SYSTEM DATE         */ 01670000
 DCL RCB018M  EXT ENTRY;             /* CALCULATE HASH TOTALS        */ 01680000
 DCL RCBF50M  EXT ENTRY;             /* INSERT   PARAMETER           */ 01690000
 DCL RCBG50M  EXT ENTRY;             /* UPDATE   PARAMETER           */ 01700000
 DCL RCBI50M  EXT ENTRY;             /* RETRIEVE PARAMETER           */ 01710000
0/********************************************************************/ 01720000
 /* COUNTS                                                           */ 01730000
 /********************************************************************/ 01740000
0DCL 1 COUNT,                                                           01750000
       3 CNT_CTRY,                                                      01760000
                                                        /*SOC RB01299*/ 01761003
 /*      5 RCBBJA0       FIXED DEC(9),    /* COUNT UPSTREAM RECORDS  */ 01770003
 /*      5 RCBBJ11       FIXED DEC(9),    /* COUNT CEDS RECORDS      */ 01782004
 /*      5 RCBBJC0       FIXED DEC(9),    /* COUNT ACTIONS RECORDS   */ 01790003
 /*      5 MATCHES       FIXED DEC(9),    /* COUNT MATCHED RECORDS   */ 01800003
 /*      5 INSERTS       FIXED DEC(9),    /* COUNT INSERT ACTIONS    */ 01810003
 /*      5 UPDATES       FIXED DEC(9),    /* COUNT UPDATE ACTIONS    */ 01820003
 /*      5 DELETES       FIXED DEC(9),    /* COUNT DELETE ACTIONS    */ 01830003
 /*      5 SKIPPED       FIXED DEC(9),    /* COUNT SKIPPED ACTIONS   */ 01840003
         5 RCBBJA0       FIXED DEC(15),   /* COUNT UPSTREAM RECORDS  */ 01840105
         5 RCBBJ11       FIXED DEC(15),   /* COUNT CEDS RECORDS      */ 01840204
         5 RCBBJC0       FIXED DEC(15),   /* COUNT ACTIONS RECORDS   */ 01841003
         5 MATCHES       FIXED DEC(15),   /* COUNT MATCHED RECORDS   */ 01842003
         5 INSERTS       FIXED DEC(15),   /* COUNT INSERT ACTIONS    */ 01843003
         5 UPDATES       FIXED DEC(15),   /* COUNT UPDATE ACTIONS    */ 01844003
         5 DELETES       FIXED DEC(15),   /* COUNT DELETE ACTIONS    */ 01845003
         5 SKIPPED       FIXED DEC(15),   /* COUNT SKIPPED ACTIONS   */ 01846003
                                                        /*EOC RB01299*/ 01847003
         5 HASH_RCBBJA0 FIXED DEC(15,0), /* HASH UPSTREAM FILE       */ 01850000
         5 HASH_RCBBJ11 FIXED DEC(15,0), /* HASH CEDS FILE           */ 01860000
         5 HASH_RCBBJC0 FIXED DEC(15,0), /* HASH ACTION FILE         */ 01870000
       3 CNT_TOT,                                                       01880000
                                                        /*SOC RB01299*/ 01881003
 /*      5 RCBBJA0       FIXED DEC(9),    /* TOTAL UPSTREAM RECORDS  */ 01890003
 /*      5 RCBBJ11       FIXED DEC(9),    /* TOTAL CEDS RECORDS      */ 01903004
 /*      5 RCBBJC0       FIXED DEC(9),    /* TOTAL ACTIONS RECORDS   */ 01910003
 /*      5 MATCHES       FIXED DEC(9),    /* TOTAL MATCHED RECORDS   */ 01920003
 /*      5 INSERTS       FIXED DEC(9),    /* TOTAL INSERT ACTIONS    */ 01930003
 /*      5 UPDATES       FIXED DEC(9),    /* TOTAL UPDATE ACTIONS    */ 01940003
 /*      5 DELETES       FIXED DEC(9),    /* TOTAL DELETE ACTIONS    */ 01950003
 /*      5 SKIPPED       FIXED DEC(9);    /* TOTAL SKIPPED ACTIONS   */ 01960003
         5 RCBBJA0       FIXED DEC(15),    /* TOTAL UPSTREAM RECORDS  */01960105
         5 RCBBJ11       FIXED DEC(15),   /* TOTAL CEDS RECORDS      */ 01961004
         5 RCBBJC0       FIXED DEC(15),   /* TOTAL ACTIONS RECORDS   */ 01963003
         5 MATCHES       FIXED DEC(15),   /* TOTAL MATCHED RECORDS   */ 01964003
         5 INSERTS       FIXED DEC(15),   /* TOTAL INSERT ACTIONS    */ 01965003
         5 UPDATES       FIXED DEC(15),   /* TOTAL UPDATE ACTIONS    */ 01966003
         5 DELETES       FIXED DEC(15),   /* TOTAL DELETE ACTIONS    */ 01967003
         5 SKIPPED       FIXED DEC(15);   /* TOTAL SKIPPED ACTIONS   */ 01968003
                                                        /*EOC RB01299*/ 01969003
                                                                        01970000
 DCL CNT_PIC9         PIC'(09)9';       /* CONVERSION OF COUNTS      */ 01980000
 DCL CNT_PIC15        PIC'(15)9';       /* CONVERSION OF HASH TOTAL  */ 01990000
0/********************************************************************/ 02000000
 /* PROGRAM CONTROL PARAMETERS                                       */ 02010000
 /********************************************************************/ 02020000
0DCL 1 RCBP24S_UPSTR,                                                   02030000
     %INCLUDE (RCBP24S);;                                               02040000
0DCL 1 RCBP24S_CEDS,                                                    02050000
     %INCLUDE (RCBP24S);;                                               02060000
0/********************************************************************/ 02070000
 /* BIT SWITCHES                                                     */ 02080000
 /********************************************************************/ 02090000
0DCL TRUE                BIT(1)             INIT ('1'B);                02100000
 DCL FALSE               BIT(1)             INIT ('0'B);                02110000
 DCL SWITCH_CHANGED      BIT(1);                                        02120000
 DCL SWITCH_EOF_RCBPROC  BIT (1)            INIT ('0'B);                02130000
0/********************************************************************/ 02140000
 /* ALL OTHER USED TEMPORARY FIELDS                                  */ 02150000
 /********************************************************************/ 02160000
0DCL 1 WORK_FIELDS,                                                     02170000
       3 WRK_MOD_NAME             CHAR(8),                              02180000
       3 WRK_CTRYNO               CHAR(3),                              02190000
       3 WRK_SOURCE_INDICATOR     CHAR(1),                              02200000
       3 WRK_HASH_FIELD           CHAR(4),                              02210000
       3 WRK_LENGTH_RCB024        FIXED BIN (15,0),                     02220000
       3 WRK_FILE_UPSTR           CHAR(7)       INIT ('RCBBJA0'),       02230000
       3 WRK_FILE_CEDS            CHAR(7)       INIT ('RCBBJ11'),       02240000
       3 WRK_FILE_ACT             CHAR(7)       INIT ('RCBBJC0'),       02250000
       3 WRK_DATE_TIME            CHAR(20)      INIT (' '),             02260000
       3 WRK_TIME_STAMP_RCBBJA0   CHAR(20)      INIT (' '),             02270000
       3 WRK_TIME_STAMP_RCBBJ11   CHAR(20)      INIT (' '),             02280000
       3 WRK_RUN_DATE             CHAR(10),                             02290000
       3 WRK_EFF_DATE             CHAR(10),                             02300000
       3 WRK_END_DATE             CHAR(10);                             02310000
0/********************************************************************/ 02320000
 /* BUILTIN                                                          */ 02330000
 /********************************************************************/ 02340000
0DCL (ADDR,                                                             02350000
      CSTG,                                                             02360000
      LOW,                                                              02370000
      NULL,                                                             02380000
      STRING,                                                           02390000
      SUBSTR,                                                           02400000
      TIME,                                                             02410000
      VERIFY) BUILTIN;                                                  02420000
0/********************************************************************/ 02430000
 /* ON CONDITIONS                                                    */ 02440000
 /********************************************************************/ 02450000
0ON ENDFILE (RCBBJA0)                                                   02460000
   SK1.EOF = '1';                                                       02470000
 ON ENDFILE (RCBBJ11)                                                   02480000
   SK2.EOF = '1';                                                       02490000
 ON ENDFILE (RCBPROC)                                                   02500000
   SWITCH_EOF_RCBPROC = TRUE;                                           02510000
0/********************************************************************/ 02520000
 /* ON ERROR CONDITIONS                                              */ 02530000
 /********************************************************************/ 02540000
0%INCLUDE RCB0E0M;                                                      02550000
 END;                                                                   02560000
1/********************************************************************/ 02570000
 /*                 S T A R T   P R O C E S S I N G                  */ 02580000
 /********************************************************************/ 02590000
0CALL RCBBJBM_INIT;                                                     02600000
                                                                        02610000
0IF (SSK.EOF = '0' &                                                    02620000
     SSK.REC_TYPE ¬= '99')                                              02630000
 THEN DO;                                                               02640000
   CALL RCBBJBM_INIT_COUNTRY;                                           02650000
 END;                                                                   02660000
                                                                        02670000
0DO WHILE (SSK.EOF = '0'                                                02680000
        &  SSK.REC_TYPE ¬= '99');    /* WHILE NOT EOF                */ 02690000
0  SELECT;                                                              02700000
                                     /* SK UPSTREAM SMALLEST         */ 02710000
     WHEN (STRING(SK1) < STRING(SK2)) DO;                               02720000
       CALL RCBBJBM_INS;                                                02730000
       CALL RCBBJBM_CALC1;                                              02740000
       CALL RCBBJBM_READ1;                                              02750000
       END;                                                             02760000
                                     /* SK CEDS SMALLEST             */ 02770000
     WHEN (STRING(SK2) < STRING(SK1)) DO;                               02780000
       CALL RCBBJBM_DEL;                                                02790000
       CALL RCBBJBM_CALC2;                                              02800000
       CALL RCBBJBM_READ2;                                              02810000
       END;                                                             02820000
                                   /* KEYS ARE EQUAL               */   02830000
     OTHERWISE DO;                 /* SOME DATA FIELDS MAY DIFFER  */   02840000
       IF IOAREA_IN_1 ¬= IOAREA_IN_2                                    02850000
       THEN DO;                                                         02860000
         CALL RCBBJBM_UPD;                                              02870000
         END;                                                           02880000
       ELSE DO;                                                         02890000
         COUNT.CNT_CTRY.MATCHES = COUNT.CNT_CTRY.MATCHES + 1;           02900000
         END;                                                           02910000
       CALL RCBBJBM_CALC1;                                              02920000
       CALL RCBBJBM_READ1;         /* READ NEXT UPSTREAM RECORD    */   02930000
       CALL RCBBJBM_CALC2;                                              02940000
       CALL RCBBJBM_READ2;         /* READ NEXT CEDS RECORD        */   02950000
       END;                                                             02960000
     END;                                                               02970000
                                                                        02980000
   CALL RCBBJBM_SIC;               /* SET ITERATION CONDITIONS     */   02990000
0  END;                                                                 03000000
 CALL RCBBJBM_END_COUNTRY;                                              03010000
                                     /* TERMINATE PROGRAM            */ 03020000
 CALL RCBBJBM_TERM;                                                     03030000
1/********************************************************************/ 03040000
 /*                                                                  */ 03050000
 /* MODULE NAME      : RCBBJBM_INIT                                  */ 03060000
 /*                                                                  */ 03070000
 /* DESCRIPTION      : INIT PROGRAM                                  */ 03080000
 /*                                                                  */ 03090000
 /********************************************************************/ 03100000
0RCBBJBM_INIT: PROC;                                                    03110000
                                     /* INITIALIZE POINTERS          */ 03120000
 PTR_INT_AREA    = ADDR (PARM_INT_AREA);                                03130000
 PTR_RET_AREA_BB = ADDR (PARM_RET_AREA_BB);                             03140000
                                     /* INITIALIZE MESSAGE AREA      */ 03150000
 WRK_MOD_NAME                  = SDAISTP.SDAINAM;                       03160000
 PARM_INT_AREA.MSG_AREA        = '';                                    03170000
 PARM_INT_AREA.ERR_AREA        = '';                                    03180000
 PARM_INT_AREA.MSG_REQUEST     = 'O';                                   03190000
 PARM_INT_AREA.MSG_TARGET      = 'F';                                   03200000
 PARM_INT_AREA.ID_SOURCE_APPL  = 'RCB';                                 03210000
 PARM_INT_AREA.ID_SOURCE_PROG  = SUBSTR(WRK_MOD_NAME,1,6) || 'P';       03220000
 PARM_INT_AREA.ID_MOD_PATH (1) = WRK_MOD_NAME;                          03230000
 PARM_INT_AREA.ID_MOD_LEVEL    = 1;                                     03240000
 PARM_INT_AREA.PTR_PCB_IO      = NULL();                                03250000
 PARM_INT_AREA.PTR_PCB_ALT     = NULL();                                03260000
 PARM_INT_AREA.SYSTEM_TYPE     = 'B';                                   03270000
0PARM_INT_AREA.COUNTRY_NUMBER  = '';                                    03280000
                                     /* OPEN MESSAGE FILE            */ 03290000
 CALL RCB0M1M (PTR_INT_AREA);                                           03300000
                                     /* RETRIEVE SYSTEM DATE         */ 03310000
 CALL RCB0T1M (PTR_INT_AREA);                                           03320000
                                     /* INIT OTHER VARIABLES         */ 03330000
 SK1.EOF                = '0';                                          03340000
 SK2.EOF                = '0';                                          03350000
 COUNT                  =  0;                                           03360000
 WRK_CTRYNO             =  LOW(3);                                      03370000
 WRK_DATE_TIME          =  PARM_INT_AREA.SYSTEM_DATE || '.' || TIME();  03380000
 WRK_LENGTH_RCB024      = CSTG (TB_RCBP24S.TIME_STAMP) +                03390000
                          CSTG (TB_RCBP24S.HASH_TOTAL);                 03400000
                                                                        03410000
 OPEN FILE (RCBBJA0);            /* OPEN ALL FILES                  */  03420000
 OPEN FILE (RCBBJ11);                                                   03430000
 OPEN FILE (RCBBJC0);                                                   03440000
 OPEN FILE (RCBPROC);                                                   03450000
                                                                        03460000
 READ FILE (RCBPROC) INTO (RCBPROC_REC);  /* READ RCBPROC CARD */       03470000
                                                                        03480000
 IF SWITCH_EOF_RCBPROC                                                  03490000
 THEN                                                                   03500000
   DO;                                                                  03510000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               03520000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             03530000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0013';                           03540000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             03550000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBPROC';                        03560000
     CALL RCB0M1M (PTR_INT_AREA);                                       03570000
     CALL RCBBJBM_ERROR (NULL(), 'OTHER', '#001');                      03580000
   END;                                                                 03590000
                                                                        03600000
 PARM_INT_AREA.PROC_ID = RCBPROC_REC.PROC_ID;            /* PTM 519 */  03610000
                                                                        03620000
                                 /* CHECK HEADER RECORDS            */  03630000
 CALL RCBBJBM_CHECK_HEADER;                                             03640000
 CALL RCBBJBM_FILL_HEADER;                                              03650000
                                 /* READ RECORDS OF BOTH FILES      */  03660000
 CALL RCBBJBM_READ1;                                                    03670000
 CALL RCBBJBM_READ2;                                                    03680000
                                 /* SET ITERATION CONDITIONS        */  03690000
 CALL RCBBJBM_SIC;                                                      03700000
                                                                        03710000
 END RCBBJBM_INIT;                                                      03720000
1/********************************************************************/ 03730000
 /*                                                                  */ 03740000
 /* MODULE NAME      : RCBBJBM_INIT_COUNTRY                          */ 03750000
 /*                                                                  */ 03760000
 /* DESCRIPTION      : INITIAL ACTIONS FOR A COUNTRY                 */ 03770000
 /*                    RETRIEVE RCB024 PARAMETER FOR THE UPSTREAM    */ 03780000
 /*                    AND CEDS FILE AND CHECK TIME STAMPS           */ 03790000
 /*                                                                  */ 03800000
 /********************************************************************/ 03810000
0RCBBJBM_INIT_COUNTRY: PROC;                                            03820000
0COUNT.CNT_CTRY = 0;                  /* RESET COUNTRY COUNTERS    */   03830000
0PREV_SSK                     = SSK;                                    03840000
 PARM_INT_AREA.COUNTRY_NUMBER = SSK.CTRYNO;                             03850000
                                     /* RETRIEVE PARAMETER RCB024    */ 03860000
 TB_RCBV500                   = '';                                     03870000
 TB_RCBV500_I                 = '';                                     03880000
 TB_RCBP24S.NUMBER            = 'RCB024';                               03890000
 TB_RCBP24S.PROC_ID           =  RCBPROC_REC.PROC_ID;                   03900000
 TB_RCBP24S.CTRYNO            =  SSK.CTRYNO;                            03910000
 TB_RCBP24S.FILE_NAME         =  WRK_FILE_UPSTR;                        03920000
 TB_RCBP24S.SEQ_NUMBER        = '01';                                   03930000
                                                                        03940000
0CALL RCBI50M ('U',                                       /* RC01219 */ 03950000
               ADDR(TB_RCBV500),                                        03960000
               ADDR(TB_RCBV500_I),                                      03970000
               PTR_RET_AREA_BB,                                         03980000
               PTR_INT_AREA);                                           03990000
0SELECT(PARM_RET_AREA_BB.RETURN_CODE);                                  04000000
 WHEN (0)                                                               04010000
   DO;                                                                  04020000
     RCBP24S_UPSTR = TB_RCBP24S, BY NAME;                               04030000
   END;                                                                 04040000
 WHEN (4)                                                               04050000
   DO;                                                                  04060000
     PARM_INT_AREA.MESSAGE_TYPE      = 'IS';                            04070000
     PARM_INT_AREA.MESSAGE_NUMBER    = 'I050';                          04080000
     PARM_INT_AREA.MSG_VAR_CODES     = '';                              04090000
     PARM_INT_AREA.MSG_VAR_CODE_6    = 'PN';                            04100000
     PARM_INT_AREA.MSG_VAR_VALUE_6   = 'RCB024';                        04110000
     PARM_INT_AREA.MSG_VAR_CODE_7    = 'PK';                            04120000
     PARM_INT_AREA.MSG_VAR_VALUE_7   =  STRING (TB_RCBP24S.EXTRA_KEY);  04130000
     CALL RCB0M1M (PTR_INT_AREA);                                       04140000
     CALL RCBBJBM_ERROR (NULL(),                                        04150000
                        'OTHER',                                        04160000
                        '#002');                                        04170000
    END;                                                                04180000
  OTHERWISE                                                             04190000
    DO;                                                                 04200000
      CALL RCBBJBM_ERROR (ADDR (PARM_RET_AREA_BB.RETURN_SQL),           04210000
                          'DB2',                                        04220000
                          '#003');                                      04230000
    END;                                                                04240000
  END;                                                                  04250000
                                                                        04260000
 IF RCBP24S_UPSTR.TIME_STAMP ¬= WRK_TIME_STAMP_RCBBJA0                  04270000
 THEN                                                                   04280000
   DO;                                                                  04290000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             04300000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               04310000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0174';                           04320000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             04330000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_UPSTR;                   04340000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'TP';                             04350000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = WRK_TIME_STAMP_RCBBJA0;           04360000
     PARM_INT_AREA.MSG_VAR_CODE_8   = 'TP';                             04370000
     PARM_INT_AREA.MSG_VAR_VALUE_8  = RCBP24S_UPSTR.TIME_STAMP;         04380000
     CALL RCB0M1M (PTR_INT_AREA);                                       04390000
                                     /* ABEND                        */ 04400000
     CALL RCBBJBM_ERROR (NULL(),                                        04410000
                         'OTHER',                                       04420000
                         '#004');                                       04430000
   END;                                                                 04440000
                                                                        04450000
                                     /* RETRIEVE PARAMETER RCB024    */ 04460000
 TB_RCBV500                   = '';                                     04470000
 TB_RCBV500_I                 = '';                                     04480000
 TB_RCBP24S.NUMBER            = 'RCB024';                               04490000
 TB_RCBP24S.PROC_ID           = RCBPROC_REC.PROC_ID;                    04500000
 TB_RCBP24S.CTRYNO            = SSK.CTRYNO;                             04510000
 TB_RCBP24S.FILE_NAME         = WRK_FILE_CEDS;                          04520000
 TB_RCBP24S.SEQ_NUMBER        = '01';                                   04530000
                                                                        04540000
0CALL RCBI50M ('U',                                       /* RC01219 */ 04550000
               ADDR(TB_RCBV500),                                        04560000
               ADDR(TB_RCBV500_I),                                      04570000
               PTR_RET_AREA_BB,                                         04580000
               PTR_INT_AREA);                                           04590000
0SELECT(PARM_RET_AREA_BB.RETURN_CODE);                                  04600000
   WHEN (0)                                                             04610000
     DO;                                                                04620000
       RCBP24S_CEDS = TB_RCBP24S, BY NAME;                              04630000
     END;                                                               04640000
   WHEN (4)                                                             04650000
     DO;                                                                04660000
       PARM_INT_AREA.MESSAGE_TYPE      = 'IS';                          04670000
       PARM_INT_AREA.MESSAGE_NUMBER    = 'I050';                        04680000
       PARM_INT_AREA.MSG_VAR_CODES     = '';                            04690000
       PARM_INT_AREA.MSG_VAR_CODE_6    = 'PN';                          04700000
       PARM_INT_AREA.MSG_VAR_VALUE_6   = 'RCB024';                      04710000
       PARM_INT_AREA.MSG_VAR_CODE_7    = 'PK';                          04720000
       PARM_INT_AREA.MSG_VAR_VALUE_7   =  STRING (TB_RCBP24S.EXTRA_KEY);04730000
       CALL RCB0M1M (PTR_INT_AREA);                                     04740000
       CALL RCBBJBM_ERROR (NULL(),                                      04750000
                          'OTHER',                                      04760000
                          '#005');                                      04770000
     END;                                                               04780000
   OTHERWISE                                                            04790000
     DO;                                                                04800000
       CALL RCBBJBM_ERROR (ADDR (PARM_RET_AREA_BB.RETURN_SQL),          04810000
                           'DB2',                                       04820000
                           '#006');                                     04830000
     END;                                                               04840000
 END;                                                                   04850000
                                                                        04860000
 IF RCBP24S_CEDS.TIME_STAMP ¬= WRK_TIME_STAMP_RCBBJ11                   04870000
 THEN                                                                   04880000
   DO;                                                                  04890000
    PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                              04900000
    PARM_INT_AREA.MSG_VAR_CODES    = '';                                04910000
    PARM_INT_AREA.MESSAGE_NUMBER   = '0174';                            04920000
    PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                              04930000
    PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_CEDS;                     04940000
    PARM_INT_AREA.MSG_VAR_CODE_7   = 'TP';                              04950000
    PARM_INT_AREA.MSG_VAR_VALUE_7  = WRK_TIME_STAMP_RCBBJ11;            04960000
    PARM_INT_AREA.MSG_VAR_CODE_8   = 'TP';                              04970000
    PARM_INT_AREA.MSG_VAR_VALUE_8  = RCBP24S_CEDS.TIME_STAMP;           04980000
    CALL RCB0M1M (PTR_INT_AREA);                                        04990000
                                    /* ABEND                        */  05000000
    CALL RCBBJBM_ERROR (NULL(),                                         05010000
                        'OTHER',                                        05020000
                        '#007');                                        05030000
   END;                                                                 05040000
                      /* CHECK CORRECT RUN DATES IF COUNTRIES EQUAL */  05050000
                                                                        05060000
 IF  RCBBJBS1_1.RUN_DATE ¬= RCBBJBS1_2.RUN_DATE                         05070000
 &   SK1.REC_TYPE ¬= '99'                                               05080000
 &   SK2.REC_TYPE ¬= '99'                                               05090000
 THEN                                                                   05100000
   DO;                                                                  05110000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               05120000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             05130000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0167';                           05140000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'D1';                             05150000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = RCBBJBS1_1.RUN_DATE;              05160000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'D2';                             05170000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = RCBBJBS1_2.RUN_DATE;              05180000
     CALL RCB0M1M (PTR_INT_AREA);                                       05190000
     CALL RCBBJBM_ERROR (NULL(),                                        05200000
                         'OTHER',                                       05210000
                         '#008');                                       05220000
   END;                                                                 05230000
                                                                        05240000
0END RCBBJBM_INIT_COUNTRY;                                              05250000
1/********************************************************************/ 05260000
 /*                                                                  */ 05270000
 /* MODULE NAME      : RCBBJBM_INS                                   */ 05280000
 /*                                                                  */ 05290000
 /* DESCRIPTION      : PROCESS NEW RECORD                            */ 05300000
 /*                                                                  */ 05310000
 /********************************************************************/ 05320000
0RCBBJBM_INS: PROC;                                                     05330000
0IOAREA_OUT            = '';                                            05340000
 RCBBJBS2_3.REC_TYPE   = '02';                                          05350000
 RCBBJBS2_3.CTRYNO     = RCBBJBS1_1.CTRYNO;                             05360000
 RCBBJBS2_3.PGR_TYPE   = RCBBJBS1_1.PGR_TYPE;                           05370000
 RCBBJBS2_3.RUN_DATE   = RCBBJBS1_1.RUN_DATE;                           05380000
 RCBBJBS2_3.ACTION_IND = 'I';                                           05390000
 RCBBJBS2_3.RCB470S    = RCBBJBS1_1.RCB470S;                            05400000
 RCBBJBS2_3.RCB470SI   = RCBBJBS1_1.RCB470SI;                           05410000
                                     /* DEFAULT FIELDS               */ 05420000
 COUNT.CNT_CTRY.INSERTS = COUNT.CNT_CTRY.INSERTS + 1;                   05430000
 CALL RCBBJBM_WRITE;                                                    05440000
 END RCBBJBM_INS;                                                       05450000
1/********************************************************************/ 05460000
 /*                                                                  */ 05470000
 /* MODULE NAME      : RCBBJBM_DEL                                   */ 05480000
 /*                                                                  */ 05490000
 /* DESCRIPTION      : PROCESS OBSOLETE RECORD                       */ 05500000
 /*                                                                  */ 05510000
 /********************************************************************/ 05520000
0RCBBJBM_DEL: PROC;                                                     05530000
0IOAREA_OUT            = '';                                            05540000
 RCBBJBS2_3.REC_TYPE   = '02';                                          05550000
 RCBBJBS2_3.CTRYNO     = RCBBJBS1_2.CTRYNO;                             05560000
 RCBBJBS2_3.PGR_TYPE   = RCBBJBS1_2.PGR_TYPE;                           05570000
 RCBBJBS2_3.RUN_DATE   = RCBBJBS1_2.RUN_DATE;                           05580000
 RCBBJBS2_3.ACTION_IND = 'D';                                           05590000
 RCBBJBS2_3.RCB470S    = RCBBJBS1_2.RCB470S;                            05600000
 RCBBJBS2_3.RCB470SI   = RCBBJBS1_2.RCB470SI;                           05610000
 COUNT.CNT_CTRY.DELETES = COUNT.CNT_CTRY.DELETES + 1;                   05620000
 CALL RCBBJBM_WRITE;                                                    05630000
 END RCBBJBM_DEL;                                                       05640000
1/********************************************************************/ 05650000
 /*                                                                  */ 05660000
 /* MODULE NAME      : RCBBJBM_UPD                                   */ 05670000
 /*                                                                  */ 05680000
 /* DESCRIPTION      : PROCESS CHANGED RECORD                        */ 05690000
 /*                                                                  */ 05700000
 /********************************************************************/ 05710000
0RCBBJBM_UPD: PROC;                                                     05720000
0IOAREA_OUT            = '';                                            05730000
 RCBBJBS2_3.REC_TYPE   = '02';                                          05740000
 RCBBJBS2_3.CTRYNO     = RCBBJBS1_1.CTRYNO;                             05750000
 RCBBJBS2_3.PGR_TYPE   = RCBBJBS1_1.PGR_TYPE;                           05760000
 RCBBJBS2_3.RUN_DATE   = RCBBJBS1_1.RUN_DATE;                           05770000
 RCBBJBS2_3.ACTION_IND = 'U';                                           05780000
 RCBBJBS2_3.RCB470S    = RCBBJBS1_1.RCB470S;                            05790000
 RCBBJBS2_3.RCB470SI   = RCBBJBS1_1.RCB470SI;                           05800000
 SWITCH_CHANGED        = FALSE;                                         05810000
                                     /* COMPARE FIELDS               */ 05820000
 IF RCBBJBS2_3.COVERAGE_START_1       ¬= RCBBJBS1_2.COVERAGE_START_1    05830000
 THEN DO;                                                               05840000
   SWITCH_CHANGED                     = TRUE;                           05850000
   END;                                                                 05860000
 IF RCBBJBS2_3.COVERAGE_END_1         ¬= RCBBJBS1_2.COVERAGE_END_1      05870000
 THEN DO;                                                               05880000
   SWITCH_CHANGED                     = TRUE;                           05890000
   END;                                                                 05900000
 IF RCBBJBS2_3.COVERAGE_START_2       ¬= RCBBJBS1_2.COVERAGE_START_2    05910000
 THEN DO;                                                               05920000
   SWITCH_CHANGED                     = TRUE;                           05930000
   END;                                                                 05940000
 IF RCBBJBS2_3.COVERAGE_END_2         ¬= RCBBJBS1_2.COVERAGE_END_2      05950000
 THEN DO;                                                               05960000
   SWITCH_CHANGED                     = TRUE;                           05970000
   END;                                                                 05980000
 IF RCBBJBS2_3.COVERAGE_START_3       ¬= RCBBJBS1_2.COVERAGE_START_3    05990000
 THEN DO;                                                               06000000
   SWITCH_CHANGED                     = TRUE;                           06010000
   END;                                                                 06020000
 IF RCBBJBS2_3.COVERAGE_END_3         ¬= RCBBJBS1_2.COVERAGE_END_3      06030000
 THEN DO;                                                               06040000
   SWITCH_CHANGED                     = TRUE;                           06050000
   END;                                                                 06060000
 IF RCBBJBS2_3.COVERAGE_START_4       ¬= RCBBJBS1_2.COVERAGE_START_4    06070000
 THEN DO;                                                               06080000
   SWITCH_CHANGED                     = TRUE;                           06090000
   END;                                                                 06100000
 IF RCBBJBS2_3.COVERAGE_END_4         ¬= RCBBJBS1_2.COVERAGE_END_4      06110000
 THEN DO;                                                               06120000
   SWITCH_CHANGED                     = TRUE;                           06130000
   END;                                                                 06140000
 IF RCBBJBS2_3.COVERAGE_START_5       ¬= RCBBJBS1_2.COVERAGE_START_5    06150000
 THEN DO;                                                               06160000
   SWITCH_CHANGED                     = TRUE;                           06170000
   END;                                                                 06180000
 IF RCBBJBS2_3.COVERAGE_END_5         ¬= RCBBJBS1_2.COVERAGE_END_5      06190000
 THEN DO;                                                               06200000
   SWITCH_CHANGED                     = TRUE;                           06210000
   END;                                                                 06220000
 IF RCBBJBS2_3.COVERAGE_START_6       ¬= RCBBJBS1_2.COVERAGE_START_6    06230000
 THEN DO;                                                               06240000
   SWITCH_CHANGED                     = TRUE;                           06250000
   END;                                                                 06260000
 IF RCBBJBS2_3.COVERAGE_END_6         ¬= RCBBJBS1_2.COVERAGE_END_6      06270000
 THEN DO;                                                               06280000
   SWITCH_CHANGED                     = TRUE;                           06290000
   END;                                                                 06300000
 IF RCBBJBS2_3.COVERAGE_START_7       ¬= RCBBJBS1_2.COVERAGE_START_7    06310000
 THEN DO;                                                               06320000
   SWITCH_CHANGED                     = TRUE;                           06330000
   END;                                                                 06340000
 IF RCBBJBS2_3.COVERAGE_END_7         ¬= RCBBJBS1_2.COVERAGE_END_7      06350000
 THEN DO;                                                               06360000
   SWITCH_CHANGED                     = TRUE;                           06370000
   END;                                                                 06380000
 IF RCBBJBS2_3.SERVICE_DLVR_METHD     ¬= RCBBJBS1_2.SERVICE_DLVR_METHD  06390000
 THEN DO;                                                               06400000
   SWITCH_CHANGED                     = TRUE;                           06410000
   END;                                                                 06420000
                                                      /* SOC RA01233 */ 06430000
 IF RCBBJBS2_3.INDNULL(17)            ¬= RCBBJBS1_2.INDNULL(17)         06440000
 THEN                                                                   06450000
     SWITCH_CHANGED                   = TRUE;                           06460000
 ELSE                                                                   06470000
   IF RCBBJBS2_3.TIME_ZERO_IND        ¬= RCBBJBS1_2.TIME_ZERO_IND       06480000
   THEN DO;                                                             06490000
     SWITCH_CHANGED                   = TRUE;                           06500000
     END;                                                               06510000
                                                                        06520000
 IF RCBBJBS2_3.INDNULL(18)            ¬= RCBBJBS1_2.INDNULL(18)         06530000
 THEN                                                                   06540000
     SWITCH_CHANGED                   = TRUE;                           06550000
 ELSE                                                                   06560000
   IF RCBBJBS2_3.INDNULL(18)          = 0                               06570000
   THEN                                                                 06580000
     IF RCBBJBS2_3.CONTACT_TIME_QTY_1 ¬= RCBBJBS1_2.CONTACT_TIME_QTY_1  06590001
     THEN DO;                                                           06600000
       SWITCH_CHANGED                 = TRUE;                           06610000
       END;                                                             06620000
 IF RCBBJBS2_3.INDNULL(19)            ¬= RCBBJBS1_2.INDNULL(19)         06630000
 THEN                                                                   06640000
     SWITCH_CHANGED                   = TRUE;                           06650000
 ELSE                                                                   06660000
   IF RCBBJBS2_3.INDNULL(19)          = 0                               06670000
   THEN                                                                 06680000
     IF RCBBJBS2_3.CONTACT_TIME_UNT_1 ¬= RCBBJBS1_2.CONTACT_TIME_UNT_1  06690001
     THEN DO;                                                           06700000
       SWITCH_CHANGED                 = TRUE;                           06710000
       END;                                                             06720000
 IF RCBBJBS2_3.INDNULL(20)            ¬= RCBBJBS1_2.INDNULL(20)         06730000
 THEN                                                                   06740000
     SWITCH_CHANGED                   = TRUE;                           06750000
 ELSE                                                                   06760000
   IF RCBBJBS2_3.INDNULL(20)          = 0                               06770000
   THEN                                                                 06780000
     IF RCBBJBS2_3.CONTACT_TIME_COM_1 ¬= RCBBJBS1_2.CONTACT_TIME_COM_1  06790001
     THEN DO;                                                           06800000
       SWITCH_CHANGED                 = TRUE;                           06810000
       END;                                                             06820000
 IF RCBBJBS2_3.INDNULL(21)            ¬= RCBBJBS1_2.INDNULL(21)         06830000
 THEN                                                                   06840000
     SWITCH_CHANGED                   = TRUE;                           06850000
 ELSE                                                                   06860000
   IF RCBBJBS2_3.INDNULL(21)          = 0                               06870000
   THEN                                                                 06880000
     IF RCBBJBS2_3.CONTACT_TIME_QTY_2 ¬= RCBBJBS1_2.CONTACT_TIME_QTY_2  06890001
     THEN DO;                                                           06900000
       SWITCH_CHANGED                 = TRUE;                           06910000
       END;                                                             06920000
 IF RCBBJBS2_3.INDNULL(22)            ¬= RCBBJBS1_2.INDNULL(22)         06930000
 THEN                                                                   06940000
     SWITCH_CHANGED                   = TRUE;                           06950000
 ELSE                                                                   06960000
   IF RCBBJBS2_3.INDNULL(22)          = 0                               06970000
   THEN                                                                 06980000
     IF RCBBJBS2_3.CONTACT_TIME_UNT_2 ¬= RCBBJBS1_2.CONTACT_TIME_UNT_2  06990001
     THEN DO;                                                           07000000
       SWITCH_CHANGED                 = TRUE;                           07010000
       END;                                                             07020000
 IF RCBBJBS2_3.INDNULL(23)            ¬= RCBBJBS1_2.INDNULL(23)         07030000
 THEN                                                                   07040000
     SWITCH_CHANGED                   = TRUE;                           07050000
 ELSE                                                                   07060000
   IF RCBBJBS2_3.INDNULL(23)          = 0                               07070000
   THEN                                                                 07080000
     IF RCBBJBS2_3.CONTACT_TIME_COM_2 ¬= RCBBJBS1_2.CONTACT_TIME_COM_2  07090001
     THEN DO;                                                           07100000
       SWITCH_CHANGED                 = TRUE;                           07110000
       END;                                                             07120000
 IF RCBBJBS2_3.INDNULL(24)            ¬= RCBBJBS1_2.INDNULL(24)         07130000
 THEN                                                                   07140000
     SWITCH_CHANGED                   = TRUE;                           07150000
 ELSE                                                                   07160000
   IF RCBBJBS2_3.INDNULL(24)          = 0                               07170000
   THEN                                                                 07180000
     IF RCBBJBS2_3.CONTACT_TIME_QTY_3 ¬= RCBBJBS1_2.CONTACT_TIME_QTY_3  07190001
     THEN DO;                                                           07200000
       SWITCH_CHANGED                 = TRUE;                           07210000
       END;                                                             07220000
 IF RCBBJBS2_3.INDNULL(25)            ¬= RCBBJBS1_2.INDNULL(25)         07230000
 THEN                                                                   07240000
     SWITCH_CHANGED                   = TRUE;                           07250000
 ELSE                                                                   07260000
   IF RCBBJBS2_3.INDNULL(25)          = 0                               07270000
   THEN                                                                 07280000
     IF RCBBJBS2_3.CONTACT_TIME_UNT_3 ¬= RCBBJBS1_2.CONTACT_TIME_UNT_3  07290001
     THEN DO;                                                           07300000
       SWITCH_CHANGED                 = TRUE;                           07310000
       END;                                                             07320000
 IF RCBBJBS2_3.INDNULL(26)            ¬= RCBBJBS1_2.INDNULL(26)         07330000
 THEN                                                                   07340000
     SWITCH_CHANGED                   = TRUE;                           07350000
 ELSE                                                                   07360000
   IF RCBBJBS2_3.INDNULL(26)          = 0                               07370000
   THEN                                                                 07380000
     IF RCBBJBS2_3.CONTACT_TIME_COM_3 ¬= RCBBJBS1_2.CONTACT_TIME_COM_3  07390001
     THEN DO;                                                           07400000
       SWITCH_CHANGED                 = TRUE;                           07410000
       END;                                                             07420000
 IF RCBBJBS2_3.INDNULL(27)            ¬= RCBBJBS1_2.INDNULL(27)         07430000
 THEN                                                                   07440000
     SWITCH_CHANGED                   = TRUE;                           07450000
 ELSE                                                                   07460000
   IF RCBBJBS2_3.INDNULL(27)          = 0                               07470000
   THEN                                                                 07480000
     IF RCBBJBS2_3.ONSITE_RESP_QTY_1 ¬= RCBBJBS1_2.ONSITE_RESP_QTY_1    07490001
     THEN DO;                                                           07500000
       SWITCH_CHANGED                 = TRUE;                           07510000
       END;                                                             07520000
 IF RCBBJBS2_3.INDNULL(28)            ¬= RCBBJBS1_2.INDNULL(28)         07530000
 THEN                                                                   07540000
     SWITCH_CHANGED                   = TRUE;                           07550000
 ELSE                                                                   07560000
   IF RCBBJBS2_3.INDNULL(28)          = 0                               07570000
   THEN                                                                 07580000
     IF RCBBJBS2_3.ONSITE_RESP_UNT_1 ¬= RCBBJBS1_2.ONSITE_RESP_UNT_1    07590001
     THEN DO;                                                           07600000
       SWITCH_CHANGED                 = TRUE;                           07610000
       END;                                                             07620000
 IF RCBBJBS2_3.INDNULL(29)            ¬= RCBBJBS1_2.INDNULL(29)         07630000
 THEN                                                                   07640000
     SWITCH_CHANGED                   = TRUE;                           07650000
 ELSE                                                                   07660000
   IF RCBBJBS2_3.INDNULL(29)          = 0                               07670000
   THEN                                                                 07680000
     IF RCBBJBS2_3.ONSITE_RESP_COM_1 ¬= RCBBJBS1_2.ONSITE_RESP_COM_1    07690001
     THEN DO;                                                           07700000
       SWITCH_CHANGED                 = TRUE;                           07710000
       END;                                                             07720000
 IF RCBBJBS2_3.INDNULL(30)            ¬= RCBBJBS1_2.INDNULL(30)         07730000
 THEN                                                                   07740000
     SWITCH_CHANGED                   = TRUE;                           07750000
 ELSE                                                                   07760000
   IF RCBBJBS2_3.INDNULL(30)          = 0                               07770000
   THEN                                                                 07780000
     IF RCBBJBS2_3.ONSITE_RESP_QTY_2 ¬= RCBBJBS1_2.ONSITE_RESP_QTY_2    07790001
     THEN DO;                                                           07800000
       SWITCH_CHANGED                 = TRUE;                           07810000
       END;                                                             07820000
 IF RCBBJBS2_3.INDNULL(31)            ¬= RCBBJBS1_2.INDNULL(31)         07830000
 THEN                                                                   07840000
     SWITCH_CHANGED                   = TRUE;                           07850000
 ELSE                                                                   07860000
   IF RCBBJBS2_3.INDNULL(31)          = 0                               07870000
   THEN                                                                 07880000
     IF RCBBJBS2_3.ONSITE_RESP_UNT_2 ¬= RCBBJBS1_2.ONSITE_RESP_UNT_2    07890001
     THEN DO;                                                           07900000
       SWITCH_CHANGED                 = TRUE;                           07910000
       END;                                                             07920000
 IF RCBBJBS2_3.INDNULL(32)            ¬= RCBBJBS1_2.INDNULL(32)         07930000
 THEN                                                                   07940000
     SWITCH_CHANGED                   = TRUE;                           07950000
 ELSE                                                                   07960000
   IF RCBBJBS2_3.INDNULL(32)          = 0                               07970000
   THEN                                                                 07980000
     IF RCBBJBS2_3.ONSITE_RESP_COM_2 ¬= RCBBJBS1_2.ONSITE_RESP_COM_2    07990001
     THEN DO;                                                           08000000
       SWITCH_CHANGED                 = TRUE;                           08010000
       END;                                                             08020000
 IF RCBBJBS2_3.INDNULL(33)            ¬= RCBBJBS1_2.INDNULL(33)         08030000
 THEN                                                                   08040000
     SWITCH_CHANGED                   = TRUE;                           08050000
 ELSE                                                                   08060000
   IF RCBBJBS2_3.INDNULL(33)          = 0                               08070000
   THEN                                                                 08080000
     IF RCBBJBS2_3.ONSITE_RESP_QTY_3 ¬= RCBBJBS1_2.ONSITE_RESP_QTY_3    08090001
     THEN DO;                                                           08100000
       SWITCH_CHANGED                 = TRUE;                           08110000
       END;                                                             08120000
 IF RCBBJBS2_3.INDNULL(34)            ¬= RCBBJBS1_2.INDNULL(34)         08130000
 THEN                                                                   08140000
     SWITCH_CHANGED                   = TRUE;                           08150000
 ELSE                                                                   08160000
   IF RCBBJBS2_3.INDNULL(34)          = 0                               08170000
   THEN                                                                 08180000
     IF RCBBJBS2_3.ONSITE_RESP_UNT_3 ¬= RCBBJBS1_2.ONSITE_RESP_UNT_3    08190001
     THEN DO;                                                           08200000
       SWITCH_CHANGED                 = TRUE;                           08210000
       END;                                                             08220000
 IF RCBBJBS2_3.INDNULL(35)            ¬= RCBBJBS1_2.INDNULL(35)         08230000
 THEN                                                                   08240000
     SWITCH_CHANGED                   = TRUE;                           08250000
 ELSE                                                                   08260000
   IF RCBBJBS2_3.INDNULL(35)          = 0                               08270000
   THEN                                                                 08280000
     IF RCBBJBS2_3.ONSITE_RESP_COM_3 ¬= RCBBJBS1_2.ONSITE_RESP_COM_3    08290001
     THEN DO;                                                           08300000
       SWITCH_CHANGED                 = TRUE;                           08310000
       END;                                                             08320000
 IF RCBBJBS2_3.INDNULL(36)            ¬= RCBBJBS1_2.INDNULL(36)         08330000
 THEN                                                                   08340000
     SWITCH_CHANGED                   = TRUE;                           08350000
 ELSE                                                                   08360000
   IF RCBBJBS2_3.INDNULL(36)          = 0                               08370000
   THEN                                                                 08380000
     IF RCBBJBS2_3.FIX_TIME_QTY_1 ¬= RCBBJBS1_2.FIX_TIME_QTY_1          08390000
     THEN DO;                                                           08400000
       SWITCH_CHANGED                 = TRUE;                           08410000
       END;                                                             08420000
 IF RCBBJBS2_3.INDNULL(37)            ¬= RCBBJBS1_2.INDNULL(37)         08430000
 THEN                                                                   08440000
     SWITCH_CHANGED                   = TRUE;                           08450000
 ELSE                                                                   08460000
   IF RCBBJBS2_3.INDNULL(37)          = 0                               08470000
   THEN                                                                 08480000
     IF RCBBJBS2_3.FIX_TIME_UNT_1 ¬= RCBBJBS1_2.FIX_TIME_UNT_1          08490000
     THEN DO;                                                           08500000
       SWITCH_CHANGED                 = TRUE;                           08510000
       END;                                                             08520000
 IF RCBBJBS2_3.INDNULL(38)            ¬= RCBBJBS1_2.INDNULL(38)         08530000
 THEN                                                                   08540000
     SWITCH_CHANGED                   = TRUE;                           08550000
 ELSE                                                                   08560000
   IF RCBBJBS2_3.INDNULL(38)          = 0                               08570000
   THEN                                                                 08580000
     IF RCBBJBS2_3.FIX_TIME_COM_1 ¬= RCBBJBS1_2.FIX_TIME_COM_1          08590000
     THEN DO;                                                           08600000
       SWITCH_CHANGED                 = TRUE;                           08610000
       END;                                                             08620000
 IF RCBBJBS2_3.INDNULL(39)            ¬= RCBBJBS1_2.INDNULL(39)         08630000
 THEN                                                                   08640000
     SWITCH_CHANGED                   = TRUE;                           08650000
 ELSE                                                                   08660000
   IF RCBBJBS2_3.INDNULL(39)          = 0                               08670000
   THEN                                                                 08680000
     IF RCBBJBS2_3.FIX_TIME_QTY_2 ¬= RCBBJBS1_2.FIX_TIME_QTY_2          08690000
     THEN DO;                                                           08700000
       SWITCH_CHANGED                 = TRUE;                           08710000
       END;                                                             08720000
 IF RCBBJBS2_3.INDNULL(40)            ¬= RCBBJBS1_2.INDNULL(40)         08730000
 THEN                                                                   08740000
     SWITCH_CHANGED                   = TRUE;                           08750000
 ELSE                                                                   08760000
   IF RCBBJBS2_3.INDNULL(40)          = 0                               08770000
   THEN                                                                 08780000
     IF RCBBJBS2_3.FIX_TIME_UNT_2 ¬= RCBBJBS1_2.FIX_TIME_UNT_2          08790000
     THEN DO;                                                           08800000
       SWITCH_CHANGED                 = TRUE;                           08810000
       END;                                                             08820000
 IF RCBBJBS2_3.INDNULL(41)            ¬= RCBBJBS1_2.INDNULL(41)         08830000
 THEN                                                                   08840000
     SWITCH_CHANGED                   = TRUE;                           08850000
 ELSE                                                                   08860000
   IF RCBBJBS2_3.INDNULL(41)          = 0                               08870000
   THEN                                                                 08880000
     IF RCBBJBS2_3.FIX_TIME_COM_2 ¬= RCBBJBS1_2.FIX_TIME_COM_2          08890000
     THEN DO;                                                           08900000
       SWITCH_CHANGED                 = TRUE;                           08910000
       END;                                                             08920000
 IF RCBBJBS2_3.INDNULL(42)            ¬= RCBBJBS1_2.INDNULL(42)         08930000
 THEN                                                                   08940000
     SWITCH_CHANGED                   = TRUE;                           08950000
 ELSE                                                                   08960000
   IF RCBBJBS2_3.INDNULL(42)          = 0                               08970000
   THEN                                                                 08980000
     IF RCBBJBS2_3.FIX_TIME_QTY_3 ¬= RCBBJBS1_2.FIX_TIME_QTY_3          08990000
     THEN DO;                                                           09000000
       SWITCH_CHANGED                 = TRUE;                           09010000
       END;                                                             09020000
 IF RCBBJBS2_3.INDNULL(43)            ¬= RCBBJBS1_2.INDNULL(43)         09030000
 THEN                                                                   09040000
     SWITCH_CHANGED                   = TRUE;                           09050000
 ELSE                                                                   09060000
   IF RCBBJBS2_3.INDNULL(43)          = 0                               09070000
   THEN                                                                 09080000
     IF RCBBJBS2_3.FIX_TIME_UNT_3 ¬= RCBBJBS1_2.FIX_TIME_UNT_3          09090000
     THEN DO;                                                           09100000
       SWITCH_CHANGED                 = TRUE;                           09110000
       END;                                                             09120000
 IF RCBBJBS2_3.INDNULL(44)            ¬= RCBBJBS1_2.INDNULL(44)         09130000
 THEN                                                                   09140000
     SWITCH_CHANGED                   = TRUE;                           09150000
 ELSE                                                                   09160000
   IF RCBBJBS2_3.INDNULL(44)          = 0                               09170000
   THEN                                                                 09180000
     IF RCBBJBS2_3.FIX_TIME_COM_3 ¬= RCBBJBS1_2.FIX_TIME_COM_3          09190000
     THEN DO;                                                           09200000
       SWITCH_CHANGED                 = TRUE;                           09210000
       END;                                                             09220000
 IF RCBBJBS2_3.INDNULL(45)            ¬= RCBBJBS1_2.INDNULL(45)         09230000
 THEN                                                                   09240000
     SWITCH_CHANGED                   = TRUE;                           09250000
 ELSE                                                                   09260000
   IF RCBBJBS2_3.INDNULL(45)          = 0                               09270000
   THEN                                                                 09280000
     IF RCBBJBS2_3.TURN_AROUND_QTY_1 ¬= RCBBJBS1_2.TURN_AROUND_QTY_1    09290001
     THEN DO;                                                           09300000
       SWITCH_CHANGED                 = TRUE;                           09310000
       END;                                                             09320000
 IF RCBBJBS2_3.INDNULL(46)            ¬= RCBBJBS1_2.INDNULL(46)         09330000
 THEN                                                                   09340000
     SWITCH_CHANGED                   = TRUE;                           09350000
 ELSE                                                                   09360000
   IF RCBBJBS2_3.INDNULL(46)          = 0                               09370000
   THEN                                                                 09380000
     IF RCBBJBS2_3.TURN_AROUND_UNT_1 ¬= RCBBJBS1_2.TURN_AROUND_UNT_1    09390001
     THEN DO;                                                           09400000
       SWITCH_CHANGED                 = TRUE;                           09410000
       END;                                                             09420000
 IF RCBBJBS2_3.INDNULL(47)            ¬= RCBBJBS1_2.INDNULL(47)         09430000
 THEN                                                                   09440000
     SWITCH_CHANGED                   = TRUE;                           09450000
 ELSE                                                                   09460000
   IF RCBBJBS2_3.INDNULL(47)          = 0                               09470000
   THEN                                                                 09480000
     IF RCBBJBS2_3.TURN_AROUND_COM_1 ¬= RCBBJBS1_2.TURN_AROUND_COM_1    09490001
     THEN DO;                                                           09500000
       SWITCH_CHANGED                 = TRUE;                           09510000
       END;                                                             09520000
 IF RCBBJBS2_3.INDNULL(48)            ¬= RCBBJBS1_2.INDNULL(48)         09530000
 THEN                                                                   09540000
     SWITCH_CHANGED                   = TRUE;                           09550000
 ELSE                                                                   09560000
   IF RCBBJBS2_3.INDNULL(48)          = 0                               09570000
   THEN                                                                 09580000
     IF RCBBJBS2_3.TURN_AROUND_QTY_2 ¬= RCBBJBS1_2.TURN_AROUND_QTY_2    09590001
     THEN DO;                                                           09600000
       SWITCH_CHANGED                 = TRUE;                           09610000
       END;                                                             09620000
 IF RCBBJBS2_3.INDNULL(49)            ¬= RCBBJBS1_2.INDNULL(49)         09630000
 THEN                                                                   09640000
     SWITCH_CHANGED                   = TRUE;                           09650000
 ELSE                                                                   09660000
   IF RCBBJBS2_3.INDNULL(49)          = 0                               09670000
   THEN                                                                 09680000
     IF RCBBJBS2_3.TURN_AROUND_UNT_2 ¬= RCBBJBS1_2.TURN_AROUND_UNT_2    09690001
     THEN DO;                                                           09700000
       SWITCH_CHANGED                 = TRUE;                           09710000
       END;                                                             09720000
 IF RCBBJBS2_3.INDNULL(50)            ¬= RCBBJBS1_2.INDNULL(50)         09730000
 THEN                                                                   09740000
     SWITCH_CHANGED                   = TRUE;                           09750000
 ELSE                                                                   09760000
   IF RCBBJBS2_3.INDNULL(50)          = 0                               09770000
   THEN                                                                 09780000
     IF RCBBJBS2_3.TURN_AROUND_COM_2 ¬= RCBBJBS1_2.TURN_AROUND_COM_2    09790001
     THEN DO;                                                           09800000
       SWITCH_CHANGED                 = TRUE;                           09810000
       END;                                                             09820000
 IF RCBBJBS2_3.INDNULL(51)            ¬= RCBBJBS1_2.INDNULL(51)         09830000
 THEN                                                                   09840000
     SWITCH_CHANGED                   = TRUE;                           09850000
 ELSE                                                                   09860000
   IF RCBBJBS2_3.INDNULL(51)          = 0                               09870000
   THEN                                                                 09880000
     IF RCBBJBS2_3.TURN_AROUND_QTY_3 ¬= RCBBJBS1_2.TURN_AROUND_QTY_3    09890001
     THEN DO;                                                           09900000
       SWITCH_CHANGED                 = TRUE;                           09910000
       END;                                                             09920000
 IF RCBBJBS2_3.INDNULL(52)            ¬= RCBBJBS1_2.INDNULL(52)         09930000
 THEN                                                                   09940000
     SWITCH_CHANGED                   = TRUE;                           09950000
 ELSE                                                                   09960000
   IF RCBBJBS2_3.INDNULL(52)          = 0                               09970000
   THEN                                                                 09980000
     IF RCBBJBS2_3.TURN_AROUND_UNT_3 ¬= RCBBJBS1_2.TURN_AROUND_UNT_3    09990001
     THEN DO;                                                           10000000
       SWITCH_CHANGED                 = TRUE;                           10010000
       END;                                                             10020000
 IF RCBBJBS2_3.INDNULL(53)            ¬= RCBBJBS1_2.INDNULL(53)         10030000
 THEN                                                                   10040000
     SWITCH_CHANGED                   = TRUE;                           10050000
 ELSE                                                                   10060000
   IF RCBBJBS2_3.INDNULL(53)          = 0                               10070000
   THEN                                                                 10080000
     IF RCBBJBS2_3.TURN_AROUND_COM_3 ¬= RCBBJBS1_2.TURN_AROUND_COM_3    10090001
     THEN DO;                                                           10100000
       SWITCH_CHANGED                 = TRUE;                           10110000
       END;                                                             10120000
 IF RCBBJBS2_3.INDNULL(54)            ¬= RCBBJBS1_2.INDNULL(54)         10130000
 THEN                                                                   10140000
     SWITCH_CHANGED                   = TRUE;                           10150000
 ELSE                                                                   10160000
   IF RCBBJBS2_3.INDNULL(54)          = 0                               10170000
   THEN                                                                 10180000
     IF RCBBJBS2_3.PRT_ONS_TIME_QTY_1 ¬= RCBBJBS1_2.PRT_ONS_TIME_QTY_1  10190000
     THEN DO;                                                           10200000
       SWITCH_CHANGED                 = TRUE;                           10210000
       END;                                                             10220000
 IF RCBBJBS2_3.INDNULL(55)            ¬= RCBBJBS1_2.INDNULL(55)         10230000
 THEN                                                                   10240000
     SWITCH_CHANGED                   = TRUE;                           10250000
 ELSE                                                                   10260000
   IF RCBBJBS2_3.INDNULL(55)          = 0                               10270000
   THEN                                                                 10280000
     IF RCBBJBS2_3.PRT_ONS_TIME_UNT_1 ¬= RCBBJBS1_2.PRT_ONS_TIME_UNT_1  10290000
     THEN DO;                                                           10300000
       SWITCH_CHANGED                 = TRUE;                           10310000
       END;                                                             10320000
 IF RCBBJBS2_3.INDNULL(56)            ¬= RCBBJBS1_2.INDNULL(56)         10330000
 THEN                                                                   10340000
     SWITCH_CHANGED                   = TRUE;                           10350000
 ELSE                                                                   10360000
   IF RCBBJBS2_3.INDNULL(56)          = 0                               10370000
   THEN                                                                 10380000
     IF RCBBJBS2_3.PRT_ONS_TIME_COM_1 ¬= RCBBJBS1_2.PRT_ONS_TIME_COM_1  10390000
     THEN DO;                                                           10400000
       SWITCH_CHANGED                 = TRUE;                           10410000
       END;                                                             10420000
 IF RCBBJBS2_3.INDNULL(57)            ¬= RCBBJBS1_2.INDNULL(57)         10430000
 THEN                                                                   10440000
     SWITCH_CHANGED                   = TRUE;                           10450000
 ELSE                                                                   10460000
   IF RCBBJBS2_3.INDNULL(57)          = 0                               10470000
   THEN                                                                 10480000
     IF RCBBJBS2_3.PRT_ONS_TIME_QTY_2 ¬= RCBBJBS1_2.PRT_ONS_TIME_QTY_2  10490000
     THEN DO;                                                           10500000
       SWITCH_CHANGED                 = TRUE;                           10510000
       END;                                                             10520000
 IF RCBBJBS2_3.INDNULL(58)            ¬= RCBBJBS1_2.INDNULL(58)         10530000
 THEN                                                                   10540000
     SWITCH_CHANGED                   = TRUE;                           10550000
 ELSE                                                                   10560000
   IF RCBBJBS2_3.INDNULL(58)          = 0                               10570000
   THEN                                                                 10580000
     IF RCBBJBS2_3.PRT_ONS_TIME_UNT_2 ¬= RCBBJBS1_2.PRT_ONS_TIME_UNT_2  10590000
     THEN DO;                                                           10600000
       SWITCH_CHANGED                 = TRUE;                           10610000
       END;                                                             10620000
 IF RCBBJBS2_3.INDNULL(59)            ¬= RCBBJBS1_2.INDNULL(59)         10630000
 THEN                                                                   10640000
     SWITCH_CHANGED                   = TRUE;                           10650000
 ELSE                                                                   10660000
   IF RCBBJBS2_3.INDNULL(59)          = 0                               10670000
   THEN                                                                 10680000
     IF RCBBJBS2_3.PRT_ONS_TIME_COM_2 ¬= RCBBJBS1_2.PRT_ONS_TIME_COM_2  10690000
     THEN DO;                                                           10700000
       SWITCH_CHANGED                 = TRUE;                           10710000
       END;                                                             10720000
 IF RCBBJBS2_3.INDNULL(60)            ¬= RCBBJBS1_2.INDNULL(60)         10730000
 THEN                                                                   10740000
     SWITCH_CHANGED                   = TRUE;                           10750000
 ELSE                                                                   10760000
   IF RCBBJBS2_3.INDNULL(60)          = 0                               10770000
   THEN                                                                 10780000
     IF RCBBJBS2_3.PRT_ONS_TIME_QTY_3 ¬= RCBBJBS1_2.PRT_ONS_TIME_QTY_3  10790000
     THEN DO;                                                           10800000
       SWITCH_CHANGED                 = TRUE;                           10810000
       END;                                                             10820000
 IF RCBBJBS2_3.INDNULL(61)            ¬= RCBBJBS1_2.INDNULL(61)         10830000
 THEN                                                                   10840000
     SWITCH_CHANGED                   = TRUE;                           10850000
 ELSE                                                                   10860000
   IF RCBBJBS2_3.INDNULL(61)          = 0                               10870000
   THEN                                                                 10880000
     IF RCBBJBS2_3.PRT_ONS_TIME_UNT_3 ¬= RCBBJBS1_2.PRT_ONS_TIME_UNT_3  10890000
     THEN DO;                                                           10900000
       SWITCH_CHANGED                 = TRUE;                           10910000
       END;                                                             10920000
 IF RCBBJBS2_3.INDNULL(62)            ¬= RCBBJBS1_2.INDNULL(62)         10930000
 THEN                                                                   10940000
     SWITCH_CHANGED                   = TRUE;                           10950000
 ELSE                                                                   10960000
   IF RCBBJBS2_3.INDNULL(62)          = 0                               10970000
   THEN                                                                 10980000
     IF RCBBJBS2_3.PRT_ONS_TIME_COM_3 ¬= RCBBJBS1_2.PRT_ONS_TIME_COM_3  10990000
     THEN DO;                                                           11000000
       SWITCH_CHANGED                 = TRUE;                           11010000
       END;                                                             11020000
                                                      /* EOC RA01233 */ 11030000
 IF RCBBJBS2_3.COMMENT_TEXT           ¬= RCBBJBS1_2.COMMENT_TEXT        11040000
 THEN DO;                                                               11050000
   SWITCH_CHANGED                     = TRUE;                           11060000
   END;                                                                 11070000
                                     /* UPDATE ONLY IF CHANGED       */ 11080000
 IF SWITCH_CHANGED                                                      11090000
 THEN DO;                                                               11100000
   COUNT.CNT_CTRY.UPDATES = COUNT.CNT_CTRY.UPDATES + 1;                 11110000
   CALL RCBBJBM_WRITE;                                                  11120000
   END;                                                                 11130000
 ELSE DO;                                                               11140000
   COUNT.CNT_CTRY.MATCHES = COUNT.CNT_CTRY.MATCHES + 1;                 11150000
   END;                                                                 11160000
 END RCBBJBM_UPD;                                                       11170000
1/********************************************************************/ 11180000
 /*                                                                  */ 11190000
 /* MODULE NAME      : RCBBJBM_READ1                                 */ 11200000
 /*                                                                  */ 11210000
 /* DESCRIPTION      : READ UPSTREAM RECORD                          */ 11220000
 /*                                                                  */ 11230000
 /********************************************************************/ 11240000
0RCBBJBM_READ1: PROC;                                                   11250000
                                                                        11260000
0READ FILE (RCBBJA0) INTO (IOAREA_IN_1);                                11270000
0IF SK1.EOF = '0'                                                       11280000
 THEN DO;                                                               11290000
   SK1.REC_TYPE = RCBBJBS1_1.REC_TYPE;                                  11300000
0  IF RCBBJBS1_1.REC_TYPE = '02'                                        11310000
   THEN                                                                 11320000
     DO;                                                                11330000
       SK1.CTRYNO = RCBBJBS1_1.CTRYNO;                                  11340000
       SK1.SERVICE_LVL_CODE     = RCBBJBS1_1.SERVICE_LVL_CODE;          11350000
     END;                                                               11360000
   END;                                                                 11370000
 END RCBBJBM_READ1;                                                     11380000
1/********************************************************************/ 11390000
 /*                                                                  */ 11400000
 /* MODULE NAME      : RCBBJBM_CALC1                                 */ 11410000
 /*                                                                  */ 11420000
 /* DESCRIPTION      : CALC HASH TOTAL AND COUNTS FOR UPSTREAM FILE  */ 11430000
 /*                                                                  */ 11440000
 /********************************************************************/ 11450000
0RCBBJBM_CALC1: PROC;                                                   11460000
                                                                        11470000
 COUNT.CNT_CTRY.RCBBJA0   = COUNT.CNT_CTRY.RCBBJA0 + 1;                 11480000
 WRK_HASH_FIELD           =                                             11490000
 SUBSTR (RCBBJBS1_1.RCB470S.SERVICE_LVL_CODE, 1, 3);                    11500000
                                                                        11510000
 CALL RCB018M (WRK_HASH_FIELD,                                          11520000
               COUNT.HASH_RCBBJA0,                                      11530000
               PTR_INT_AREA);                                           11540000
                                                                        11550000
 END RCBBJBM_CALC1;                                                     11560000
1/********************************************************************/ 11570000
 /*                                                                  */ 11580000
 /* MODULE NAME      : RCBBJBM_READ2                                 */ 11590000
 /*                                                                  */ 11600000
 /* DESCRIPTION      : READ CEDS RECORD AND COUNT HASH TOTAL         */ 11610000
 /*                                                                  */ 11620000
 /********************************************************************/ 11630000
0RCBBJBM_READ2: PROC;                                                   11640000
0READ FILE (RCBBJ11) INTO (IOAREA_IN_2);                                11650000
0IF SK2.EOF = '0'                                                       11660000
 THEN DO;                                                               11670000
   SK2.REC_TYPE = RCBBJBS1_2.REC_TYPE;                                  11680000
   IF RCBBJBS1_2.REC_TYPE = '02'                                        11690000
   THEN                                                                 11700000
     DO;                                                                11710000
       SK2.CTRYNO = RCBBJBS1_2.CTRYNO;                                  11720000
       SK2.SERVICE_LVL_CODE     = RCBBJBS1_2.SERVICE_LVL_CODE;          11730000
     END;                                                               11740000
   END;                                                                 11750000
 END RCBBJBM_READ2;                                                     11760000
1/********************************************************************/ 11770000
 /*                                                                  */ 11780000
 /* MODULE NAME      : RCBBJBM_CALC2                                 */ 11790000
 /*                                                                  */ 11800000
 /* DESCRIPTION      : CALC HASH TOTAL AND COUNTS FOR CEDS FILE      */ 11810000
 /*                                                                  */ 11820000
 /********************************************************************/ 11830000
0RCBBJBM_CALC2: PROC;                                                   11840000
                                                                        11850000
 COUNT.CNT_CTRY.RCBBJ11   = COUNT.CNT_CTRY.RCBBJ11 + 1;                 11860000
 WRK_HASH_FIELD           =                                             11870000
 SUBSTR (RCBBJBS1_2.RCB470S.SERVICE_LVL_CODE, 1, 3);                    11880000
                                                                        11890000
 CALL RCB018M (WRK_HASH_FIELD,                                          11900000
               COUNT.HASH_RCBBJ11,                                      11910000
               PTR_INT_AREA);                                           11920000
                                                                        11930000
0END RCBBJBM_CALC2;                                                     11940000
1/********************************************************************/ 11950000
 /*                                                                  */ 11960000
 /* MODULE NAME      : RCBBJBM_WRITE                                 */ 11970000
 /*                                                                  */ 11980000
 /* DESCRIPTION      : WRITE ACTION RECORD AND COUNT HASH TOTAL      */ 11990000
 /*                                                                  */ 12000000
 /********************************************************************/ 12010000
0RCBBJBM_WRITE: PROC;                                                   12020000
0WRITE FILE (RCBBJC0) FROM (IOAREA_OUT);                                12030000
                                                                        12040000
 IF RCBBJBS2_3.REC_TYPE = '02'                   /* COUNT HASH */       12050000
 THEN                                                                   12060000
   DO;                                                                  12070000
     COUNT.CNT_CTRY.RCBBJC0 = COUNT.CNT_CTRY.RCBBJC0 + 1;               12080000
     WRK_HASH_FIELD =                                                   12090000
     SUBSTR (RCBBJBS2_3.RCB470S.SERVICE_LVL_CODE, 1, 3);                12100000
                                                                        12110000
     CALL RCB018M (WRK_HASH_FIELD,                                      12120000
                   COUNT.HASH_RCBBJC0,                                  12130000
                   PTR_INT_AREA);                                       12140000
   END;                                                                 12150000
 END RCBBJBM_WRITE;                                                     12160000
1/********************************************************************/ 12170000
 /*                                                                  */ 12180000
 /* MODULE NAME      : RCBBJBM_SIC                                   */ 12190000
 /*                                                                  */ 12200000
 /* DESCRIPTION      : SET ITERATION CONDITIONS                      */ 12210000
 /*                                                                  */ 12220000
 /********************************************************************/ 12230000
0RCBBJBM_SIC: PROC;                                                     12240000
0PREV_SSK = SSK;                                                        12250000
0IF STRING (SK1) < STRING (SK2)                                         12260000
 THEN                                                                   12270000
   DO;                                                                  12280000
     SSK = SK1;                                                         12290000
   END;                                                                 12300000
 ELSE                                                                   12310000
   DO;                                                                  12320000
     SSK = SK2;                                                         12330000
   END;                                                                 12340000
 PARM_INT_AREA.SEQUENCE_KEY = STRING(SSK);                /* RC01141 */ 12350000
0END RCBBJBM_SIC;                                                       12360000
1/********************************************************************/ 12370000
 /*                                                                  */ 12380000
 /* MODULE NAME      : RCBBJBM_CHECK_HEADER                          */ 12390000
 /*                                                                  */ 12400000
 /* DESCRIPTION      : CHECK THE HEADERS                             */ 12410000
 /*                    TIMESTAMPS OF BOTH FILE HEADERS ARE SAVED.    */ 12420000
 /*                    SOURCE INDICATOR OF THE UPSTREAM FILE HEADER  */ 12430000
 /*                    IS SAVED.                                     */ 12440000
 /*                                                                  */ 12450000
 /********************************************************************/ 12460000
0RCBBJBM_CHECK_HEADER: PROC;                                            12470000
                                                                        12480000
 CALL RCBBJBM_READ1;                 /* READ UPSTREAM HEADER         */ 12490000
 SELECT;                                                                12500000
                                     /* EMPTY FILE                   */ 12510000
   WHEN (SK1.EOF = '1') DO;                                             12520000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               12530000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             12540000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0013';                           12550000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             12560000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBJA0';                        12570000
     CALL RCB0M1M (PTR_INT_AREA);                                       12580000
                                     /* ABEND                        */ 12590000
     CALL RCBBJBM_ERROR (NULL(),                                        12600000
                         'OTHER',                                       12610000
                         '#009');                                       12620000
     END;                                                               12630000
                                     /* INVALID RECORD TYPE HEADER   */ 12640000
   WHEN (RCBBJBSH_1.REC_TYPE ¬= '01') DO;                               12650000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               12660000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             12670000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0018';                           12680000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             12690000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBJA0';                        12700000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'RT';                             12710000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = RCBBJBSH_1.REC_TYPE;              12720000
     CALL RCB0M1M (PTR_INT_AREA);                                       12730000
                                     /* ABEND                        */ 12740000
     CALL RCBBJBM_ERROR (NULL(),                                        12750000
                         'OTHER',                                       12760000
                         '#010');                                       12770000
     END;                                                               12780000
                                     /* INVALID FILE ID HEADER       */ 12790000
   WHEN (RCBBJBSH_1.FILE_ID ¬= 'RCBBJA0') DO;                           12800000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               12810000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             12820000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0014';                           12830000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             12840000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBJA0';                        12850000
     CALL RCB0M1M (PTR_INT_AREA);                                       12860000
                                     /* ABEND                        */ 12870000
     CALL RCBBJBM_ERROR (NULL(),                                        12880000
                         'OTHER',                                       12890000
                         '#011');                                       12900000
     END;                                                               12910000
   OTHERWISE;                                                           12920000
   END;                                                                 12930000
                                   /* SAVE TIMESTAMP OF UPSTREAM FILE */12940000
 WRK_TIME_STAMP_RCBBJA0 = RCBBJBSH_1.TIMESTAMP;                         12950000
                                   /* SAVE SOURCE_INDICATOR           */12960000
 WRK_SOURCE_INDICATOR   = RCBBJBSH_1.SOURCE_INDICATOR;                  12970000
                                                                        12980000
 CALL RCBBJBM_READ2;                 /* READ CEDS HEADER             */ 12990000
 SELECT;                                                                13000000
                                     /* EMPTY FILE                   */ 13010000
   WHEN (SK2.EOF = '1') DO;                                             13020000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               13030000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             13040000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0013';                           13050000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             13060000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBJ11';                        13070000
     CALL RCB0M1M (PTR_INT_AREA);                                       13080000
                                     /* ABEND                        */ 13090000
     CALL RCBBJBM_ERROR (NULL(),                                        13100000
                         'OTHER',                                       13110000
                         '#012');                                       13120000
     END;                                                               13130000
                                     /* INVALID RECORD TYPE HEADER   */ 13140000
   WHEN (RCBBJBSH_2.REC_TYPE ¬= '01') DO;                               13150000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               13160000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             13170000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0018';                           13180000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             13190000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBJ11';                        13200000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'RT';                             13210000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = RCBBJBSH_2.REC_TYPE;              13220000
     CALL RCB0M1M (PTR_INT_AREA);                                       13230000
                                     /* ABEND                        */ 13240000
     CALL RCBBJBM_ERROR (NULL(),                                        13250000
                         'OTHER',                                       13260000
                         '#013');                                       13270000
     END;                                                               13280000
                                     /* INVALID FILE ID HEADER       */ 13290000
   WHEN (RCBBJBSH_2.FILE_ID  ¬= 'RCBBJ11' ) DO;                         13300000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               13310000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             13320000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0014';                           13330000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             13340000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBJ11';                        13350000
     CALL RCB0M1M (PTR_INT_AREA);                                       13360000
                                     /* ABEND                        */ 13370000
     CALL RCBBJBM_ERROR (NULL(),                                        13380000
                         'OTHER',                                       13390000
                         '#014');                                       13400000
     END;                                                               13410000
   OTHERWISE;                                                           13420000
   END;                                                                 13430000
                                     /* SAVE TIMESTAMP OF CEDS FILE */  13440000
 WRK_TIME_STAMP_RCBBJ11 = RCBBJBSH_2.TIMESTAMP;                         13450000
                                                                        13460000
 END RCBBJBM_CHECK_HEADER;                                              13470000
1/********************************************************************/ 13480000
 /*                                                                  */ 13490000
 /* MODULE NAME      : RCBBJBM_CHECK_HASH                            */ 13500000
 /*                                                                  */ 13510000
 /* DESCRIPTION      : CHECK THAT THE HASH TOTALS FROM PARAMETER     */ 13520000
 /*                    RCB024 MATCH WITH THE CALCULATED HASH TOTALS  */ 13530000
 /*                    FROM THE UPSTREAM AND THE CEDS FILES          */ 13540000
 /*                                                                  */ 13550000
 /********************************************************************/ 13560000
0RCBBJBM_CHECK_HASH: PROC;                                              13570000
 IF COUNT.HASH_RCBBJA0 ¬= RCBP24S_UPSTR.HASH_TOTAL                      13580000
 THEN                                                                   13590000
   DO;                                                                  13600000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             13610000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0175';                           13620000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               13630000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             13640000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_UPSTR;                   13650000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'HT';                             13660000
     CNT_PIC15                      = COUNT.HASH_RCBBJA0;               13670000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;                        13680000
     PARM_INT_AREA.MSG_VAR_CODE_8   = 'HT';                             13690000
     CNT_PIC15                      = RCBP24S_UPSTR.HASH_TOTAL;         13700000
     PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC15;                        13710000
     CALL RCB0M1M (PTR_INT_AREA);                                       13720000
     CALL RCBBJBM_ERROR (NULL(),                                        13730000
                         'OTHER',                                       13740000
                         '#015');                                       13750000
   END;                                                                 13760000
                                                                        13770000
 IF COUNT.HASH_RCBBJ11 ¬= RCBP24S_CEDS.HASH_TOTAL                       13780000
 THEN                                                                   13790000
   DO;                                                                  13800000
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             13810000
     PARM_INT_AREA.MESSAGE_NUMBER   = '0175';                           13820000
     PARM_INT_AREA.MSG_VAR_CODES    = '';                               13830000
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             13840000
     PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_CEDS;                    13850000
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'HT';                             13860000
     CNT_PIC15                      = COUNT.HASH_RCBBJ11;               13870000
     PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;                        13880000
     PARM_INT_AREA.MSG_VAR_CODE_8   = 'HT';                             13890000
     CNT_PIC15                      = RCBP24S_CEDS.HASH_TOTAL;          13900000
     PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC15;                        13910000
     CALL RCB0M1M (PTR_INT_AREA);                                       13920000
     CALL RCBBJBM_ERROR (NULL(),                                        13930000
                         'OTHER',                                       13940000
                         '#016');                                       13950000
   END;                                                                 13960000
0END RCBBJBM_CHECK_HASH;                                                13970000
1/********************************************************************/ 13980000
 /*                                                                  */ 13990000
 /* MODULE NAME      : RCBBJBM_CHECK_TRAILERS                        */ 14000000
 /*                                                                  */ 14010000
 /* DESCRIPTION      : CHECK THE TRAILERS                            */ 14020000
 /*                                                                  */ 14030000
 /********************************************************************/ 14040000
0RCBBJBM_CHECK_TRAILERS: PROC;                                          14050000
                                                                        14060000
 IF SK1.EOF = '1'                                                       14070000
 THEN DO;                            /* NO TRAILER RECORD            */ 14080000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 14090000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               14100000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0017';                             14110000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               14120000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'UPSTREAM FILE RCBBJA0';            14130000
   CALL RCB0M1M (PTR_INT_AREA);                                         14140000
   CALL RCBBJBM_ERROR (NULL(),                                          14150000
                      'OTHER',                                          14160000
                      '#017');                                          14170000
   END;                                                                 14180000
                                                                        14190000
 IF RCBBJBST_1.CNT_RECS ¬= COUNT.CNT_TOT.RCBBJA0                        14200000
 THEN DO;                          /* INVALID COUNT TRAILER        */   14210000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 14220000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               14230000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0007';                             14240000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               14250000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'UPSTREAM FILE RCBBJA0';            14260000
   PARM_INT_AREA.MSG_VAR_CODE_7   = 'C7';                               14270000
   PARM_INT_AREA.MSG_VAR_VALUE_7  = COUNT.CNT_TOT.RCBBJA0;              14280000
   PARM_INT_AREA.MSG_VAR_CODE_8   = 'C8';                               14290000
   PARM_INT_AREA.MSG_VAR_VALUE_8  = RCBBJBST_1.CNT_RECS;                14300000
   CALL RCB0M1M (PTR_INT_AREA);                                         14310000
   CALL RCBBJBM_ERROR (NULL(),                                          14320000
                      'OTHER',                                          14330000
                      '#018');                                          14340000
   END;                                                                 14350000
                                                                        14360000
 CALL RCBBJBM_READ1;                 /* CHECK RECORDS AFTER TRAILER  */ 14370000
 IF SK1.EOF = '0'                                                       14380000
 THEN DO;                          /* RECORDS AFTER TRAILER        */   14390000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 14400000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               14410000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0015';                             14420000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               14430000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'UPSTREAM FILE RCBBJA0';            14440000
   CALL RCB0M1M (PTR_INT_AREA);                                         14450000
   CALL RCBBJBM_ERROR (NULL(),                                          14460000
                      'OTHER',                                          14470000
                      '#019');                                          14480000
   END;                                                                 14490000
                                                                        14500000
 IF SK2.EOF = '1'                                                       14510000
 THEN DO;                            /* NO TRAILER RECORD            */ 14520000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 14530000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               14540000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0017';                             14550000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               14560000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'CEDS FILE RCBBJ11';                14570000
   CALL RCB0M1M (PTR_INT_AREA);                                         14580000
   CALL RCBBJBM_ERROR (NULL(),                                          14590000
                      'OTHER',                                          14600000
                      '#020');                                          14610000
   END;                                                                 14620000
                                                                        14630000
 IF RCBBJBST_2.CNT_RECS ¬= COUNT.CNT_TOT.RCBBJ11                        14640000
 THEN DO;                          /* INVALID COUNT TRAILER        */   14650000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 14660000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               14670000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0007';                             14680000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               14690000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'CEDS FILE RCBBJ11';                14700000
   PARM_INT_AREA.MSG_VAR_CODE_7   = 'C7';                               14710000
   PARM_INT_AREA.MSG_VAR_VALUE_7  = COUNT.CNT_CTRY.RCBBJ11;             14720000
   PARM_INT_AREA.MSG_VAR_CODE_8   = 'C8';                               14730000
   PARM_INT_AREA.MSG_VAR_VALUE_8  = RCBBJBST_2.CNT_RECS;                14740000
   CALL RCB0M1M (PTR_INT_AREA);                                         14750000
   CALL RCBBJBM_ERROR (NULL(),                                          14760000
                      'OTHER',                                          14770000
                      '#021');                                          14780000
   END;                                                                 14790000
                                                                        14800000
 CALL RCBBJBM_READ2;                 /* CHECK RECORDS AFTER TRAILER  */ 14810000
 IF SK2.EOF = '0'                                                       14820000
 THEN DO;                          /* RECORDS AFTER TRAILER        */   14830000
   PARM_INT_AREA.MSG_VAR_CODES    = '';                                 14840000
   PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                               14850000
   PARM_INT_AREA.MESSAGE_NUMBER   = '0015';                             14860000
   PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                               14870000
   PARM_INT_AREA.MSG_VAR_VALUE_6  = 'CEDS FILE RCBBJ11';                14880000
   CALL RCB0M1M (PTR_INT_AREA);                                         14890000
   CALL RCBBJBM_ERROR (NULL(),                                          14900000
                      'OTHER',                                          14910000
                      '#022');                                          14920000
   END;                                                                 14930000
                                                                        14940000
 END RCBBJBM_CHECK_TRAILERS;                                            14950000
1/********************************************************************/ 14960000
 /*                                                                  */ 14970000
 /* MODULE NAME      : RCBBJBM_FILL_HEADER                           */ 14980000
 /*                                                                  */ 14990000
 /* DESCRIPTION      : FILL THE HEADER OF THE ACTION FILE            */ 15000000
 /*                                                                  */ 15010000
 /********************************************************************/ 15020000
0RCBBJBM_FILL_HEADER: PROC;                                             15030000
0IOAREA_OUT                   = '';                                     15040000
 RCBBJBSH_3.REC_TYPE          = '01';                                   15050000
 RCBBJBSH_3.FILE_ID           = 'RCBBJC0';                              15060000
 RCBBJBSH_3.SOURCE_INDICATOR  = WRK_SOURCE_INDICATOR;                   15070000
 RCBBJBSH_3.TIMESTAMP         = WRK_DATE_TIME;                          15080000
 CALL RCBBJBM_WRITE;                                                    15090000
 END RCBBJBM_FILL_HEADER;                                               15100000
1/********************************************************************/ 15110000
 /*                                                                  */ 15120000
 /* MODULE NAME      : RCBBJBM_FILL_TRAILERS                         */ 15130000
 /*                                                                  */ 15140000
 /* DESCRIPTION      : FILL THE TRAILER                              */ 15150000
 /*                                                                  */ 15160000
 /********************************************************************/ 15170000
0RCBBJBM_FILL_TRAILERS: PROC;                                           15180000
0IOAREA_OUT          = '';                                              15190000
 RCBBJBST_3.REC_TYPE = '99';                                            15200000
 RCBBJBST_3.CNT_RECS = COUNT.CNT_TOT.RCBBJC0;                           15210000
 CALL RCBBJBM_WRITE;                                                    15220000
 END RCBBJBM_FILL_TRAILERS;                                             15230000
1/********************************************************************/ 15240000
 /*                                                                  */ 15250000
 /* MODULE NAME      : RCBBJBM_SAVE_HASH                             */ 15260000
 /*                                                                  */ 15270000
 /* DESCRIPTION      : SAVE HASH TOTAL INFORMATION ON PARAMETER.     */ 15280000
 /*                    IF THE PARAMETER DOES NOT YET EXIST, IT WILL  */ 15290000
 /*                    BE INSERTED.                                  */ 15300000
 /*                                                                  */ 15310000
 /*                    ISSUE MESSAGE 0173                            */ 15320000
 /*                                                                  */ 15330000
 /********************************************************************/ 15340000
0 RCBBJBM_SAVE_HASH : PROC;                                             15350000
                                     /* INIT TABLESTRUCTURE          */ 15360000
 TB_RCBV500                  = '';                                      15370000
 TB_RCBV500_I                = '';                                      15380000
 TB_RCBP24S.NUMBER           = 'RCB024';                                15390000
 TB_RCBP24S.PROC_ID          = RCBPROC_REC.PROC_ID;                     15400000
 TB_RCBP24S.CTRYNO           = PREV_SSK.CTRYNO;                         15410000
 TB_RCBP24S.FILE_NAME        = WRK_FILE_ACT;                            15420000
 TB_RCBP24S.SEQ_NUMBER       = '01';                                    15430000
 TB_RCBP24S.TIME_STAMP       = WRK_DATE_TIME;                           15440000
 TB_RCBP24S.HASH_TOTAL       = COUNT.HASH_RCBBJC0;                      15450000
 TB_RCBP24S.LENGTH_PARM      = WRK_LENGTH_RCB024;                       15460000
                                                                        15470000
0CALL RCBG50M (ADDR(TB_RCBV500),    /* UPDATE PARAMETER RCB024    */    15480000
               ADDR(TB_RCBV500_I),                                      15490000
               PTR_RET_AREA_BB,                                         15500000
               PTR_INT_AREA);                                           15510000
0SELECT(PARM_RET_AREA_BB.RETURN_CODE);                                  15520000
   WHEN (0);                                                            15530000
   WHEN (4)                          /* WHEN NOT FOUND THEN INSERT  */  15540000
     DO;                                                                15550000
       CALL RCBF50M (ADDR(TB_RCBV500),                                  15560000
                     ADDR(TB_RCBV500_I),                                15570000
                     PTR_RET_AREA_BB,                                   15580000
                     PTR_INT_AREA);                                     15590000
       SELECT(PARM_RET_AREA_BB.RETURN_CODE);                            15600000
         WHEN (0);                                                      15610000
         OTHERWISE                                                      15620000
           DO;                                                          15630000
             CALL RCBBJBM_ERROR (ADDR (PARM_RET_AREA_BB.RETURN_SQL),    15640000
                                 'DB2',                                 15650000
                                 '#023');                               15660000
           END;                                                         15670000
       END;                                                             15680000
     END;                                                               15690000
   OTHERWISE                                                            15700000
      DO;                                                               15710000
        CALL RCBBJBM_ERROR (ADDR (PARM_RET_AREA_BB.RETURN_SQL),         15720000
                            'DB2',                                      15730000
                            '#024');                                    15740000
      END;                                                              15750000
 END;                                                                   15760000
                                                                        15770000
 PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 15780000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0173';                               15790000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   15800000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 15810000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = WRK_FILE_ACT;                         15820000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'TP';                                 15830000
 PARM_INT_AREA.MSG_VAR_VALUE_7  = WRK_DATE_TIME;                        15840000
 PARM_INT_AREA.MSG_VAR_CODE_8   = 'HT';                                 15850000
 CNT_PIC15                      = COUNT.HASH_RCBBJC0;                   15860000
 PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC15;                            15870000
 CALL RCB0M1M (PTR_INT_AREA);                                           15880000
                                                                        15890000
0END RCBBJBM_SAVE_HASH;                                                 15900000
1/********************************************************************/ 15910000
 /*                                                                  */ 15920000
 /* MODULE NAME      : RCBBJBM_END_COUNTRY                           */ 15930000
 /*                                                                  */ 15940000
 /* DESCRIPTION      : ENDING ACTIONS FOR A COUNTRY                  */ 15950000
 /*                                                                  */ 15960000
 /********************************************************************/ 15970000
0RCBBJBM_END_COUNTRY: PROC;                                             15980000
                                      /* ADD COUNTRY COUNTS TO TOTAL */ 15990000
                                                                        16000000
 COUNT.CNT_TOT.RCBBJA0   =  COUNT.CNT_TOT.RCBBJA0                       16010000
                              + COUNT.CNT_CTRY.RCBBJA0;                 16020000
 COUNT.CNT_TOT.RCBBJ11   =  COUNT.CNT_TOT.RCBBJ11                       16030000
                              + COUNT.CNT_CTRY.RCBBJ11;                 16040000
 COUNT.CNT_TOT.RCBBJC0   =  COUNT.CNT_TOT.RCBBJC0                       16050000
                              + COUNT.CNT_CTRY.RCBBJC0;                 16060000
 COUNT.CNT_TOT.INSERTS   =  COUNT.CNT_TOT.INSERTS                       16070000
                              + COUNT.CNT_CTRY.INSERTS;                 16080000
 COUNT.CNT_TOT.UPDATES   =  COUNT.CNT_TOT.UPDATES                       16090000
                              + COUNT.CNT_CTRY.UPDATES;                 16100000
 COUNT.CNT_TOT.DELETES   =  COUNT.CNT_TOT.DELETES                       16110000
                              + COUNT.CNT_CTRY.DELETES;                 16120000
 COUNT.CNT_TOT.MATCHES   =  COUNT.CNT_TOT.MATCHES                       16130000
                              + COUNT.CNT_CTRY.MATCHES;                 16140000
 COUNT.CNT_TOT.SKIPPED   =  COUNT.CNT_TOT.SKIPPED                       16150000
                              + COUNT.CNT_CTRY.SKIPPED;                 16160000
                                                                        16170000
 /* PTM1248: REMOVE INPUT AND OUTPUT COUNT MESSAGES FOR EACH         */ 16180000
 /* COUNTRY                                                          */ 16190000
                                                                        16200000
 CALL RCBBJBM_CHECK_HASH;  /* CHECK HASH OF UPSTREAM AND CEDS FILE */   16210000
 CALL RCBBJBM_SAVE_HASH;   /* SAVE  HASH OF ACTION FILE IN RCB024  */   16220000
                                                                        16230000
0END RCBBJBM_END_COUNTRY;                                               16240000
1/********************************************************************/ 16250000
 /*                                                                  */ 16260000
 /* MODULE NAME      : RCBBJBM_TERM                                  */ 16270000
 /*                                                                  */ 16280000
 /* DESCRIPTION      : TERMINATE PROGRAM                             */ 16290000
 /*                                                                  */ 16300000
 /********************************************************************/ 16310000
0RCBBJBM_TERM: PROC;                                                    16320000
0PARM_INT_AREA.COUNTRY_NUMBER   = '';                                   16330000
                                                                        16340000
0CALL RCBBJBM_CHECK_TRAILERS;                                           16350000
 CALL RCBBJBM_FILL_TRAILERS;                                            16360000
                                                                        16370000
 PARM_INT_AREA.MESSAGE_TYPE     = 'IS';      /* ISSUE COUNT MESSAGES */ 16380000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0003';                               16390000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   16400000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 16410000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBJA0';                            16420000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C1';                                 16430000
                                                       /*SOC RB01299*/  16431003
 /*CNT_PIC9                       = COUNT.CNT_TOT.RCBBJA0; */           16440003
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9; */                        16450003
 CNT_PIC15                      = COUNT.CNT_TOT.RCBBJA0;                16451003
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;                            16452003
                                                       /*EOC RB01299*/  16453003
 CALL RCB0M1M (PTR_INT_AREA);                                           16460000
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 16470000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0003';                               16480000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   16490000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 16500000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBJ11';                            16510000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C1';                                 16520000
                                                       /*SOC RB01299*/  16521004
 /*CNT_PIC9                       = COUNT.CNT_TOT.RCBBJ11;          */  16530004
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                       */  16540004
 CNT_PIC15                      = COUNT.CNT_TOT.RCBBJ11;                16540104
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;                            16540204
                                                       /*EOC RB01299*/  16541004
 CALL RCB0M1M (PTR_INT_AREA);                                           16550000
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 16560000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0004';                               16570000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   16580000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                                 16590000
 PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBJC0';                            16600000
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'C6';                                 16610000
                                                       /*SOC RB01299*/  16611003
 /*CNT_PIC9                       = COUNT.CNT_TOT.RCBBJC0;          */  16620003
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                       */  16630003
 CNT_PIC15                      = COUNT.CNT_TOT.RCBBJC0;                16631003
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;                            16632003
                                                       /*EOC RB01299*/  16633003
 CALL RCB0M1M (PTR_INT_AREA);                                           16640000
0PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                                 16650000
 PARM_INT_AREA.MESSAGE_NUMBER   = '0158';                               16660000
 PARM_INT_AREA.MSG_VAR_CODES    = '';                                   16670000
 PARM_INT_AREA.MSG_VAR_CODE_6   = 'IN';                                 16680000
                                                       /*SOC RB01299*/  16681003
 /*CNT_PIC9                       = COUNT.CNT_TOT.INSERTS;           */ 16690003
 /*PARM_INT_AREA.MSG_VAR_VALUE_6  = CNT_PIC9;                        */ 16700003
 CNT_PIC15                      = COUNT.CNT_TOT.INSERTS;                16700105
 PARM_INT_AREA.MSG_VAR_VALUE_6  = CNT_PIC15;                            16700205
                                                       /*EOC RB01299*/  16701005
 PARM_INT_AREA.MSG_VAR_CODE_7   = 'UP';                                 16710005
                                                       /*SOC RB01299*/  16711005
 /*CNT_PIC9                       = COUNT.CNT_TOT.UPDATES;           */ 16720003
 /*PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC9;                        */ 16730003
 CNT_PIC15                      = COUNT.CNT_TOT.UPDATES;                16730105
 PARM_INT_AREA.MSG_VAR_VALUE_7  = CNT_PIC15;                            16730205
                                                       /*EOC RB01299*/  16731005
 PARM_INT_AREA.MSG_VAR_CODE_8   = 'DL';                                 16740005
                                                       /*SOC RB01299*/  16741005
 /*CNT_PIC9                       = COUNT.CNT_TOT.DELETES;           */ 16750003
 /*PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC9;                        */ 16760003
 CNT_PIC15                      = COUNT.CNT_TOT.DELETES;                16760105
 PARM_INT_AREA.MSG_VAR_VALUE_8  = CNT_PIC15;                            16760205
                                                       /*EOC RB01299*/  16761005
 PARM_INT_AREA.MSG_VAR_CODE_9   = 'EQ';                                 16770005
                                                       /*SOC RB01299*/  16771005
 /*CNT_PIC9                       = COUNT.CNT_TOT.MATCHES;           */ 16780003
 /*PARM_INT_AREA.MSG_VAR_VALUE_9  = CNT_PIC9;                        */ 16790003
 CNT_PIC15                      = COUNT.CNT_TOT.MATCHES;                16790105
 PARM_INT_AREA.MSG_VAR_VALUE_9  = CNT_PIC15;                            16790205
                                                       /*EOC RB01299*/  16791005
 PARM_INT_AREA.MSG_VAR_CODE_10  = 'SD';                                 16800005
                                                       /*SOC RB01299*/  16801005
 /*CNT_PIC9                       = COUNT.CNT_TOT.SKIPPED;           */ 16810003
 /*PARM_INT_AREA.MSG_VAR_VALUE_10 = CNT_PIC9;                        */ 16820003
 CNT_PIC15                      = COUNT.CNT_TOT.SKIPPED;                16829403
 PARM_INT_AREA.MSG_VAR_VALUE_10 = CNT_PIC15;                            16829503
                                                       /*EOC RB01299*/  16829603
 CALL RCB0M1M (PTR_INT_AREA);                                           16830000
                                     /* CLOSE ALL FILES              */ 16840000
 CLOSE FILE (RCBBJA0);                                                  16850000
 CLOSE FILE (RCBBJ11);                                                  16860000
 CLOSE FILE (RCBBJC0);                                                  16870000
 CLOSE FILE (RCBPROC);                                                  16880000
                                     /* ISSUE END MESSAGE            */ 16890000
 PARM_INT_AREA.MSG_AREA.MESSAGE_TYPE     = 'IS';                        16900000
 PARM_INT_AREA.MSG_AREA.MESSAGE_NUMBER   = '9999';                      16910000
 PARM_INT_AREA.MSG_AREA.MSG_VAR_CODES    = ' ';                         16920000
 CALL RCB0M1M (PTR_INT_AREA);                                           16930000
                                     /* CLOSE MESSAGE FILE           */ 16940000
 PARM_INT_AREA.MSG_REQUEST    = 'C';                                    16950000
 CALL RCB0M1M (PTR_INT_AREA);                                           16960000
 END RCBBJBM_TERM;                                                      16970000
1/********************************************************************/ 16980000
 /*                                                                  */ 16990000
 /* MODULE NAME      : RCBBJBM_ERROR                                 */ 17000000
 /*                                                                  */ 17010000
 /* DESCRIPTION      : CALLS THE COMMON ERROR ROUTINE AFTER FILLING  */ 17020000
 /*                    THE INPUT VARIABLES                           */ 17030000
 /*                                                                  */ 17040000
 /********************************************************************/ 17050000
0 RCBBJBM_ERROR: PROC (PTR_ERROR,                                       17060000
                       ERR_TYPE,                                        17070000
                       CALL_ID);                                        17080000
0DCL PTR_ERROR    PTR;                                                  17090000
 DCL ERR_TYPE     CHAR(8);                                              17100000
 DCL CALL_ID      CHAR(4);                                              17110000
0PARM_INT_AREA.PTR_ERROR         = PTR_ERROR;                           17120000
 PARM_INT_AREA.ERR_TYPE          = ERR_TYPE;                            17130000
 PARM_INT_AREA.CALL_ID           = CALL_ID;                             17140000
0CALL RCB0E1M (PTR_INT_AREA);                                           17150000
0END RCBBJBM_ERROR;                                                     17160000
1/********************************************************************/ 17170000
 /* DO NOT CHANGE THIS PART, IT IS MEANT FOR ABR                     */ 17180000
 /********************************************************************/ 17190000
0%INCLUDE DAIFPLH ;                    /* COMPILE DATE/TIME STAMP    */ 17200000
 $DAIMOD (RCBBJBM);                    /* MODULE TO BE COMPILED      */ 17210000
0/********************************************************************/ 17220000
 /* END OF ABR BLOCK                                                 */ 17230000
 /********************************************************************/ 17240000
 END RCBBJBM;                                                           17250000