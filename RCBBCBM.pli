 /* RCBBCBM - VALIDATING INPUT FILE                                  */ 00010035
 /*                                                                  */ 00020035
 /* 5695-153 (C) COPYRIGHT IBM EMEA WORLD TRADE CORPORATION 1991     */ 00030035
 /* LICENSED MATERIAL - PROGRAM PROPERTY OF IBM                      */ 00040035
 /* REFER TO COPYRIGHT INSTRUCTIONS: FORM G120-2083                  */ 00050035
 /*                                                                  */ 00060035
 /********************************************************************/ 00070035
 /* PROGRAM          : RCBBCBM                                       */ 00080035
 /*                                                                  */ 00090035
 /* LANGUAGE         : PLI                                           */ 00100035
 /*                                                                  */ 00110035
 /* GENERATED BY     : RCBBCBP  - GENERATE COMPARE PROGRAM           */ 00120035
 /*                                                                  */ 00130035
 /* TYPE             : BATCH                                         */ 00140035
 /*                                                                  */ 00150035
 /* DESCRIPTION      : VALIDATING THE INPUT FILE.                    */ 00160035
 /*                    THIS INPUT FILE CONTAINS HEADER, DATA AND     */ 00170035
 /*                    TRAILER. ONLY HEADER AND TRAILER ARE          */ 00180035
 /*                    VALIDATED.                                    */ 00190035
 /*                    IT CONSISTS OF ONE OR MORE LOGICAL FILES.     */ 00200035
 /*                                                                  */ 00210035
 /* INPUT            : - FILES : UPSTREAM RCBBCB0                    */ 00220035
 /*                      DB2 - RCBT0500_PARM                         */ 00230035
 /*                                                                  */ 00240035
 /* OUTPUT           : - FILES : REPORT   REPORT                     */ 00250035
 /*                                                                  */ 00260035
 /* EXTERNAL MODULES : - RCB0M1M   MESSAGE MODULE                    */ 00270035
 /*                    - RCB0E1M   ERROR MODULE                      */ 00280035
 /*                    - RCB0T1M   RETRIEVE SYSTEM DATE              */ 00290035
 /*                    - RCBF50M   INSERT    PARAMETER               */ 00300035
 /*                    - RCBG50M   UPDATE    PARAMETER               */ 00310035
 /*                    - RCBI50M   REFERENCE PARAMETER               */ 00320035
 /*                                                                  */ 00330035
 /* MESSAGES         : 0013,0016,I050,9999                           */ 00340035
 /*                                                                  */ 00350035
 /* THE FOLLOWING EXCEPTION ROUTINES HAVE BEEN APPLIED DURING        */ 00360035
 /* GENERATION :  0                                                  */ 00370035
 /*                                                                  */ 00380035
 /* MAINTENANCE LOG  :                                               */ 00390035
 /* ---------------                                                  */ 00400035
 /*                                                                  */ 00410035
 /* DATE       | WORK-ITEMNO. | DESCRIPTION                          */ 00420035
 /* ---------------------------------------------------------------- */ 00430035
 /* 2011-06-20 | RC01314      | SOF AND WTAAS REALIGNMENT FOR        */ 00440035
 /*            |              | BH SOURCE                            */ 00450035
 /* 2011-09-06 | CEDS00000563 | ADJUST VARIABLE LENGTH QUALIFIERS    */ 00460035
 /*            |              | IN FILE NAMING  FOR ALL GEOS IN      */ 00470035
 /*            |              | GENERAL                              */ 00480035
 /* 2011-11-03 | CEDS00000566 | PASSING VALUES TO DESCRITION COLUMN  */ 00481044
 /*            |              | IN PARAMETER TABLE FOR PARAMETER     */ 00482044
 /*            |              | RCB110                               */ 00483044
 /* 2012-01-17 | CEDS00000573 | INVALID VB LENGTH FILE - CHANGING    */ 00484053
 /*            |              | SPACE PARAMETER VALUES               */ 00485053
 /* 2012-10-01 | CEDS00000598 | MODIFIED THE BLOCK SIZE OF THE       */ 00486058
 /*            |              | OUTPUT FILES                         */ 00487058
 /* 2012-10-11 | CEDS00000601 | SPACE AND TEMP FILE DELETE ISSUE IN  */ 00488082
 /*            |              | US06/US07                            */ 00489082
 /********************************************************************/ 00490035
1RCBBCBM: PROC                                                          00500043
          OPTIONS (MAIN)                                                00510035
          REORDER;                                                      00520035
                                                                        00530035
0/********************************************************************/ 00540035
 /* FILE DECLARATIONS                                                */ 00550035
 /********************************************************************/ 00560035
0DCL RCBBCB0        FILE             /* UPSTREAM INPUT FILE          */ 00570041
                    RECORD                                              00580035
                    INPUT                                               00590035
                    SEQUENTIAL                                          00600035
                                              /* SOC CEDS00000566    */ 00601044
 /*                 ENV (V  RECSIZE(27994));                         */ 00610041
                                              /* SOC CEDS00000598    */ 00610158
 /*                 ENV (V  RECSIZE(29996));                         */ 00610254
                    ENV (V  RECSIZE(26957));                            00610456
                                              /* EOC CEDS00000598    */ 00611158
                                              /* EOC CEDS00000566    */ 00612056
0DCL RCBBC21        FILE             /* INPUT PARM FILE              */ 00620035
                    RECORD                                              00630035
                    INPUT                                               00640035
                    SEQUENTIAL                                          00650035
 /*                 ENV (FB RECSIZE(15));       /* SOC CEDS00000563  */ 00660035
                    ENV (FB RECSIZE(20));       /* EOC CEDS00000563  */ 00670035
 DCL REPORT         FILE             /* REPORT FILE                  */ 00680035
                    RECORD                                              00690035
                    OUTPUT                                              00700035
                    SEQUENTIAL                                          00710035
                    ENV (FB,RECSIZE(80),CTLASA);                        00720035
                                                                        00730035
 /********************************************************************/ 00743035
 /* EXTERNAL ENTRIES                                                 */ 00750035
 /*******************************************************************/  00760035
 DCL RCB0E1M    ENTRY EXTERNAL;        /* COMMON ERROR ROUTINE      */  00770035
 DCL RCB0M1M    ENTRY EXTERNAL;        /* COMMON MESSAGE ROUTINE    */  00780035
 DCL RCB0T1M    ENTRY EXTERNAL;        /* COMMON MESSAGE ROUTINE    */  00790035
 DCL RCBI50M    ENTRY EXTERNAL;        /* RETRIEVE CYCLE NUMBER     */  00800035
 DCL RCBG50M    ENTRY EXTERNAL;        /* UPDATE CYCLE NUMBER       */  00810035
                                                                        00820035
1/*******************************************************************/  00830035
 /* EXTERNAL PARAMETER INTERFACES                                   */  00840035
 /********************************************************************/ 00850035
 DCL PTR_DATE_AREA        PTR;         /* RCB004M DATE CHECK         */ 00860035
 DCL PTR_INT_AREA         PTR;                                          00870035
 DCL PTR_RETURN_AREA      PTR;                                          00880035
 DCL PTR_RUN_DATE_AREA    PTR;                                          00890035
 DCL RETCODE              FIXED BIN(31);                                00900035
 DCL PAGENO               PIC 'ZZZ9';                                   00910035
                                                                        00920035
 DCL 1 DATE_AREA,                      /* DATE AREA                  */ 00930035
       %INCLUDE (RCBZ03S);;                                             00940035
 DCL 1 PARM_INT_AREA,                  /* INTERFACE AREA             */ 00950035
       %INCLUDE (RCBZ01S);;                                             00960035
 DCL 1 RETURN_AREA,                    /* RETURN AREA                */ 00970035
       %INCLUDE (RCBZ02S);;                                             00980035
1/********************************************************************/ 00990035
 /* DB2 TABLE STRUCTURES                                             */ 01000035
 /********************************************************************/ 01010035
                                                                        01020035
 DCL PTR_RCBV500    PTR;               /* PTR PARAMETER ROW          */ 01030035
 DCL PTR_RCBV500I   PTR;               /* PTR NULL-IND. PARAMETER    */ 01040035
 DCL 1 TB_RCBV500,                     /* PARAMETER ROW              */ 01050035
       %INCLUDE (RCB500S);;                                             01060035
 DCL 1 TB_RCBV500_I,                   /* NULL-IND. PARAMETER        */ 01070035
       %INCLUDE (RCB500SI);;                                            01080035
0DCL 1 TB_RCB110        BASED(PTR_RCBV500),           /*CYCLE NUMBER */ 01090035
       %INCLUDE (RCBP110S);;                                            01100035
0DCL 1 RCB110,                                                          01110035
       %INCLUDE (RCBP110S);;                                            01120035
0DCL 1 TB_RCB156        BASED(PTR_RCBV500),           /* SOC PCR66   */ 01130035
       %INCLUDE (RCBP156S);;                                            01140035
0DCL 1 RCB156,                                                          01150035
       %INCLUDE (RCBP156S);;                          /* EOC PCR66   */ 01160035
                                                                        01170035
 /*-----------------------------------------------------------------*/  01180035
 /*EXEC SQL INCLUDE SQLCA;*/                                            01190035
                                                                        01200035
1/********************************************************************/ 01210035
 /* RECORD STRUCTURES FOR INPUT AND OUTPUT FILES                     */ 01220035
 /********************************************************************/ 01230035
 /*                                                 SOC CEDS00000598    01231058
 DCL FILE_RCBTY        CHAR(27995);*//* HEADER TRAILER INFORMATION   */ 01240056
 /*                                                 SOC CEDS00000601    01240182
 DCL FILE_RCBTY        CHAR(26957);*//* HEADER TRAILER INFORMATION */   01241081
 DCL FILE_RCBTY        CHAR(26953);   /* HEADER TRAILER INFORMATION */  01241181
                                                 /* EOC CEDS00000598 */ 01242058
 /*                                                                     01243081
 DCL FILE_RCBTY_DESC   CHAR(27994);*//* HEADER TRAILER INFORMATION   */ 01250081
 DCL FILE_RCBTY_DESC   CHAR(26953);  /* HEADER TRAILER INFORMATION   */ 01251081
 /*                                                 EOC CEDS00000601 */ 01252082
                                     /* SOC CEDS00000563             */ 01260035
 /*DCL FILE_RCBBC21      CHAR(15);   /* PARM INPUT FILE              */ 01270035
 DCL FILE_RCBBC21      CHAR(20);     /* EOC CEDS00000563             */ 01280035
                                     /* SOC CEDS00000566             */ 01290044
 /*DCL FILE_RCBBCB0      CHAR(27994);/* INPUT FILE                   */ 01292041
 /*                                                 SOC CEDS00000598    01292358
 DCL FILE_RCBBCB0      CHAR(29996);*//* INPUT FILE                   */ 01293056
                                     /* EOC CEDS00000566             */ 01293158
                                                 /* SOC CEDS00000601 */ 01293282
 /*DCL FILE_RCBBCB0    CHAR(26957);*//* INPUT FILE                   */ 01293381
 DCL FILE_RCBBCB0      CHAR(26953);  /* INPUT FILE                   */ 01293481
                                                 /* EOC CEDS00000598 */ 01294158
                                                 /* EOC CEDS00000601 */ 01294282
 DCL 1 RCBBCB0_HEADER  BASED(ADDR(FILE_RCBBCB0)),                       01300035
      %INCLUDE RCBBCBSH;;            /* HEADER RECORD                */ 01310035
 DCL 1 RCBBCB0_TRAILER BASED(ADDR(FILE_RCBBCB0)),                       01320035
      %INCLUDE RCBBCBST;;            /* TRAILER RECORD               */ 01330035
                                                                        01340035
 DCL 1 RCBBCB0_TYPE_DI BASED(ADDR(FILE_RCBBCB0)),    /* SOC PCR66    */ 01350035
       %INCLUDE (RCBBCAS1);,                                            01360035
       %INCLUDE (RRDDI1);                                               01370035
 DCL 1 RCBBCB0_TYPE_DO BASED(ADDR(FILE_RCBBCB0)),                       01380035
       %INCLUDE (RCBBCAS1);,                                            01390035
       %INCLUDE (RRDDO1);                                               01400035
 DCL 1 RCBBCB0_TYPE_DC BASED(ADDR(FILE_RCBBCB0)),                       01410035
       %INCLUDE (RCBBCAS1);,                                            01420035
       %INCLUDE (RRDDC1);                                               01430035
 DCL 1 RCBBCB0_TYPE_DF BASED(ADDR(FILE_RCBBCB0)),                       01440035
       %INCLUDE (RCBBCAS1);,                                            01450035
       %INCLUDE (RRDDF1);                                               01460035
                                                                        01470035
 DCL 1 MAPPING_TYPE_DI,                                                 01480035
       %INCLUDE (RCBBCAS1);,                                            01490035
       %INCLUDE (RRDDI1A);                                              01500035
 DCL 1 MAPPING_TYPE_DO,                                                 01510035
       %INCLUDE (RCBBCAS1);,                                            01520035
       %INCLUDE (RRDDO1A);                                              01530035
 DCL 1 MAPPING_TYPE_DC,                                                 01540035
       %INCLUDE (RCBBCAS1);,                                            01550035
       %INCLUDE (RRDDC1A);                                              01560035
 DCL 1 MAPPING_TYPE_DF,                                                 01570035
       %INCLUDE (RCBBCAS1);,                                            01580035
       %INCLUDE (RRDDF1A);                                              01590071
 DCL FILE_RCBAPDI  CHAR(462) BASED(ADDR(MAPPING_TYPE_DI));              01610067
 DCL FILE_RCBAPDO  CHAR(606) BASED(ADDR(MAPPING_TYPE_DO));              01620067
 DCL FILE_RCBAPDC  CHAR(406) BASED(ADDR(MAPPING_TYPE_DC));              01630067
 DCL FILE_RCBAPDF  CHAR(078) BASED(ADDR(MAPPING_TYPE_DF));              01640071
                                                      /* EOC PCR66   */ 01650035
 DCL FILE_REPORT       CHAR(80);  /* IOAREA FOR REPORT FILE          */ 01660035
                                                                        01670035
1/********************************************************************/ 01680035
 /* BIT SWITCHES                                                     */ 01690035
 /********************************************************************/ 01700035
0DCL TRUE                  BIT(1) INIT('1'B);                           01710035
 DCL FALSE                 BIT(1) INIT('0'B);                           01720035
 DCL EOF_RCBBCB0           BIT(1) INIT('0'B);/* END-OF-FILE SWITCH   */ 01730035
 DCL WRK_MAJOR_ERROR       BIT(1) INIT('0'B);/* MAJOR ERROR          */ 01740035
 DCL WRK_SUB_MAJ_ERR       BIT(1) INIT('0'B);/* SUB MAJOR ERROR      */ 01750035
 DCL WRK_NO_HEADER         BIT(1) INIT('0'B);/* NO HEADER FOUND      */ 01760035
 DCL WRK_HEADER_FOUND      BIT(1) INIT('0'B);/* HEADER FOUND         */ 01770035
 DCL WRK_TRAILER_FOUND     BIT(1) INIT('0'B);/* TRAILER FOUND        */ 01780035
                                                                        01790035
0/********************************************************************/ 01800035
 /* MISCELLANEOUS FIELDS                                             */ 01810035
 /********************************************************************/ 01820035
0DCL G_WRK_MOD_NAME       CHAR(08) INIT ('RCBBCBM ');                   01830035
 DCL G_WRK_PGM_NAME       CHAR(08) INIT ('RCBBCBP ');                   01840035
 DCL G_WRK_SYSTEM_TYPE    CHAR(01) INIT ('B');                          01850035
 DCL WRK_SEQUENCE_NUMBER  CHAR(28);                                     01860035
 DCL WRK_FILE_TYPE        CHAR(02);                                     01870035
 DCL WRK_IDENTIFIER       CHAR(08) ;                                    01880035
                                              /* SOC CEDS00000566    */ 01880144
 DCL WRK_DESCRIPTION      CHAR(30) ;                                    01881040
                                              /* EOC CEDS00000566    */ 01882044
 DCL WRK_RCBTY            CHAR(05) INIT ('RCBTY');                      01890035
                                              /* SOC CEDS00000601    */ 01890182
 DCL WRK_RCBFI            CHAR(05) INIT ('RCBFI');                      01891062
 DCL WRK_EMEA_OP          CHAR(26953);                                  01896081
                                              /* EOC CEDS00000601    */ 01897082
 DCL 1 WRK_IDENT_1        CHAR(08);                                     01900035
 DCL 1 WRK_IDENT_2        CHAR(08);                                     01910035
 DCL WRK_FILLER           CHAR(09) INIT(' ');                           01920035
 DCL WRK_GROUP_NO         CHAR(03) INIT(' ');                           01930035
                                              /* SOC CEDS00000573    */ 01930153
 /*                                                                     01931051
 DCL FILE_NAME            CHAR(61);                                     01940051
 */                                                                     01941051
                                              /* SOC CEDS00000601    */ 01941182
 /*DCL FILE_NAME          CHAR(68);*/                                   01942074
 DCL FILE_NAME            CHAR(07);                                     01942177
                                              /* EOC CEDS00000601    */ 01942282
                                              /* EOC CEDS00000573    */ 01943053
 DCL WRK_NO_OF_HDR        PIC '99';                                     01950035
 DCL WRK_K                PIC '99';                                     01960035
 DCL WRK_INCR             PIC '99';                                     01970035
 DCL WRK_COUNT_UPDATE     PIC '99';                                     01980035
 DCL WRK_NO_OF_TLR        PIC '99';                                     01990035
 DCL WRK_SIZE_IDENT       PIC '99';                                     02000035
 DCL WRK_FREE_SIZE        PIC '99';                                     02010035
 DCL WRK_START_CHAR       PIC '99';                                     02020035
 DCL WRK_ERROR_MSG        PIC '999';                                    02030035
 DCL WRK_LINE_SIZE        PIC '99999';                                  02040035
 DCL WRK_NO_OF_REC        PIC '9999999';                                02050035
 DCL WRK_CYCLE_NO         PIC '9999999';                                02060035
 DCL WRK_CYCLE_PIC        PIC '9999999';                                02070035
 DCL WRK_TEMP             PIC '9999999';                                02080035
 DCL L_CNT_PIC9           PIC '999999999';                              02090035
 DCL WRK_CYCLE            FIXED DEC(7,0);                               02100035
 DCL RETERR               FIXED BIN(15) INIT(8) STATIC;                 02110035
 DCL WRK_REC_COUNT_BIN  FIXED BIN(31);                                  02120035
 DCL WRK_NO_REC         CHAR(4) BASED(ADDR(WRK_REC_COUNT_BIN));         02130035
                                                /* SOC CEDS00000563  */ 02140035
 DCL WRK_APPL_NAME        CHAR(08) VARYING;                             02150035
 DCL WRK_GROUP            CHAR(08) VARYING;                             02160035
 DCL WRK_GROUPID          CHAR(08) VARYING;                             02170035
 DCL WRK_SRCE_NAME        CHAR(02);                                     02180035
 DCL WRK_A                PIC '99';                                     02190035
 DCL WRK_B                PIC '99';                                     02200035
 DCL WRK_C                PIC '99';                                     02210035
 DCL WRK_D                PIC '99';                                     02220035
 DCL WRK_E                PIC '99';                                     02230035
 /*                                                                     02240035
 DCL 1 WRK_FILE_NAME,                                                   02250035
       3 WRK_APPL         CHAR(07),                                     02260035
       3 WRK_GROUP        CHAR(03),                                     02270035
       3 WRK_GROUPID      CHAR(02),                                     02280035
       3 WRK_SRCE_NAME    CHAR(02); */                                  02290035
                                               /* EOC CEDS00000563  */  02300035
 DCL 1 ARR_UPDATE_PARM (10),                                            02310035
       3 ARR_PARM_NUM     CHAR(06),                                     02320035
       3 ARR_GROUP_NUM    CHAR(03),                                     02330035
       3 ARR_IDENTIFIER   CHAR(08),                                     02340035
       3 ARR_CYCLE_NUM    FIXED DEC(7,0);                               02350035
                                                                        02360035
0/********************************************************************/ 02370035
 /* REPORT LINES                                                     */ 02380035
 /********************************************************************/ 02390035
0DCL 1 HEADER1,                                                         02400035
       3 HEADER1A  CHAR(40)                                             02410035
            INIT('1 CE DATA SERVER                        '),           02420035
       3 HEADER1B  CHAR(40)                                             02430035
            INIT('        *** IBM INTERNAL USE ONLY ***   ');           02440035
0DCL 1 HEADER2,                                                         02450035
       3 HEADER2A  CHAR(40)                                             02460035
            INIT('0 IBM                                   '),           02470035
       3 HEADER2B  CHAR(40)                                             02480035
            INIT('      CEDS  - UPSTREAM INTERFACE REPORT');            02490035
0DCL 1 DETLINE1,                                                        02500035
       3 DETLINE1A CHAR(28)                                             02510035
            INIT('0 LOGICAL FILE NUMBER     : '),                       02520035
       3 DL_LOG_NUM    PIC '9999999',                                   02530035
       3 DETLINE1B CHAR(45) INIT(' ');                                  02540035
0DCL 1 DETLINE2,                                                        02550035
       3 DETLINE2A CHAR(28)                                             02560035
            INIT('  IDENTIFIER              : '),                       02570035
       3 DL_IDENT  CHAR(08) ,                                           02580035
       3 DETLINE2B CHAR(44) INIT(' ');                                  02590035
0DCL 1 DETLINE3,                                                        02600035
       3 DETLINE3A CHAR(28)                                             02610035
            INIT('  NUM OF RECS IN A TRAILER: '),                       02620035
       3 DL_TLR_REC PIC '9999999',                                      02630035
       3 DETLINE3B CHAR(21)                                             02640035
            INIT('  ACTUAL NO OF RECS: '),                              02650035
       3 DL_REC_CNT PIC '9999999',                                      02660035
       3 DETLINE3C CHAR(17) INIT(' ');                                  02670035
0DCL 1 DETLINE     CHAR(80) INIT(' ');                                  02680035
0DCL 1 TRAILER,                                                         02690035
       3 TRAILERA  CHAR(40)                                             02700035
            INIT('-                                *** END'),           02710035
       3 TRAILERB  CHAR(40)                                             02720035
            INIT(' OF REPORT ***                          ');           02730035
1/********************************************************************/ 02740035
 /*  USED TEMPORARY FIELDS FOR MESSAGE HANDLING                      */ 02750035
 /********************************************************************/ 02760035
0DCL 1 G_WRKMSG,                                                        02770035
       3 TXTFIELD_1     CHAR (25),                                      02780035
       3 TXTFIELD_2     CHAR (25),                                      02790035
       3 TXTFIELD_3     CHAR (25),                                      02800035
       3 NUMFIELD_1     FIXED BIN(31),                                  02810035
       3 NUMFIELD_2     FIXED BIN(31),                                  02820035
       3 NUMFIELD_3     FIXED BIN(31),                                  02830035
       3 NUMFIELD_4     FIXED BIN(31),                                  02840035
       3 NUMFIELD_5     FIXED BIN(31),                                  02850035
       3 NUMFIELD_6     FIXED BIN(31);                                  02860035
0DCL  E_WRKMSG         CHAR (80);                                       02870035
                                                                        02871038
0/********************************************************************/ 02890035
 /*  BUILTIN FUNCTIONS                                               */ 02900035
 /********************************************************************/ 02910035
0DCL (ADDR,                                                             02920035
     BIT,                                                               02930035
     DATE,                                                              02940035
     NULL,                                                              02950035
     LENGTH,                                                            02960035
     PLIRETC,                                                           02970035
     STRING,                                                            02980035
     SUBSTR,                                                            02990035
     TIME)                   BUILTIN;                                   03000035
1/********************************************************************/ 03010035
 /* ON ERROR CONDITIONS                                              */ 03020035
 /********************************************************************/ 03030035
 %INCLUDE (RCB0E0M);                                                    03040035
  END;                                                                  03050035
1/********************************************************************/ 03060035
 /* ON ENDFILE                                                       */ 03070035
 /********************************************************************/ 03080035
0ON ENDFILE (RCBBCB0)                                                   03090035
   BEGIN;                                                               03100035
     EOF_RCBBCB0 = '1'B;                                                03110035
   END;                                                                 03120035
                                                                        03130035
1/********************************************************************/ 03140035
 /*MAIN:            S T A R T   P R O C C E S S I N G                */ 03150035
 /********************************************************************/ 03160035
 CALL RCBBCBM_INIT_PROGRAM;                  /* INIT PROGRAM         */ 03170035
 CALL RCBBCBM_PROCESS_INPUT;                                            03180035
 CALL RCBBCBM_TERM_PROGRAM;                  /* TERMINATE PROGRAM    */ 03190035
1/********************************************************************/ 03200035
 /*                                                                  */ 03210035
 /* MODULE NAME      : RCBBCBM_INIT_PROGRAM                          */ 03220035
 /*                                                                  */ 03230035
 /* DESCRIPTION      : INITIAL ACTIONS                               */ 03240035
 /*                                                                  */ 03250035
 /********************************************************************/ 03260035
 RCBBCBM_INIT_PROGRAM: PROC;                                            03270035
                                                                        03280035
 PTR_INT_AREA       = ADDR(PARM_INT_AREA);                              03290035
 PTR_DATE_AREA      = ADDR(DATE_AREA);                                  03300035
 PTR_RETURN_AREA    = ADDR(RETURN_AREA);                                03310035
 PTR_RCBV500        = ADDR (TB_RCBV500);                                03320035
 PTR_RCBV500I       = ADDR (TB_RCBV500_I);                              03330035
                                 /* INITIAL GLOBALS */                  03340035
 G_WRKMSG = '';                                                         03350035
                                 /* INITIALISE TEMPORARY VARIABLES   */ 03360035
 WRK_NO_OF_HDR = 0;                                                     03370035
 WRK_NO_OF_TLR = 0;                                                     03380035
 WRK_NO_OF_REC = 0;                                                     03390035
 WRK_REC_COUNT_BIN = 0;                                                 03400035
 FILE_RCBTY_DESC   = '';                                                03410035
 FILE_RCBTY        = '';                                                03420035
                                                                        03430069
                                 /* OPEN ALL FILES                   */ 04040035
 OPEN FILE (RCBBCB0);                                                   04042041
 OPEN FILE (RCBBC21);                                                   04060035
 OPEN FILE (REPORT);                                                    04070035
                                /* WRITE HEADER TO REPORT FILE       */ 04080035
 WRITE FILE (REPORT) FROM (HEADER1);                                    04090035
 WRITE FILE (REPORT) FROM (HEADER2);                                    04100035
                                /* SOC CEDS00000563                  */ 04110035
                                /* ASSIGN PARM VALUES TO VARIABLES   */ 04120035
 /*                                                                     04130035
 READ FILE (RCBBC21) INTO (FILE_RCBBC21);                               04140035
                                                                        04150035
 WRK_APPL      = SUBSTR(FILE_RCBBC21,1,7);                              04160035
 WRK_GROUP     = SUBSTR(FILE_RCBBC21,8,3);                              04170035
 WRK_GROUPID   = SUBSTR(FILE_RCBBC21,11,2);                             04180035
 WRK_SRCE_NAME = SUBSTR(FILE_RCBBC21,13,2);*/                           04190035
 CALL RCBBCBM_GET_FILE_NAME;                                            04200035
                                /* EOC CEDS00000563                  */ 04210035
                                                                        04220035
                  /* INITIALISE INTERFACE AREA AND OPEN MESSAGE FILE */ 04230035
                                                                        04240035
 PARM_INT_AREA.MSG_AREA       = '';                                     04250035
 PARM_INT_AREA.ERR_AREA       = ' ';                                    04260035
 PARM_INT_AREA.MSG_REQUEST    = 'O';                                    04270035
 PARM_INT_AREA.MSG_TARGET     = 'S';                                    04280035
 PARM_INT_AREA.ID_SOURCE_APPL = 'RCB';                                  04290035
 PARM_INT_AREA.ID_SOURCE_PROG = G_WRK_PGM_NAME;                         04300035
 PARM_INT_AREA.ID_MOD_PATH(1) = G_WRK_MOD_NAME;                         04310035
 PARM_INT_AREA.ID_MOD_LEVEL   = 1;                                      04320035
 PARM_INT_AREA.SYSTEM_TYPE    = G_WRK_SYSTEM_TYPE;                      04330035
 PARM_INT_AREA.PTR_PCB_IO     = NULL;                                   04340035
 PARM_INT_AREA.PTR_PCB_ALT    = NULL;                                   04350035
 PARM_INT_AREA.SYSTEM_TYPE     = 'B';                                   04360035
0PARM_INT_AREA.COUNTRY_NUMBER  = '';                                    04370035
                                                                        04380035
 CALL RCB0M1M(PTR_INT_AREA);                                            04390035
                                                                        04400035
 PARM_INT_AREA.MSG_REQUEST    = 'P';                                    04410035
                                                                        04410136
                                                      /* SOC PCR66   */ 04410236
 MAPPING_TYPE_DI   = '';                                                04410336
 MAPPING_TYPE_DO   = '';                                                04410436
 MAPPING_TYPE_DC   = '';                                                04410536
 MAPPING_TYPE_DF   = '';                                                04410636
                        /* EXTRACT QUERY SPECIFIC TO THE GEO AP/EMEA */ 04410736
       /* RCB156 IS A MANDATORY PARAMETER, IF NOT ABEND THE PROGRAM */  04410836
                                                                        04410936
 TB_RCBV500                  = '';                                      04411036
 TB_RCBV500_I                = '';                                      04412036
 TB_RCB156.NUMBER            = 'RCB156';                                04413036
                                                                        04414036
0CALL RCBI50M ('R',                                                     04415036
               PTR_RCBV500,                                             04416036
               PTR_RCBV500I,                                            04417036
               PTR_RETURN_AREA,                                         04418036
               PTR_INT_AREA);                                           04419036
                                                                        04419136
 SELECT (RETURN_AREA.RETURN_CODE);                                      04419236
   WHEN (0)                                                             04419336
     DO;                                                                04419436
       RCB156 = TB_RCB156 , BY NAME;                                    04419536
       RCB156.GEO_INDICATOR = TRIM(RCB156.GEO_INDICATOR);               04419636
                       /* END THE PROGRAM IF INVALID PARAMETER VALUE */ 04419736
       IF RCB156.GEO_INDICATOR ¬= 'AP'   &                              04419836
          RCB156.GEO_INDICATOR ¬= 'EMEA' THEN                           04419936
        DO;                                                             04420036
          PARM_INT_AREA.COUNTRY_NUMBER           = '';                  04420136
          PARM_INT_AREA.MSG_AREA.MSG_VAR_CODES   = '';                  04420236
          PARM_INT_AREA.MESSAGE_TYPE             = 'IS';                04420336
          PARM_INT_AREA.MSG_AREA.MESSAGE_NUMBER  = '0020';              04420436
          PARM_INT_AREA.MSG_VAR_CODE_6           = 'PN';                04420536
          PARM_INT_AREA.MSG_VAR_VALUE_6          =                      04420636
                                        TB_RCBV500.PARAMETER_NUMBER;    04420736
          PARM_INT_AREA.MSG_VAR_CODE_7           = 'PV';                04420836
          PARM_INT_AREA.MSG_VAR_VALUE_7          =                      04420936
                                        TB_RCBV500.PARAMETER_VALUE;     04421036
          CALL RCB0M1M (PTR_INT_AREA);                                  04421136
          CALL RCBBCBM_ERROR (NULL, 'OTHER', '#013');                   04421236
        END;                                                            04421336
     END;                                                               04421436
   WHEN (4)            /* END THE PROGRAM IF RCB156 IS NOT AVAILABLE */ 04421536
     DO;                                                                04421636
       PARM_INT_AREA.COUNTRY_NUMBER           = '';                     04421736
       PARM_INT_AREA.MESSAGE_TYPE             = 'IS';                   04421836
       PARM_INT_AREA.MSG_AREA.MESSAGE_NUMBER  = 'I050';                 04421936
       PARM_INT_AREA.MSG_AREA.MSG_VAR_CODES   = ' ';                    04422036
       PARM_INT_AREA.MSG_AREA.MSG_VAR_CODE_6  = 'PN';                   04422136
       PARM_INT_AREA.MSG_AREA.MSG_VAR_VALUE_6 =                         04422236
                                     TB_RCBV500.PARAMETER_NUMBER;       04422336
       CALL RCB0M1M (PTR_INT_AREA);                                     04422436
       CALL RCBBCBM_ERROR (ADDR (RETURN_AREA.RETURN_SQL),               04422536
                          'DB2','#014');                                04422636
     END;                                                               04422736
   OTHERWISE                                                            04422836
     DO;                                                                04422936
       CALL RCBBCBM_ERROR (ADDR (RETURN_AREA.RETURN_SQL),               04423036
                           'DB2','#015');                               04423136
     END;                                                               04423236
 END;                                                                   04423336
                                                      /* EOC PCR66   */ 04423436
                                                                        04424035
 CALL RCB0T1M(PTR_INT_AREA);     /* RECEIVE SYSTEM DATE              */ 04430035
                                                                        04440035
 CALL RCBBCBM_READ_RECORD;                   /* INITIAL READ         */ 04450035
                                                                        04460035
 END RCBBCBM_INIT_PROGRAM;                                              04470035
1/********************************************************************/ 04480035
 /*                                                                  */ 04490035
 /* MODULE NAME      : RCBBCBM_PROCESS_INPUT                         */ 04500035
 /*                                                                  */ 04510035
 /* DESCRIPTION      : PROCESS INPUT FILE                            */ 04520035
 /*                                                                  */ 04530035
 /********************************************************************/ 04540035
 RCBBCBM_PROCESS_INPUT: PROC;                                           04550035
                                                                        04560035
 DO WHILE (¬EOF_RCBBCB0);                    /* READ INPUT FILE      */ 04570035
    CALL RCBBCBM_READ_RECORD;                                           04580035
 END;                                                                   04590035
                                                                        04600035
 IF  (EOF_RCBBCB0) &             /* IF END OF FILE AND NO TRAILER    */ 04610035
     (¬ WRK_TRAILER_FOUND)                                              04620035
 THEN DO;                                                               04630035
     WRK_MAJOR_ERROR = '1'B;                                            04640035
     WRK_SUB_MAJ_ERR = '1'B;                                            04650035
     WRK_ERROR_MSG = 007;                                               04660035
     CALL RCBBCBM_WRITE_INFO_FILE;                                      04670035
 END;                                                                   04680035
                                                                        04690035
 END RCBBCBM_PROCESS_INPUT;                                             04700035
                                                                        04710035
1/********************************************************************/ 04720035
 /*                                                                  */ 04730035
 /* MODULE NAME      : RCBBCBM_READ_RECORD                           */ 04740035
 /*                                                                  */ 04750035
 /* DESCRIPTION      : READ RECORD FROM INPUT FILE                   */ 04760035
 /*                                                                  */ 04770035
 /********************************************************************/ 04780035
 RCBBCBM_READ_RECORD: PROC;                                             04790035
                                                                        04791069
                                                                        04800035
 FILE_RCBBCB0     = ' ';                                                04810035
 READ FILE(RCBBCB0) INTO (FILE_RCBBCB0);                                04820035
                                                                        04830035
 IF WRK_NO_OF_HDR = 0 &                                                 04840035
    (EOF_RCBBCB0)                            /* EMPTY FILE           */ 04850035
 THEN DO;                                                               04860035
   CALL RCBBCBM_MSG('0013');                                            04870035
   CALL RCBBCBM_ERROR(NULL,'OTHER','#003');                   /*ABORT*/ 04880035
 END;                                                                   04890035
                                                                        04900035
 IF (¬ EOF_RCBBCB0)                                                     04910035
 THEN DO;                                                               04920035
   IF WRK_NO_OF_HDR = 0 THEN DO;                                        04930035
    IF SUBSTR(FILE_RCBBCB0,1,6) ¬= 'HEADER' /* FIRST REC : HEADER ? */  04940035
    THEN DO;                                                            04950035
      CALL RCBBCBM_MSG('0016');                                         04960035
      CALL RCBBCBM_ERROR (NULL, 'OTHER', '#005');           /*ABORT */  04970035
    END;                                                                04980035
   END;                                                                 04990035
   IF SUBSTR(FILE_RCBBCB0,1,6) = 'HEADER' THEN /* IF HEADER          */ 05000035
    DO;                                                                 05010035
      IF (WRK_HEADER_FOUND)     |                                       05020035
         ((¬ WRK_TRAILER_FOUND) & (WRK_NO_OF_HDR ¬= 0))                 05030035
      THEN DO;                                                          05040035
         WRK_NO_OF_TLR   = WRK_NO_OF_HDR;                               05050035
         WRK_MAJOR_ERROR = '1'B;                                        05060035
         WRK_ERROR_MSG   = 007;                                         05070035
         CALL RCBBCBM_WRITE_INFO_FILE;                                  05080035
      END;                                                              05090035
      WRK_HEADER_FOUND = '1'B;                                          05100035
      WRK_TRAILER_FOUND = '0'B;                                         05110035
      WRK_NO_OF_HDR  = WRK_NO_OF_HDR + 1;                               05120035
      WRK_NO_OF_REC  = 1;                                               05130035
      WRK_REC_COUNT_BIN = 1;                                            05140035
      WRK_FILE_TYPE  = SUBSTR(FILE_RCBBCB0,24,2);                       05150035
      WRK_IDENT_2    = RCBBCB0_HEADER.IDENTIFIER;                       05160035
      WRK_GROUP_NO   = RCBBCB0_HEADER.GROUP_NO;                         05170035
      WRK_CYCLE      = RCBBCB0_HEADER.CYCLE_NO;                         05180035
      CALL RCBBCBM_OPEN_FILE;                                           05190035
      CALL RCBBCBM_UNIQUE_IDENTIFIER;                                   05200035
      CALL RCBBCBM_RETRIEVE_IDENTIFIER;                                 05210035
    END;                                                                05220035
   ELSE                                      /*  IF TRAILER          */ 05230035
    IF SUBSTR(FILE_RCBBCB0,1,7) = 'TRAILER'                             05240035
    THEN DO;                                                            05250035
      WRK_HEADER_FOUND = '0'B;                                          05260035
      WRK_NO_OF_TLR   = WRK_NO_OF_TLR + 1;                              05270035
      WRK_NO_OF_REC   = WRK_NO_OF_REC + 1;                              05280035
      WRK_REC_COUNT_BIN = WRK_REC_COUNT_BIN + 1;                        05290035
      IF WRK_NO_OF_HDR ¬= WRK_NO_OF_TLR                                 05300035
      THEN DO;                                                          05310035
       WRK_NO_OF_TLR = WRK_NO_OF_HDR;                                   05320035
       WRK_NO_OF_REC = 1;                                               05330035
       WRK_REC_COUNT_BIN = 1;                                           05340035
      END;                                                              05350035
      ELSE DO;                                                          05360035
       CALL RCBBCBM_PROCESS_TRAILER;                                    05370035
       CALL RCBBCBM_CLOSE_RCBTY;                                        05380035
       CALL RCBBCBM_CLOSE_FILE;                                         05390035
      END;                                                              05400035
    END;                                                                05410035
    ELSE                                     /* IF DATA RECORD       */ 05420035
     DO;                                                                05430035
      WRK_HEADER_FOUND = '0'B;                                          05440035
      WRK_TRAILER_FOUND = '0'B;                                         05450035
      IF WRK_NO_OF_REC = 1                                              05460035
      THEN DO;                                                          05470035
         IF WRK_NO_OF_HDR ¬= WRK_NO_OF_TLR + 1                          05480035
         THEN DO;                                                       05490035
          WRK_NO_HEADER = '1'B;                                         05500035
          WRK_MAJOR_ERROR = '1'B;                                       05510035
          WRK_SUB_MAJ_ERR = '1'B;                                       05520035
          WRK_ERROR_MSG = 005;                                          05530035
          WRK_NO_OF_REC   = WRK_NO_OF_REC + 1;                          05540035
          WRK_REC_COUNT_BIN = WRK_REC_COUNT_BIN + 1;                    05550035
          CALL RCBBCBM_WRITE_INFO_FILE;                                 05560035
         END;                                                           05570035
         ELSE DO;                                                       05580035
          WRK_NO_OF_REC   = WRK_NO_OF_REC + 1;                          05590035
          WRK_REC_COUNT_BIN = WRK_REC_COUNT_BIN + 1;                    05600035
          IF WRK_NO_OF_HDR = WRK_NO_OF_TLR + 1                          05610035
           THEN DO;                                                     05620035
           CALL RCBBCBM_WRITE_INPUT;                                    05630035
           END;                                                         05640035
         END;                                                           05650035
     END;                                                               05660035
     ELSE DO;                                                           05670035
       WRK_NO_OF_REC   = WRK_NO_OF_REC + 1;                             05680035
       WRK_REC_COUNT_BIN = WRK_REC_COUNT_BIN + 1;                       05690035
       IF WRK_NO_OF_HDR = WRK_NO_OF_TLR + 1                             05700035
         THEN DO;                                                       05710069
        CALL RCBBCBM_WRITE_INPUT;                                       05720035
        END;                                                            05731069
     END;                                                               05740035
  END;                                                                  05750035
 END;                                                                   05760035
                                                                        05770035
 IF (WRK_HEADER_FOUND)                                                  05780035
 THEN DO;                                                               05790035
  ARR_PARM_NUM(WRK_NO_OF_HDR)   = 'RCB110';                             05800035
  ARR_GROUP_NUM(WRK_NO_OF_HDR)  = RCBBCB0_HEADER.GROUP_NO;              05810035
  ARR_IDENTIFIER(WRK_NO_OF_HDR) = WRK_IDENT_2;                          05820035
  ARR_CYCLE_NUM(WRK_NO_OF_HDR)  = RCBBCB0_HEADER.CYCLE_NO;              05830035
 END;                                                                   05840035
                                                                        05850035
 END RCBBCBM_READ_RECORD;                                               05860035
1/********************************************************************/ 05870035
 /*                                                                  */ 05880035
 /* MODULE NAME      : RCBBCBM_OPEN_FILE                             */ 05890035
 /*                                                                  */ 05900035
 /* DESCRIPTION      : OPEN THE REQUIRED FILE                        */ 05910035
 /*                                                                  */ 05920035
 /*                                                                  */ 05930035
 /********************************************************************/ 05940035
 RCBBCBM_OPEN_FILE: PROC;                                               05950035
                                                                        05960035
                                              /* SOC CEDS00000601  */   05961082
                                              /* SOC CEDS00000563  */   05970035
                                                                        05980035
 /*FILE_NAME  = 'DSN('  || SUBSTR(WRK_APPL_NAME,1,WRK_B) ||             05990075
                '.'    || SUBSTR(WRK_GROUP,1,WRK_D)     ||              06000035
                          SUBSTR(WRK_GROUPID,1,WRK_E)   ||              06010035
                          '.RCB'   ||  WRK_SRCE_NAME    ||*/            06020062
                                              /* SOC CEDS00000573  */   06021053
  /*             WRK_FILE_TYPE || '),'     || 'NEW,CATALOG,TRACKS,' ||  06030052
                          'SPACE(2500,500)';                       */   06030152
  /*             WRK_FILE_TYPE || '),'     || 'NEW,CATALOG,CYL,' ||     06031073
                      'SPACE(2500,2500)';*/                             06032062
                                              /* EOC CEDS00000573  */   06033053
                                              /* EOC CEDS00000601  */   06034082
  /*                                                                    06050035
  FILE_NAME  = 'DSN('       || WRK_APPL || '.' || WRK_GROUP ||          06060035
              WRK_GROUPID   || '.RCB'   ||  WRK_SRCE_NAME   ||          06070035
              WRK_FILE_TYPE || '),'     || 'NEW,CATALOG,TRACKS,' ||     06080035
             'SPACE(2500,500)'; */                                      06090035
                                              /* EOC CEDS00000563  */   06100035
                                              /* SOC CEDS00000566  */   06111044
  /*WRK_LINE_SIZE = 27994;*/                                            06120041
                                              /* SOC CEDS00000598  */   06120158
  /*WRK_LINE_SIZE = 29996;*/                                            06120256
  /*WRK_LINE_SIZE = 26957;*/                      /* CEDS00000601  */   06121082
                                              /* EOC CEDS00000598  */   06121158
                                              /* EOC CEDS00000566  */   06122044
                                                                        06130035
                                               /* SOC CEDS00000601 */   06140083
 /*OPEN FILE(FILERCB) STREAM OUTPUT TITLE(FILE_NAME)                    06150083
                            LINESIZE(WRK_LINE_SIZE);*/                  06151083
                                               /* EOC CEDS00000601 */   06152083
  OPEN FILE(RCBTYP) RECORD INPUT  TITLE(WRK_RCBTY || WRK_FILE_TYPE);    06160035
                                                                        06160175
                                               /* SOC CEDS00000601 */   06160282
  FILE_NAME = WRK_RCBFI||WRK_FILE_TYPE;                                 06171075
                                                                        06172067
  OPEN FILE(FILERCB) RECORD OUTPUT TITLE(FILE_NAME);                    06179270
                                               /* EOC CEDS00000601 */   06179382
  FILE_RCBTY_DESC = '';                                                 06180035
  READ FILE(RCBTYP) INTO (FILE_RCBTY_DESC);                             06190035
  SUBSTR(FILE_RCBTY,01,1) =  'H';                                       06200035
                                              /* SOC CEDS00000598  */   06201058
 /*SUBSTR(FILE_RCBTY,02,27993) = SUBSTR(FILE_RCBTY_DESC,01,27992);*/    06210056
                                               /* SOC CEDS00000601 */   06210182
 /*SUBSTR(FILE_RCBTY,02,26956) = SUBSTR(FILE_RCBTY_DESC,01,26955);*/    06210281
   SUBSTR(FILE_RCBTY,02,26952) = SUBSTR(FILE_RCBTY_DESC,01,26952);      06210380
                                              /* EOC CEDS00000598  */   06210475
 /*PUT FILE(FILERCB) EDIT (FILE_RCBTY) (A(WRK_LINE_SIZE)); */           06212073
  WRITE FILE(FILERCB) FROM (FILE_RCBTY);                                06213073
                                               /* EOC CEDS00000601 */   06214082
  END RCBBCBM_OPEN_FILE;                                                06251035
1/********************************************************************/ 06260035
 /*                                                                  */ 06270035
 /* MODULE NAME      : RCBBCBM_GET_FILE_NAME                         */ 06280035
 /*                                                                  */ 06290035
 /* DESCRIPTION      : GET THE FILE NAME BASED ON THE VALUES IN THE  */ 06300035
 /*                    INPUT FILE RCBBC21                            */ 06310035
 /*                                                                  */ 06320035
 /********************************************************************/ 06330035
  RCBBCBM_GET_FILE_NAME: PROC;                  /* SOC CEDS00000563  */ 06340035
   READ FILE (RCBBC21) INTO (FILE_RCBBC21);                             06350035
   WRK_A = 1;                                                           06360035
   DO WHILE (WRK_A <= 20)                                               06380036
      IF SUBSTR(FILE_RCBBC21,WRK_A,1) = ',' THEN                        06390035
      DO;                                                               06400035
      WRK_COMMA = WRK_COMMA + 1;                                        06410035
      IF WRK_COMMA = 1 THEN                                             06420035
      DO;                                                               06430035
      WRK_C = WRK_A - 1;                                                06440035
      WRK_APPL_NAME = SUBSTR(FILE_RCBBC21,1,WRK_C);                     06450035
      WRK_B                  = WRK_C;                                   06460035
      WRK_C = WRK_A + 1;                                                06480035
      END;                                                              06490035
      IF WRK_COMMA = 2 THEN                                             06500035
      DO;                                                               06510035
      WRK_GROUP     = SUBSTR(FILE_RCBBC21,WRK_C,WRK_A - WRK_C);         06530035
      WRK_D = WRK_A - WRK_C;                                            06550035
      WRK_C = WRK_A + 1;                                                06560035
      END;                                                              06570035
      IF WRK_COMMA = 3 THEN                                             06580035
      DO;                                                               06590035
      WRK_GROUPID   = SUBSTR(FILE_RCBBC21,WRK_C,WRK_A - WRK_C);         06610035
      WRK_E = WRK_A - WRK_C;                                            06630035
      WRK_C = WRK_A + 1;                                                06640035
      WRK_SRCE_NAME = SUBSTR(FILE_RCBBC21,WRK_C,2);                     06660035
      END;                                                              06680035
      END;                                                              06690035
      WRK_A = WRK_A +1;                                                 06700035
   END;                                                                 06710035
  END RCBBCBM_GET_FILE_NAME;                    /* EOC CEDS00000563  */ 06720035
                                                                        06730035
1/********************************************************************/ 06740035
 /*                                                                  */ 06750035
 /* MODULE NAME      : RCBBCBM_UNIQUE_IDENTIFIER                     */ 06760035
 /*                                                                  */ 06770035
 /* DESCRIPTION      : CHECK IF THE IDENTIFIER IN HEADER RECORD IS   */ 06780035
 /*                    UNIQUE IN THE INPUT FILE                      */ 06790035
 /*                                                                  */ 06800035
 /********************************************************************/ 06810035
 RCBBCBM_UNIQUE_IDENTIFIER: PROC;                                       06820035
                                                                        06830035
 WRK_IDENTIFIER     = '';                                               06840035
 WRK_K              = WRK_NO_OF_HDR;                                    06850035
                                                                        06860035
 IF WRK_K > 1                                                           06870035
 THEN DO;                                                               06880035
   DO WHILE ((WRK_K ¬= 0) & (¬FALSE));                                  06890035
      WRK_IDENTIFIER = ARR_IDENTIFIER(WRK_K);                           06900035
      WRK_K         = WRK_K - 1;                                        06910035
      IF WRK_IDENTIFIER  = RCBBCB0_HEADER.IDENTIFIER THEN               06920035
         FALSE  = '1'B;                                                 06930035
   END;                                                                 06940035
 END;                                                                   06950035
                                                                        06960035
 IF FALSE                                                               06970035
 THEN DO;                                                               06980035
    WRK_MAJOR_ERROR = '1'B;                                             06990035
    WRK_SUB_MAJ_ERR = '1'B;                                             07000035
    WRK_ERROR_MSG = 004;                                                07010035
    CALL RCBBCBM_WRITE_INFO_FILE;                                       07020035
 END;                                                                   07030035
                                                                        07040035
 END RCBBCBM_UNIQUE_IDENTIFIER;                                         07050035
                                                                        07060035
1/********************************************************************/ 07070035
 /*                                                                  */ 07080035
 /* MODULE NAME      : RCBBCBM_RETRIEVE_IDENTIFIER                   */ 07090035
 /*                                                                  */ 07100035
 /* DESCRIPTION      : CHECK EXISTANCE AND VALUES OF HEADER_RECORD   */ 07110035
 /*                                                                  */ 07120035
 /********************************************************************/ 07130035
 RCBBCBM_RETRIEVE_IDENTIFIER: PROC;                                     07140035
                                                                        07150035
 /* RETRIEVE PREVIOUS CYCLE NUMBER FROM RCB110 */                       07160035
                                                                        07170035
 TB_RCBV500                  = '';                                      07180035
 TB_RCBV500_I                = '';                                      07190035
 TB_RCB110.NUMBER            = 'RCB110';                                07200035
                                                                        07210035
 TB_RCB110.GROUP_NO          = RCBBCB0_HEADER.GROUP_NO;                 07220035
 TB_RCB110.IDENTIFIER        = RCBBCB0_HEADER.IDENTIFIER;               07230035
 TB_RCB110.FILLER_G1         = '';                                      07240035
                                                                        07241041
                                                                        07242041
0CALL RCBI50M ('R',                                                     07243041
               PTR_RCBV500,                                             07244041
               PTR_RCBV500I,                                            07245041
               PTR_RETURN_AREA,                                         07246041
               PTR_INT_AREA);                                           07247041
                                                                        07248041
 SELECT (RETURN_AREA.RETURN_CODE);                                      07481141
   WHEN (0) DO;                                                         07481241
     WRK_CYCLE_PIC = SUBSTR(TB_RCBV500.PARAMETER_VALUE,1,7);            07481341
     TB_RCB110.IDENT_CYCLE_NO = WRK_CYCLE_PIC;                          07481441
                                              /* SOC CEDS00000566    */ 07481544
     WRK_DESCRIPTION          = TB_RCB110.DESCRIPTION;                  07481641
                                              /* EOC CEDS00000566    */ 07481744
     RCB110 = TB_RCB110, BY NAME;                                       07481841
       IF RCB110.IDENT_CYCLE_NO  ¬= RCBBCB0_HEADER.CYCLE_NO             07481941
       THEN DO;                                                         07482041
         WRK_MAJOR_ERROR = '1'B;                                        07482141
         WRK_SUB_MAJ_ERR = '1'B;                                        07482241
         WRK_ERROR_MSG = 006;                                           07482341
         CALL RCBBCBM_WRITE_INFO_FILE;                                  07482441
       END;                                                             07482541
     ELSE                                                               07482641
       WRK_CYCLE_NO = RCBBCB0_HEADER.CYCLE_NO;                          07482741
   END;                                                                 07482841
   WHEN (4) DO;                                                         07482941
       PARM_INT_AREA.COUNTRY_NUMBER           = '';                     07483041
       PARM_INT_AREA.MESSAGE_TYPE             = 'IS';                   07483141
       PARM_INT_AREA.MSG_AREA.MESSAGE_NUMBER  = 'I050';                 07483241
       PARM_INT_AREA.MSG_AREA.MSG_VAR_CODES   = ' ';                    07483341
       PARM_INT_AREA.MSG_AREA.MSG_VAR_CODE_6  = 'PK';                   07483441
       PARM_INT_AREA.MSG_AREA.MSG_VAR_VALUE_6 =                         07483541
                                     TB_RCBV500.PARAMETER_KEY;          07483641
       CALL RCB0M1M (PTR_INT_AREA);  /* RECORD NOT FOUND      */        07483741
       CALL RCBBCBM_ERROR (ADDR (RETURN_AREA.RETURN_SQL),               07483841
                          'DB2','#007');                                07483941
   END;                                                                 07484041
   OTHERWISE                                                            07484141
     CALL RCBBCBM_ERROR (ADDR(RETURN_AREA.RETURN_SQL),                  07484241
                         'DB2','#008');                                 07484341
 END;  /* SELECT */                                                     07484441
                                                                        07484541
                                                                        07484641
 END RCBBCBM_RETRIEVE_IDENTIFIER;                                       07484741
1/********************************************************************/ 07670035
 /*                                                                  */ 07680035
 /* MODULE NAME      : RCBBCBM_PROCESS_TRAILER                       */ 07690035
 /*                                                                  */ 07700035
 /* DESCRIPTION      : VALIDATE TRAILER RECORD                       */ 07710035
 /*                                                                  */ 07720035
 /********************************************************************/ 07730035
 RCBBCBM_PROCESS_TRAILER: PROC;                                         07740035
                                                                        07750035
 IF (¬ WRK_NO_HEADER)                                                   07760035
 THEN DO;                                                               07770035
   IF WRK_NO_OF_REC = 2                      /* IF NO DATA RECORDS   */ 07780035
   THEN DO;                                                             07790035
      WRK_ERROR_MSG = 001;                                              07800035
      CALL RCBBCBM_WRITE_INFO_FILE;                                     07810035
   END;                                                                 07820035
   ELSE DO;                                                             07830035
    WRK_TEMP  = RCBBCB0_TRAILER.REC_COUNT;                              07840035
    IF WRK_TEMP ¬= WRK_NO_OF_REC             /* MISMATCH OF RECORDS   */07850035
    THEN DO;                                                            07860035
      WRK_MAJOR_ERROR = '1'B;                                           07870035
      WRK_SUB_MAJ_ERR = '1'B;                                           07880035
      WRK_ERROR_MSG = 002;                                              07890035
      CALL RCBBCBM_WRITE_INFO_FILE;                                     07900035
    END;                                                                07910035
    ELSE DO;                           /* NOT CORRESPONDING TRAILER  */ 07920035
      IF (RCBBCB0_TRAILER.GROUP_NO ¬= WRK_GROUP_NO) |                   07930035
         (RCBBCB0_TRAILER.CYCLE_NO ¬= WRK_CYCLE)    |                   07940035
         (WRK_NO_OF_TLR            ¬= WRK_NO_OF_HDR)                    07950035
      THEN DO;                                                          07960035
        WRK_MAJOR_ERROR = '1'B;                                         07970035
        WRK_SUB_MAJ_ERR = '1'B;                                         07980035
        WRK_ERROR_MSG = 003;                                            07990035
        CALL RCBBCBM_WRITE_INFO_FILE;                                   08000035
      END;                                                              08010035
    END;                                                                08020035
   END;                                                                 08030035
 END;                                                                   08040035
                                                                        08050035
 IF (¬ WRK_SUB_MAJ_ERR)         /* NO MAJOR ERROR FOR A LOGICAL FILE */ 08060035
 THEN DO;                                                               08070035
   WRK_ERROR_MSG = 0;                                                   08080035
   CALL RCBBCBM_WRITE_INFO_FILE;                                        08090035
 END;                                                                   08100035
                                                                        08110035
 WRK_SUB_MAJ_ERR = '0'B;                                                08120035
 WRK_REC_COUNT_BIN = WRK_REC_COUNT_BIN - 2;                             08130035
 WRK_NO_OF_REC   = 1;                                                   08140035
 WRK_TRAILER_FOUND = '1'B;                                              08150035
 WRK_NO_HEADER     = '0'B;                                              08160035
                                                                        08170035
 END RCBBCBM_PROCESS_TRAILER;                                           08180035
1/********************************************************************/ 08190035
 /*                                                                  */ 08200035
 /* MODULE NAME      : RCBBCBM_WRITE_INPUT                           */ 08210035
 /*                                                                  */ 08220035
 /* DESCRIPTION      : FILL AND WRITE RECORD FOR RCB INPUT FILE      */ 08230035
 /*                                                                  */ 08240035
 /********************************************************************/ 08250035
 RCBBCBM_WRITE_INPUT: PROC;                                             08260035
                                                                        08270035
                                                        /* SOC PCR66 */ 08280035
 IF (((WRK_FILE_TYPE = 'DO')       /* IF THE INPUT FILE IS INVENTORY */ 08290035
    | (WRK_FILE_TYPE = 'DI')       /* AND GEO IS 'AP'                */ 08300035
    | (WRK_FILE_TYPE = 'DC')                                            08310035
    | (WRK_FILE_TYPE = 'DF'))                                           08320035
    & (RCB156.GEO_INDICATOR    = 'AP')) THEN                            08330035
    DO;                                                                 08340035
      SELECT (WRK_FILE_TYPE);                   /* CHECK RECORD TYPE */ 08350035
        WHEN ('DI')                                                     08360035
          DO;                                                           08370035
            CALL RCBBCBM_MAP_WTASS_DI;                                  08380035
                                               /* SOC CEDS00000601 */   08381082
          /*PUT FILE(FILERCB) EDIT(FILE_RCBAPDI) (A(WRK_LINE_SIZE));*/  08390062
            WRITE FILE(FILERCB) FROM (FILE_RCBAPDI);                    08391070
                                               /* EOC CEDS00000601 */   08392082
            MAPPING_TYPE_DI = '';                                       08400035
          END;                                                          08410035
        WHEN ('DO')                                                     08420035
          DO;                                                           08430035
            CALL RCBBCBM_MAP_WTASS_DO;                                  08440035
                                               /* SOC CEDS00000601 */   08441082
         /* PUT FILE(FILERCB) EDIT(FILE_RCBAPDO) (A(WRK_LINE_SIZE));*/  08450062
            WRITE FILE(FILERCB) FROM (FILE_RCBAPDO)                     08451073
                                               /* EOC CEDS00000601 */   08452082
            MAPPING_TYPE_DO = '';                                       08460035
          END;                                                          08470035
        WHEN ('DC')                                                     08480035
          DO;                                                           08490035
            CALL RCBBCBM_MAP_WTASS_DC;                                  08500035
            FILE_RCBBCB0 = '';                                          08510035
                                               /* SOC CEDS00000601 */   08511082
         /* PUT FILE(FILERCB) EDIT(FILE_RCBAPDC) (A(WRK_LINE_SIZE));*/  08520062
            WRITE FILE(FILERCB) FROM (FILE_RCBAPDC);                    08521070
                                               /* EOC CEDS00000601 */   08522082
            MAPPING_TYPE_DC = '';                                       08530035
          END;                                                          08540035
        WHEN ('DF')                                                     08550035
          DO;                                                           08560035
            CALL RCBBCBM_MAP_WTASS_DF;                                  08570035
                                               /* SOC CEDS00000601 */   08571082
         /* PUT FILE(FILERCB) EDIT(FILE_RCBAPDF) (A(WRK_LINE_SIZE));*/  08580062
            WRITE FILE(FILERCB) FROM (FILE_RCBAPDF);                    08581070
                                               /* EOC CEDS00000601 */   08582082
            MAPPING_TYPE_DF = '';                                       08590035
          END;                                                          08600035
        OTHERWISE                                                       08610035
          DO;                                                           08620035
          END;                                                          08630035
      END;                                                              08640035
    END;                                                                08650035
 ELSE                                                   /* EOC PCR66 */ 08660035
                                               /* SOC CEDS00000601 */   08661082
 /*PUT FILE(FILERCB) EDIT(FILE_RCBBCB0) (A(WRK_LINE_SIZE));*/           08670062
   DO;                                                                  08670176
    WRK_EMEA_OP = SUBSTR(FILE_RCBBCB0,1,26953);                         08670280
    WRITE FILE(FILERCB) FROM (WRK_EMEA_OP);                             08671076
   END;                                                                 08672076
                                               /* EOC CEDS00000601 */   08673082
                                                                        08680035
 END RCBBCBM_WRITE_INPUT;                                               08690035
1/********************************************************************/ 08700035
 /*                                                 /* SOC PCR 66    */ 08710035
 /* MODULE NAME      : RCBBCBM_MAP_WTASS_DI                          */ 08720035
 /*                                                                  */ 08730035
 /* DESCRIPTION      : MAP DI TYPE OF RECORDS FROM SOF TO WTASS      */ 08740035
 /*                                                                  */ 08750035
 /********************************************************************/ 08760035
 RCBBCBM_MAP_WTASS_DI: PROC;                                            08770035
                                                                        08780035
 MAPPING_TYPE_DI.GCYAA       =     RCBBCB0_TYPE_DI.GCYAA;               08790035
 MAPPING_TYPE_DI.AASID       =     RCBBCB0_TYPE_DI.AASID;               08800035
 MAPPING_TYPE_DI.CMAXA       =     RCBBCB0_TYPE_DI.CMAXA;               08810035
 MAPPING_TYPE_DI.RMAXA       =     RCBBCB0_TYPE_DI.RMAXA;               08820035
 MAPPING_TYPE_DI.CSYXA       =     RCBBCB0_TYPE_DI.CSYXA;               08830035
 MAPPING_TYPE_DI.RSYXA       =     RCBBCB0_TYPE_DI.RSYXA;               08840035
 MAPPING_TYPE_DI.CMCXA       =     RCBBCB0_TYPE_DI.CMCXA;               08850035
 MAPPING_TYPE_DI.CFTXC       =     RCBBCB0_TYPE_DI.CFTXC;               08860035
 MAPPING_TYPE_DI.CFTXD       =     RCBBCB0_TYPE_DI.CFTXD;               08870035
 MAPPING_TYPE_DI.CFTXE       =     RCBBCB0_TYPE_DI.CFTXE;               08880035
 MAPPING_TYPE_DI.RCUXA       =     RCBBCB0_TYPE_DI.RCUXA;               08890035
 MAPPING_TYPE_DI.RCUAC       =     RCBBCB0_TYPE_DI.RCUAC;               08900035
 MAPPING_TYPE_DI.DVNXC       =     RCBBCB0_TYPE_DI.DVNXC;               08910035
 MAPPING_TYPE_DI.DVOXT       =     RCBBCB0_TYPE_DI.DVOXT;               08920035
 MAPPING_TYPE_DI.RBOXI       =     RCBBCB0_TYPE_DI.RBOXI;               08930035
 MAPPING_TYPE_DI.RLCAI       =     RCBBCB0_TYPE_DI.RLCAI;               08940035
 MAPPING_TYPE_DI.RBOXC       =     RCBBCB0_TYPE_DI.RBOXC;               08950035
 MAPPING_TYPE_DI.RLCAC       =     RCBBCB0_TYPE_DI.RLCAC;               08960035
 MAPPING_TYPE_DI.CAGXA       =     RCBBCB0_TYPE_DI.CAGXA;               08970035
 MAPPING_TYPE_DI.CSTXA       =     RCBBCB0_TYPE_DI.CSTXA;               08980035
 MAPPING_TYPE_DI.CMKDA       =     RCBBCB0_TYPE_DI.CMKDA;               08990035
 MAPPING_TYPE_DI.CPDXA       =     RCBBCB0_TYPE_DI.CPDXA;               09000035
 MAPPING_TYPE_DI.RORXD       =     RCBBCB0_TYPE_DI.RORXD;               09010035
 MAPPING_TYPE_DI.CSTXD       =     RCBBCB0_TYPE_DI.CSTXD;               09020035
 MAPPING_TYPE_DI.RORXH       =     RCBBCB0_TYPE_DI.RORXH;               09030035
 MAPPING_TYPE_DI.CIDGU       =     RCBBCB0_TYPE_DI.CIDGU;               09040035
 MAPPING_TYPE_DI.CIEDS       =     RCBBCB0_TYPE_DI.CISRU;               09050035
 MAPPING_TYPE_DI.CIEFV       =     RCBBCB0_TYPE_DI.CIEFV;               09060035
 MAPPING_TYPE_DI.CMMXA       =     RCBBCB0_TYPE_DI.CMMXA;               09070035
 MAPPING_TYPE_DI.CMCXB       =     RCBBCB0_TYPE_DI.CMCXB;               09080035
 MAPPING_TYPE_DI.XCY30       =     RCBBCB0_TYPE_DI.XCY30;               09090035
 MAPPING_TYPE_DI.DVWAA       =     RCBBCB0_TYPE_DI.DVWAC;               09100035
                                                                        09110035
 END RCBBCBM_MAP_WTASS_DI;                                              09120035
1/********************************************************************/ 09130035
 /*                                                                  */ 09140035
 /* MODULE NAME      : RCBBCBM_MAP_WTASS_DO                          */ 09150035
 /*                                                                  */ 09160035
 /* DESCRIPTION      : MAP DO TYPE OF RECORDS FROM SOF TO WTASS      */ 09170035
 /*                                                                  */ 09180035
 /********************************************************************/ 09190035
 RCBBCBM_MAP_WTASS_DO: PROC;                                            09200035
                                                                        09210035
 MAPPING_TYPE_DO.GCYAA       =     RCBBCB0_TYPE_DO.GCYAA;               09220035
 MAPPING_TYPE_DO.AASID       =     RCBBCB0_TYPE_DO.AASID;               09230035
 MAPPING_TYPE_DO.RORXA       =     RCBBCB0_TYPE_DO.RORXA;               09240035
 MAPPING_TYPE_DO.CMAXA       =     RCBBCB0_TYPE_DO.CMAXA;               09250035
 MAPPING_TYPE_DO.RMAXA       =     RCBBCB0_TYPE_DO.RMAXA;               09260035
 MAPPING_TYPE_DO.RSYXA       =     RCBBCB0_TYPE_DO.RSYXA;               09270035
 MAPPING_TYPE_DO.CMCXA       =     RCBBCB0_TYPE_DO.CMCXA;               09280035
 MAPPING_TYPE_DO.CFTXA       =     RCBBCB0_TYPE_DO.CFTXA;               09290035
 MAPPING_TYPE_DO.RSQAN       =     RCBBCB0_TYPE_DO.RSQAN;               09300035
 MAPPING_TYPE_DO.CBLXE       =     RCBBCB0_TYPE_DO.CBLXE;               09310035
 MAPPING_TYPE_DO.CFTXB       =     RCBBCB0_TYPE_DO.CFTXB;               09320035
 MAPPING_TYPE_DO.CBLXB       =     RCBBCB0_TYPE_DO.CBLXB;               09330035
 MAPPING_TYPE_DO.CFTXF       =     RCBBCB0_TYPE_DO.CFTXF;               09340035
 MAPPING_TYPE_DO.CBLXD       =     RCBBCB0_TYPE_DO.CBLXD;               09350035
 MAPPING_TYPE_DO.RBOXS       =     RCBBCB0_TYPE_DO.RBOXS;               09360035
 MAPPING_TYPE_DO.RLCAS       =     RCBBCB0_TYPE_DO.RLCAS;               09370035
 MAPPING_TYPE_DO.RCUAC       =     RCBBCB0_TYPE_DO.RCUAC;               09380035
 MAPPING_TYPE_DO.RCUXA       =     RCBBCB0_TYPE_DO.RCUXA;               09390035
 MAPPING_TYPE_DO.DVCXH       =     RCBBCB0_TYPE_DO.DVCXH;               09400035
 MAPPING_TYPE_DO.DVKXA       =     RCBBCB0_TYPE_DO.DVKXA;               09410035
 MAPPING_TYPE_DO.DVLXB       =     RCBBCB0_TYPE_DO.DVLXB;               09420035
 MAPPING_TYPE_DO.RBOXI       =     RCBBCB0_TYPE_DO.RBOXI;               09430035
 MAPPING_TYPE_DO.RLCAI       =     RCBBCB0_TYPE_DO.RLCAI;               09440035
 MAPPING_TYPE_DO.RBOXC       =     RCBBCB0_TYPE_DO.RBOXC;               09450035
 MAPPING_TYPE_DO.RLCAC       =     RCBBCB0_TYPE_DO.RLCAC;               09460035
 MAPPING_TYPE_DO.CAGXA       =     RCBBCB0_TYPE_DO.CAGXA;               09470035
 MAPPING_TYPE_DO.CANXA       =     RCBBCB0_TYPE_DO.CANXA;               09480035
 MAPPING_TYPE_DO.CPDXA       =     RCBBCB0_TYPE_DO.CPDXA;               09490035
 MAPPING_TYPE_DO.CMKDA       =     RCBBCB0_TYPE_DO.CMKDA;               09500035
 MAPPING_TYPE_DO.RORXD       =     RCBBCB0_TYPE_DO.RORXD;               09510035
 MAPPING_TYPE_DO.CSTXD       =     RCBBCB0_TYPE_DO.CSTXD;               09520035
 MAPPING_TYPE_DO.RORXK       =     RCBBCB0_TYPE_DO.RORXK;               09530035
 MAPPING_TYPE_DO.CIEFV       =     RCBBCB0_TYPE_DO.CIEFV;               09540035
 MAPPING_TYPE_DO.CMMXA       =     RCBBCB0_TYPE_DO.CMMXA;               09550035
 MAPPING_TYPE_DO.CMCXB       =     RCBBCB0_TYPE_DO.CMCXB;               09560035
 MAPPING_TYPE_DO.XCY40       =     RCBBCB0_TYPE_DO.XCY40;               09570035
                                                                        09580035
 END RCBBCBM_MAP_WTASS_DO;                                              09590035
1/********************************************************************/ 09600035
 /*                                                                  */ 09610035
 /* MODULE NAME      : RCBBCBM_MAP_WTASS_DC                          */ 09620035
 /*                                                                  */ 09630035
 /* DESCRIPTION      : MAP DC TYPE OF RECORDS FROM SOF TO WTASS      */ 09640035
 /*                                                                  */ 09650035
 /********************************************************************/ 09660035
 RCBBCBM_MAP_WTASS_DC: PROC;                                            09670035
                                                                        09680035
 MAPPING_TYPE_DC.GCYAA       =     RCBBCB0_TYPE_DC.GCYAA;               09690035
 MAPPING_TYPE_DC.AASID       =     RCBBCB0_TYPE_DC.AASID;               09700035
 MAPPING_TYPE_DC.RORXA       =     RCBBCB0_TYPE_DC.RORXA;               09710035
 MAPPING_TYPE_DC.CSTXA       =     RCBBCB0_TYPE_DC.CSTXA;               09720035
 MAPPING_TYPE_DC.CMAXA       =     RCBBCB0_TYPE_DC.CMAXA;               09730035
 MAPPING_TYPE_DC.CFTXA       =     RCBBCB0_TYPE_DC.CFTXA;               09740035
 MAPPING_TYPE_DC.RSQAN       =     RCBBCB0_TYPE_DC.RSQAN;               09750035
 MAPPING_TYPE_DC.CBLXE       =     RCBBCB0_TYPE_DC.CBLXE;               09760035
 MAPPING_TYPE_DC.CFTXB       =     RCBBCB0_TYPE_DC.CFTXB;               09770035
 MAPPING_TYPE_DC.RSQCA       =     RCBBCB0_TYPE_DC.RSQCA;               09780035
 MAPPING_TYPE_DC.CBLXB       =     RCBBCB0_TYPE_DC.CBLXB;               09790035
 MAPPING_TYPE_DC.CFTXF       =     RCBBCB0_TYPE_DC.CFTXF;               09800035
 MAPPING_TYPE_DC.CBLXD       =     RCBBCB0_TYPE_DC.CBLXD;               09810035
 MAPPING_TYPE_DC.DVCXH       =     RCBBCB0_TYPE_DC.DVCXH;               09820035
 MAPPING_TYPE_DC.DVKXA       =     RCBBCB0_TYPE_DC.DVKXA;               09830035
 MAPPING_TYPE_DC.DVLXB       =     RCBBCB0_TYPE_DC.DVLXB;               09840035
 MAPPING_TYPE_DC.RORXD       =     RCBBCB0_TYPE_DC.RORXD;               09850035
 MAPPING_TYPE_DC.CSTXD       =     RCBBCB0_TYPE_DC.CSTXD;               09860035
 MAPPING_TYPE_DC.RORXE       =     RCBBCB0_TYPE_DC.RORXE;               09870035
 MAPPING_TYPE_DC.CBLXA       =     RCBBCB0_TYPE_DC.CBLXA;               09880035
 MAPPING_TYPE_DC.CMMXC       =     RCBBCB0_TYPE_DC.CMMXC;               09890035
 MAPPING_TYPE_DC.XCY25       =     RCBBCB0_TYPE_DC.XCY25;               09900035
 MAPPING_TYPE_DC.CMAXM       =     RCBBCB0_TYPE_DC.CMAXM;               09910035
                                                                        09920035
 END RCBBCBM_MAP_WTASS_DC;                                              09930035
1/********************************************************************/ 09940035
 /*                                                                  */ 09950035
 /* MODULE NAME      : RCBBCBM_MAP_WTASS_DF                          */ 09960035
 /*                                                                  */ 09970035
 /* DESCRIPTION      : MAP DF TYPE OF RECORDS FROM SOF TO WTASS      */ 09980035
 /*                                                                  */ 09990035
 /********************************************************************/ 10000035
 RCBBCBM_MAP_WTASS_DF: PROC;                                            10010035
                                                                        10020035
 MAPPING_TYPE_DF.GCYAA       =     RCBBCB0_TYPE_DF.GCYAA;               10030035
 MAPPING_TYPE_DF.AASID       =     RCBBCB0_TYPE_DF.AASID;               10040035
 MAPPING_TYPE_DF.CMAXA       =     RCBBCB0_TYPE_DF.CMAXA;               10050035
 MAPPING_TYPE_DF.RORAD       =     RCBBCB0_TYPE_DF.RORAD;               10060035
 MAPPING_TYPE_DF.CSTAD       =     RCBBCB0_TYPE_DF.CSTAD;               10070035
 MAPPING_TYPE_DF.CFTXA       =     RCBBCB0_TYPE_DF.CFTXA;               10080035
 MAPPING_TYPE_DF.RSQAN       =     RCBBCB0_TYPE_DF.RSQAN;               10090035
 MAPPING_TYPE_DF.CBLXE       =     RCBBCB0_TYPE_DF.CBLXE;               10100035
 MAPPING_TYPE_DF.RSQAZ       =     RCBBCB0_TYPE_DF.RSQAZ;               10110035
 MAPPING_TYPE_DF.CFTAB       =     RCBBCB0_TYPE_DF.CFTAB;               10120035
 MAPPING_TYPE_DF.DVNXC       =     RCBBCB0_TYPE_DF.DVNXC;               10130035
 MAPPING_TYPE_DF.CIDHH       =     RCBBCB0_TYPE_DF.CIDHH;               10140035
 MAPPING_TYPE_DF.CIEEL       =     RCBBCB0_TYPE_DF.CIEEL;               10150035
 MAPPING_TYPE_DF.XCYC6       =     RCBBCB0_TYPE_DF.XCYC6;               10160035
                                                                        10170035
 END RCBBCBM_MAP_WTASS_DF;                            /* EOC PCR66   */ 10180035
1/********************************************************************/ 10190035
 /*                                                                  */ 10200035
 /* MODULE NAME      : RCBBCBM_WRITE_INFO_FILE                      */  10210035
 /*                                                                  */ 10220035
 /* DESCRIPTION      : FILL AND WRITE RECORD FOR RCB INPUT FILE      */ 10230035
 /*                                                                  */ 10240035
 /********************************************************************/ 10250035
 RCBBCBM_WRITE_INFO_FILE: PROC;                                         10260035
                                                                        10270035
 IF WRK_ERROR_MSG = 0                                                   10280035
 THEN DO;                                                               10290035
    DL_LOG_NUM    = WRK_NO_OF_HDR;                                      10300035
    DL_IDENT      = WRK_IDENT_2;                                        10310035
    DL_TLR_REC    = RCBBCB0_TRAILER.REC_COUNT;                          10320035
    DL_REC_CNT    = WRK_NO_OF_REC;                                      10330035
    WRITE FILE (REPORT) FROM (DETLINE1);                                10340035
    WRITE FILE (REPORT) FROM (DETLINE2);                                10350035
    WRITE FILE (REPORT) FROM (DETLINE3);                                10360035
 END;                                                                   10370035
                                                                        10380035
 IF WRK_ERROR_MSG = 1                                                   10390035
 THEN DO;                                                               10400035
   FILE_REPORT    = '0 WARNING MESSAGE FOR IDENTIFIER: ' || WRK_IDENT_2;10410035
   WRITE FILE(REPORT) FROM (FILE_REPORT);                               10420035
   E_WRKMSG = '  NO DATA RECORDS PRESENT';                              10430035
   WRITE FILE(REPORT) FROM (E_WRKMSG);                                  10440035
 END;                                                                   10450035
 IF WRK_ERROR_MSG = 2                                                   10460035
 THEN DO;                                                               10470035
   FILE_REPORT    = '0 ERROR MESSAGE FOR IDENTIFIER: '  || WRK_IDENT_2; 10480035
   WRITE FILE(REPORT) FROM (FILE_REPORT);                               10490035
   E_WRKMSG = '  NUMBER OF RECORDS MISMATCH WITH THE RECORD ' ||        10500035
              'COUNT IN THE TRAILER';                                   10510035
   WRITE FILE(REPORT) FROM (E_WRKMSG);                                  10520035
 END;                                                                   10530035
 IF WRK_ERROR_MSG = 3                                                   10540035
 THEN DO;                                                               10550035
   FILE_REPORT    = '0 ERROR MESSAGE FOR IDENTIFIER: '  || WRK_IDENT_2; 10560035
   WRITE FILE(REPORT) FROM (FILE_REPORT);                               10570035
   E_WRKMSG = '  MISMATCH OF CYCLE NUMBER/GROUP NUMBER IN ' ||          10580035
              'HEADER AND TRAILER';                                     10590035
   WRITE FILE(REPORT) FROM (E_WRKMSG);                                  10600035
 END;                                                                   10610035
                                                                        10620035
 IF WRK_ERROR_MSG = 4                                                   10630035
 THEN DO;                                                               10640035
   FILE_REPORT    = '0 ERROR MESSAGE FOR IDENTIFIER: '  || WRK_IDENT_2; 10650035
   WRITE FILE(REPORT) FROM (FILE_REPORT);                               10660035
   E_WRKMSG = '  IDENTIFIER IS NOT UNIQUE';                             10670035
   WRITE FILE(REPORT) FROM (E_WRKMSG);                                  10680035
 END;                                                                   10690035
                                                                        10700035
 IF WRK_ERROR_MSG = 5                                                   10710035
 THEN DO;                                                               10720035
   FILE_REPORT    = '0 ERROR MESSAGE:';                                 10730035
   WRITE FILE(REPORT) FROM (FILE_REPORT);                               10740035
   E_WRKMSG = '  NO HEADER PRESENT AFTER IDENTIFIER ' || WRK_IDENT_2;   10750035
   WRITE FILE(REPORT) FROM (E_WRKMSG);                                  10760035
 END;                                                                   10770035
                                                                        10780035
 IF WRK_ERROR_MSG = 6                                                   10790035
 THEN DO;                                                               10800035
   FILE_REPORT    = '0 ERROR MESSAGE FOR IDENTIFIER: '  || WRK_IDENT_2; 10810035
   WRITE FILE(REPORT) FROM (FILE_REPORT);                               10820035
   E_WRKMSG = '  INCORRECT CYCLE NUMBER ';                              10830035
   WRITE FILE(REPORT) FROM (E_WRKMSG);                                  10840035
 END;                                                                   10850035
                                                                        10860035
                                                                        10870035
 IF WRK_ERROR_MSG = 7                                                   10880035
 THEN DO;                                                               10890035
   FILE_REPORT    = '0 ERROR MESSAGE FOR IDENTIFIER: '  || WRK_IDENT_2; 10900035
   WRITE FILE(REPORT) FROM (FILE_REPORT);                               10910035
   E_WRKMSG = '  NO TRAILER FOUND';                                     10920035
   WRITE FILE(REPORT) FROM (E_WRKMSG);                                  10930035
 END;                                                                   10940035
 END RCBBCBM_WRITE_INFO_FILE;                                           10950035
1/********************************************************************/ 10960035
 /*                                                                  */ 10970035
 /* MODULE NAME      : RCBBCBM_CLOSE_RCBTY                           */ 10980035
 /*                                                                  */ 10990035
 /* DESCRIPTION      : CLOSE THE INPUT HEADER/TRAILER INFORMATION    */ 11000035
 /*                    FILE                                          */ 11010035
 /*                                                                  */ 11020035
 /********************************************************************/ 11030035
 RCBBCBM_CLOSE_RCBTY: PROC;                                             11040035
                                                                        11050035
 READ FILE(RCBTYP) INTO (FILE_RCBTY_DESC);                              11060035
                                                                        11070035
 SUBSTR(FILE_RCBTY_DESC,37,4) =  WRK_NO_REC;                            11080035
 SUBSTR(FILE_RCBTY,01,1) =  'T';                                        11090035
                                              /* SOC CEDS00000598    */ 11091058
 /*SUBSTR(FILE_RCBTY,02,27993) = SUBSTR(FILE_RCBTY_DESC,01,27992);*/    11100056
                                               /* SOC CEDS00000601 */   11100182
 /*SUBSTR(FILE_RCBTY,02,26956) = SUBSTR(FILE_RCBTY_DESC,01,26955);*/    11100281
   SUBSTR(FILE_RCBTY,02,26952) = SUBSTR(FILE_RCBTY_DESC,01,26952);      11101080
                                              /* EOC CEDS00000598    */ 11102058
                                               /* EOC CEDS00000601 */   11103082
                                                                        11110035
                                               /* SOC CEDS00000601 */   11111082
 /*PUT FILE(FILERCB) EDIT (FILE_RCBTY) (A(WRK_LINE_SIZE));*/            11120073
   WRITE FILE(FILERCB) FROM (FILE_RCBTY);                               11131070
                                               /* EOC CEDS00000601 */   11132082
 CLOSE FILE(RCBTYP);                                                    11141035
                                                                        11150035
 END RCBBCBM_CLOSE_RCBTY;                                               11160035
1/********************************************************************/ 11170035
 /*                                                                  */ 11180035
 /* MODULE NAME      : RCBBCBM_CLOSE_FILE                            */ 11190035
 /*                                                                  */ 11200035
 /* DESCRIPTION      : CLOSE THE OUPUT FILE                          */ 11210035
 /*                                                                  */ 11220035
 /********************************************************************/ 11230035
 RCBBCBM_CLOSE_FILE: PROC;                                              11240035
                                                                        11250035
 CLOSE FILE(FILERCB);                                                   11260073
                                                                        11270035
 END RCBBCBM_CLOSE_FILE;                                                11280035
1/********************************************************************/ 11290035
 /*                                                                  */ 11300035
 /* MODULE NAME      : RCBBCBM_TERM_PROGRAM                          */ 11310035
 /*                                                                  */ 11320035
 /* DESCRIPTION      : TERMINATE PROGRAM                             */ 11330035
 /*                                                                  */ 11340035
 /********************************************************************/ 11350035
 RCBBCBM_TERM_PROGRAM: PROC;                                            11360035
                                                                        11370035
 IF (¬ WRK_MAJOR_ERROR)        /* IF NO MAJOR ERROR UPDATEPARM TABLE */ 11380041
 THEN DO;                                                               11390035
   WRK_COUNT_UPDATE       = WRK_NO_OF_HDR;                              11400035
   WRK_INCR               = 1;                                          11410035
   DO WHILE (WRK_COUNT_UPDATE ¬= 0);                                    11420035
      IF WRK_CYCLE_NO = 9999999 THEN                                    11430035
         WRK_CYCLE_NO = 0;                                              11440035
                                                                        11450035
      TB_RCBV500             = '';                                      11460035
      TB_RCBV500_I           = '';                                      11470035
                                                                        11480035
      WRK_CYCLE_NO             =  ARR_CYCLE_NUM(WRK_INCR);              11490035
      WRK_CYCLE_NO             = WRK_CYCLE_NO + 1;                      11500035
      TB_RCBV500.PARAMETER_VALUE = WRK_CYCLE_NO;                        11510035
      TB_RCB110.NUMBER         = ARR_PARM_NUM(WRK_INCR);                11520035
      TB_RCB110.GROUP_NO       = ARR_GROUP_NUM(WRK_INCR);               11530035
      TB_RCB110.IDENTIFIER     = ARR_IDENTIFIER(WRK_INCR);              11540035
                                              /* SOC CEDS00000566    */ 11540144
      TB_RCB110.DESCRIPTION    = WRK_DESCRIPTION;                       11541040
                                              /* EOC CEDS00000566    */ 11542044
      WRK_INCR                 = WRK_INCR + 1;                          11550035
      WRK_COUNT_UPDATE         = WRK_COUNT_UPDATE - 1;                  11560035
                                                                        11570035
      CALL RCBG50M(PTR_RCBV500,                                         11580035
                   PTR_RCBV500I,                                        11590035
                   PTR_RETURN_AREA,                                     11600035
                   PTR_INT_AREA);                                       11610035
      SELECT (RETURN_AREA.RETURN_CODE);                                 11620035
      WHEN(0);                                                          11630035
      OTHERWISE                                                         11640035
        CALL RCBBCBM_ERROR(ADDR(RETURN_AREA.RETURN_SQL),                11650035
                          'DB2','#019');                                11660035
      END;                                                              11670035
   END;                                                                 11680035
 END;                                                                   11690035
                                 /************************************/ 11700035
                                 /* CLOSE ALL FILES                  */ 11710035
                                 /************************************/ 11720035
 CLOSE FILE (RCBBCB0);                                                  11730035
 CLOSE FILE (RCBBC21);                                                  11740035
 FILE_REPORT = STRING(TRAILER);                                         11750035
 WRITE FILE (REPORT) FROM (FILE_REPORT);                                11760035
 CLOSE FILE (REPORT);                                                   11770035
                                                                        11780035
 IF WRK_MAJOR_ERROR THEN          /* IF ANY MAJOR ERROR             */  11790035
   DO;                            /* ISSUE AN ERROR MESSAGE         */  11800035
     CALL PLIRETC(RETERR);        /* SET THE RETURN CODE            */  11810035
   END;                           /* END ISSUE AN ERROR MESSAGE     */  11820035
                      /* CLOSE MESSAGE FILE  (ALWAYS LAST ACTION..!) */ 11830035
 PARM_INT_AREA.MSG_REQUEST    = 'C';                                    11840035
 CALL RCB0M1M(PTR_INT_AREA);                                            11850035
                                                                        11860035
 END RCBBCBM_TERM_PROGRAM;                                              11870035
1/********************************************************************/ 11880035
 /*                                                                  */ 11890035
 /* MODULE NAME      : RCBBCBM_MSG                                   */ 11900035
 /*                                                                  */ 11910035
 /* DESCRIPTION      : CALLS THE COMMON MESSAGE ROUTINE TO PRINT     */ 11920035
 /*                    THE RIGHT MESSAGE                             */ 11930035
 /*                                                                  */ 11940035
 /********************************************************************/ 11950035
0RCBBCBM_MSG: PROC (A_MSG_NR);                                          11960035
                                                                        11970035
 DCL A_MSG_NR          CHAR(04);                                        11980035
                                                                        11990035
 /*RESET COMMON FIELDS*/                                                12000035
 PARM_INT_AREA.MSG_VAR_CODES = ' ';                                     12010035
                                                                        12020035
 SELECT (A_MSG_NR);                                                     12030035
                                                                        12040035
   /* 0013: EMPTY FILE OR DATABASE */                                   12050035
   WHEN ('0013') DO;                                                    12060035
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             12070035
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             12080035
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBCB0';                        12090035
   END;                                                                 12100035
                                                                        12110035
   /* 0016: NO HEADER FOUND */                                          12120035
   WHEN ('0016') DO;                                                    12130035
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             12140035
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'FL';                             12150035
     PARM_INT_AREA.MSG_VAR_VALUE_6  = 'RCBBCB0';                        12160035
   END;                                                                 12170035
                                                                        12180035
   /* I050: RECORD NOT FOUND FOR PK PN ST */                            12190035
   WHEN('I050') DO;                                                     12200035
     PARM_INT_AREA.COUNTRY_NUMBER   = '';                               12210035
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             12220035
     PARM_INT_AREA.MSG_VAR_CODE_6   = 'PN';                             12230035
     PARM_INT_AREA.MSG_VAR_CODE_7   = 'PK';                             12240035
     PARM_INT_AREA.MSG_VAR_VALUE_7  =  TB_RCBV500.PARAMETER_KEY;        12250035
   END;                                                                 12260035
                                                                        12270035
   /* 9999: PROGRAM SUCCESFULLY ENDED */                                12280035
   WHEN ('9999') DO;                                                    12290035
     PARM_INT_AREA.MESSAGE_TYPE     = 'IS';                             12300035
   END;                                                                 12310035
                                                                        12320035
   OTHERWISE DO;                                                        12330035
       PUT SKIP LIST( '#DBG# '||'A_MSG_NR=' || A_MSG_NR);               12340035
     CALL RCBBCBM_ERROR (NULL, 'OTHER', '#020');              /*ABORT*/ 12350035
   END;                                                                 12360035
 END;                                                                   12370035
                                                                        12380035
 /* MESSAGE IS VALID, REPORT MESSAGE */                                 12390035
 PARM_INT_AREA.MESSAGE_NUMBER = A_MSG_NR;                               12400035
 CALL RCB0M1M(PTR_INT_AREA);                                            12410035
                                                                        12420035
 /* PREVENT PRINTING PREVIOUS MESSAGE WORK FIELDS */                    12430035
 G_WRKMSG = '';                                                         12440035
                                                                        12450035
 END RCBBCBM_MSG;                                                       12460035
1/********************************************************************/ 12470035
 /*                                                                  */ 12480035
 /* MODULE NAME      : RCBBCBM_ERROR                                 */ 12490035
 /*                                                                  */ 12500035
 /* DESCRIPTION      : CALLS THE COMMON ERROR ROUTINE                */ 12510035
 /*                                                                  */ 12520035
 /********************************************************************/ 12530035
 RCBBCBM_ERROR: PROC (PTR_ERROR,                                        12540035
                      ERR_TYPE,                                         12550035
                      CALL_ID);                                         12560035
                                                                        12570035
 DCL PTR_ERROR             PTR;                                         12580035
 DCL ERR_TYPE              CHAR (8);                                    12590035
 DCL CALL_ID               CHAR (4);                                    12600035
                                                                        12610035
 PARM_INT_AREA.PTR_ERROR = PTR_ERROR;                                   12620035
 PARM_INT_AREA.ERR_TYPE  = ERR_TYPE;                                    12630035
 PARM_INT_AREA.CALL_ID   = CALL_ID;                                     12640035
 CALL RCB0E1M (PTR_INT_AREA);                                           12650035
                                                                        12660035
 END RCBBCBM_ERROR;                                                     12670035
1/*******************************************************************/  12680035
 /*DO NOT CHANGE THIS PART, IT IS MEANT FOR ABR                     */  12690035
 /*******************************************************************/  12700035
0 %INCLUDE DAIFPLH ;                     /* COMPILE DATE/TIME STAMP */  12710035
 $DAIMOD (RCBBCBM);                      /* MODULE TO BE COMPILED   */  12720043
0/*******************************************************************/  12730035
 /* END OF ABR BLOCK                                                */  12740035
 /*******************************************************************/  12750035
 END RCBBCBM;                                                           12760043